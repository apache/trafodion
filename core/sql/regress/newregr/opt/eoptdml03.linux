-- @@@ START COPYRIGHT @@@
--
-- Licensed to the Apache Software Foundation (ASF) under one
-- or more contributor license agreements.  See the NOTICE file
-- distributed with this work for additional information
-- regarding copyright ownership.  The ASF licenses this file
-- to you under the Apache License, Version 2.0 (the
-- "License"); you may not use this file except in compliance
-- with the License.  You may obtain a copy of the License at
--
--   http://www.apache.org/licenses/LICENSE-2.0
--
-- Unless required by applicable law or agreed to in writing,
-- software distributed under the License is distributed on an
-- "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
-- KIND, either express or implied.  See the License for the
-- specific language governing permissions and limitations
-- under the License.
--
-- @@@ END COPYRIGHT @@@
>>
>>?section cdefs
>>-------------------------------------------------
>>--  Control query defaults for schhp8 test run. --
>>-------------------------------------------------
>>control query default ARKCMP_FAKE_HW 'ON';

--- SQL operation complete.
>>
>>control query default HIST_USE_SAMPLE_FOR_CARDINALITY_ESTIMATION  'OFF';

--- SQL operation complete.
>>
>>control query default HIST_ON_DEMAND_STATS_SIZE  '0';

--- SQL operation complete.
>>control query default DEF_NUM_SMP_CPUS '1';

--- SQL operation complete.
>>control query default MAX_ESPS_PER_CPU_PER_OP '1';

--- SQL operation complete.
>>control query default DEF_NUM_NODES_IN_ACTIVE_CLUSTERS '8';

--- SQL operation complete.
>>control query default OPTIMIZATION_LEVEL 'FULL';

--- SQL operation complete.
>>control query default ZIG_ZAG_TREES 'ON';

--- SQL operation complete.
>>
>>control query default HIST_SAME_TABLE_PRED_REDUCTION '0.0';

--- SQL operation complete.
>>
>>control query default fake_volume_assignments 'ON';

--- SQL operation complete.
>>
>>control query default PREFERRED_PROBING_ORDER_FOR_NESTED_JOIN 'OFF';

--- SQL operation complete.
>>
>>control query default target_code 'RELEASE';

--- SQL operation complete.
>>control query default MEMORY_UNITS_SIZE	 '20490';

--- SQL operation complete.
>>control query default MDAM_SCAN_METHOD 'ON';

--- SQL operation complete.
>>control query default CACHE_HISTOGRAMS 'ON';

--- SQL operation complete.
>>control query default HIST_DEFAULT_BASE_SEL_FOR_LIKE_WILDCARD '0.5';

--- SQL operation complete.
>>control query default HIST_MISSING_STATS_WARNING_LEVEL '0';

--- SQL operation complete.
>>
>>control query default MSCF_ET_CPU '0.000014';

--- SQL operation complete.
>>control query default TARGET_CPU_FREQUENCY '1600';

--- SQL operation complete.
>>control query default REFERENCE_CPU_FREQUENCY '199';

--- SQL operation complete.
>>
>>control query default MSCF_ET_IO_TRANSFER '0.00002';

--- SQL operation complete.
>>control query default TARGET_IO_SEQ_READ_RATE '50.0';

--- SQL operation complete.
>>control query default REFERENCE_IO_SEQ_READ_RATE '50.0';

--- SQL operation complete.
>>
>>control query default MSCF_ET_NUM_IO_SEEKS '.0038';

--- SQL operation complete.
>>control query default TARGET_IO_SEEK_TIME '.0038';

--- SQL operation complete.
>>control query default REFERENCE_IO_SEEK_TIME '.0038';

--- SQL operation complete.
>>
>>-- disabling the inner table key scan hueristic for subquery unnesting
>>-- This setting will allow queries 17 and 20 to be unnested.
>>control query default COMP_BOOL_168 'ON' ;

--- SQL operation complete.
>>
>>
>>?section tests
>>-- test new scan optimizer first
>>obey optdml03(q01);
>>--------------------
>>--  TPCH Query 01 --
>>--------------------
>>prepare XX from
+>SELECT l_returnflag, l_linestatus, SUM(l_quantity) AS sum_qty,
+>       CAST(SUM(l_extendedprice) AS NUMERIC(18,2)) AS sum_base_price,
+>       CAST(SUM(l_extendedprice * (1-l_discount)) AS NUMERIC(18,2)) AS sum_disc_price,
+>       CAST(SUM(l_extendedprice * (1-l_discount) * (1 + l_tax))
+>            AS NUMERIC(18,2)) AS sum_charge,
+>       AVG(l_quantity) AS avg_qty,
+>       AVG(l_extendedprice) AS avg_price,
+>       AVG(CAST(l_discount AS NUMERIC (10,3))) AS avg_disc,
+>       COUNT(*) AS count_order
+>FROM lineitem
+>WHERE l_shipdate <= DATE '1998-12-01' - INTERVAL '90' DAY
+>GROUP BY l_returnflag, l_linestatus
+>ORDER BY l_returnflag, l_linestatus;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

08  ROOT              7   ?               6.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   9.000E+002 
07  ESP_EXCHANGE      6   ?               6.000E+000   FUNKY_OPT_UNIQUE  7.333E-005   9.000E+002 
06  SORT_PARTIAL_GRO  5   ?               6.000E+000   FUNKY_OPT_UNIQUE  9.271E-008   9.000E+002 
05  SORT              4   ?               6.000E+000   FUNKY_OPT_UNIQUE  5.994E-008   9.000E+002 
04  ESP_EXCHANGE      3   ?               6.000E+000   FUNKY_OPT_UNIQUE  1.514E-004   9.000E+002 
03  HASH_PARTIAL_GRO  2   ?               6.000E+000   FUNKY_OPT_UNIQUE  6.686E-001   9.000E+002 
02  PARTITION_ACCESS  1   ?               5.864E+008   FUNKY_OPT_UNIQUE  0.000E+000   8.993E+002 
01  FILE_SCAN         ?   ?   LINEITEM    5.864E+008   FUNKY_OPT_UNIQUE  8.993E+002   8.993E+002 

--- 8 row(s) selected.
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

7    .    8    root                                                  6.00E+000
6    .    7    esp_exchange                    1:8(hash2) (m)        6.00E+000
5    .    6    sort_partial_groupby                                  6.00E+000
4    .    5    sort                                                  6.00E+000
3    .    4    esp_exchange                    8(hash2):8(hash2)     6.00E+000
2    .    3    hash_partial_groupby                                  6.00E+000
1    .    2    partition_access                                      5.86E+008
.    .    1    file_scan             fs fr     LINEITEM              5.86E+008

--- SQL operation complete.
>>obey optdml03(q02);
>>--------------------
>>--  TPCH Query 02 --
>>--------------------
>>prepare XX from
+>SELECT [FIRST 100] s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address,
+>       s_phone, s_comment
+>FROM part,supplier,partsupp, nation, region
+>WHERE p_partkey = ps_partkey
+>      AND s_suppkey = ps_suppkey
+>      AND p_size = 15
+>      AND p_type like  '%BRASS'
+>      AND s_nationkey = n_nationkey
+>      AND n_regionkey = r_regionkey
+>      AND r_name = 'EUROPE'
+>      AND ps_supplycost = (SELECT MIN(ps_supplycost)
+>                           FROM partsupp, supplier, nation, region
+>                           WHERE p_partkey = ps_partkey
+>                                 AND s_suppkey = ps_suppkey
+>                                 AND s_nationkey = n_nationkey
+>                                 AND n_regionkey = r_regionkey
+>                                 AND r_name = 'EUROPE')
+>ORDER BY s_acctbal desc, n_name, s_name, p_partkey;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

39  ROOT              38  ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   2.100E+002 
38  FIRSTN            37  ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   2.100E+002 
37  ESP_EXCHANGE      36  ?               1.000E+000   FUNKY_OPT_UNIQUE  1.317E-004   2.100E+002 
36  SORT              35  ?               1.000E+000   FUNKY_OPT_UNIQUE  7.662E-008   2.100E+002 
35  HASH_GROUPBY      34  ?               1.000E+000   FUNKY_OPT_UNIQUE  1.592E-004   2.100E+002 
34  HYBRID_HASH_JOIN  33  3               1.598E+004   FUNKY_OPT_UNIQUE  9.609E-004   2.100E+002 
33  HYBRID_HASH_JOIN  32  6               7.991E+004   FUNKY_OPT_UNIQUE  1.566E-003   2.100E+002 
32  HYBRID_HASH_JOIN  31  29              7.991E+004   FUNKY_OPT_UNIQUE  9.736E-003   2.100E+002 
31  PARTITION_ACCESS  30  ?               1.000E+006   FUNKY_OPT_UNIQUE  0.000E+000   2.096E+000 
30  FILE_SCAN         ?   ?   SUPPLIER    1.000E+006   FUNKY_OPT_UNIQUE  2.096E+000   2.096E+000 
29  ESP_EXCHANGE      28  ?               7.991E+004   FUNKY_OPT_UNIQUE  2.416E-003   2.079E+002 
28  NESTED_JOIN       25  27              7.991E+004   FUNKY_OPT_UNIQUE  4.890E-004   2.079E+002 
27  PARTITION_ACCESS  26  ?               4.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   7.594E+001 
26  FILE_SCAN         ?   ?   PARTSUPP    4.000E+000   FUNKY_OPT_UNIQUE  7.594E+001   7.594E+001 
25  ESP_EXCHANGE      24  ?               1.997E+004   FUNKY_OPT_UNIQUE  8.299E-004   1.320E+002 
24  HYBRID_HASH_JOIN  23  9               1.997E+004   FUNKY_OPT_UNIQUE  4.638E-004   1.320E+002 
23  HYBRID_HASH_JOIN  22  12              9.989E+004   FUNKY_OPT_UNIQUE  7.799E-004   1.320E+002 
22  HYBRID_HASH_JOIN  21  18              9.989E+004   FUNKY_OPT_UNIQUE  2.501E-003   1.319E+002 
21  ESP_EXCHANGE      20  ?               1.000E+006   FUNKY_OPT_UNIQUE  1.059E-002   1.321E-001 
20  PARTITION_ACCESS  19  ?               1.000E+006   FUNKY_OPT_UNIQUE  0.000E+000   1.215E-001 
19  INDEX_SCAN        ?   ?   SUPPLIER    1.000E+006   FUNKY_OPT_UNIQUE  1.215E-001   1.215E-001 
18  ESP_EXCHANGE      17  ?               9.989E+004   FUNKY_OPT_UNIQUE  2.655E-003   1.318E+002 
17  NESTED_JOIN       14  16              9.989E+004   FUNKY_OPT_UNIQUE  5.537E-004   1.318E+002 
16  PARTITION_ACCESS  15  ?               4.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   9.491E+001 
15  FILE_SCAN         ?   ?   PARTSUPP    4.000E+000   FUNKY_OPT_UNIQUE  9.491E+001   9.491E+001 
14  PARTITION_ACCESS  13  ?               2.497E+004   FUNKY_OPT_UNIQUE  0.000E+000   3.694E+001 
13  FILE_SCAN         ?   ?   PART        2.497E+004   FUNKY_OPT_UNIQUE  3.694E+001   3.694E+001 
12  ESP_EXCHANGE      11  ?               2.500E+001   FUNKY_OPT_UNIQUE  2.048E-004   2.766E-003 
11  PARTITION_ACCESS  10  ?               2.500E+001   FUNKY_OPT_UNIQUE  0.000E+000   2.562E-003 
10  FILE_SCAN         ?   ?   NATION      2.500E+001   FUNKY_OPT_UNIQUE  2.562E-003   2.562E-003 
09  ESP_EXCHANGE      8   ?               1.000E+000   FUNKY_OPT_UNIQUE  1.341E-004   2.694E-003 
08  PARTITION_ACCESS  7   ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   2.560E-003 
07  FILE_SCAN         ?   ?   REGION      1.000E+000   FUNKY_OPT_UNIQUE  2.560E-003   2.560E-003 
06  ESP_EXCHANGE      5   ?               2.500E+001   FUNKY_OPT_UNIQUE  4.161E-004   2.978E-003 
05  PARTITION_ACCESS  4   ?               2.500E+001   FUNKY_OPT_UNIQUE  0.000E+000   2.562E-003 
04  FILE_SCAN         ?   ?   NATION      2.500E+001   FUNKY_OPT_UNIQUE  2.562E-003   2.562E-003 
03  ESP_EXCHANGE      2   ?               1.000E+000   FUNKY_OPT_UNIQUE  1.341E-004   2.694E-003 
02  PARTITION_ACCESS  1   ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   2.560E-003 
01  FILE_SCAN         ?   ?   REGION      1.000E+000   FUNKY_OPT_UNIQUE  2.560E-003   2.560E-003 

--- 39 row(s) selected.
>>
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

38   .    39   root                                                  1.00E+000
37   .    38   firstn                                                1.00E+000
36   .    37   esp_exchange                    1:8(hash2) (m)        1.00E+000
35   .    36   sort                                                  1.00E+000
34   .    35   hash_groupby                                          1.00E+000
33   3    34   hybrid_hash_join      u                               1.59E+004
32   6    33   hybrid_hash_join      u                               7.99E+004
31   29   32   hybrid_hash_join                                      7.99E+004
30   .    31   partition_access                                      1.00E+006
.    .    30   file_scan             fs fr     SUPPLIER              1.00E+006
28   .    29   esp_exchange                    8(hash2):8(hash2)     7.99E+004
25   27   28   nested_join                                           7.99E+004
26   .    27   partition_access                                      4.00E+000
.    .    26   file_scan             fs fr     PARTSUPP              4.00E+000
24   .    25   esp_exchange                    8(hash2):8(hash2)     1.99E+004
23   9    24   hybrid_hash_join      u                               1.99E+004
22   12   23   hybrid_hash_join      u                               9.98E+004
21   18   22   hybrid_hash_join                                      9.98E+004
20   .    21   esp_exchange                    8(hash2):8(hash2)     1.00E+006
19   .    20   partition_access                                      1.00E+006
.    .    19   index_scan            fs fr     SUIDX2                1.00E+006
17   .    18   esp_exchange                    8(hash2):8(hash2)     9.98E+004
14   16   17   nested_join                                           9.98E+004
15   .    16   partition_access                                      4.00E+000
.    .    15   file_scan             fs fr     PARTSUPP              4.00E+000
13   .    14   partition_access                                      2.49E+004
.    .    13   file_scan             fs fr     PART                  2.49E+004
11   .    12   esp_exchange                    8(rep-b):1 (m)        2.50E+001
10   .    11   partition_access                                      2.50E+001
.    .    10   file_scan             fs fr     NATION                2.50E+001
8    .    9    esp_exchange                    8(rep-b):1 (m)        1.00E+000
7    .    8    partition_access                                      1.00E+000
.    .    7    file_scan             fs fr     REGION                1.00E+000
5    .    6    esp_exchange                    8(rep-b):1 (m)        2.50E+001
4    .    5    partition_access                                      2.50E+001
.    .    4    file_scan             fs fr     NATION                2.50E+001
2    .    3    esp_exchange                    8(rep-b):1 (m)        1.00E+000
1    .    2    partition_access                                      1.00E+000
.    .    1    file_scan             fs fr     REGION                1.00E+000

--- SQL operation complete.
>>obey optdml03(q03);
>>--------------------
>>--  TPCH Query 03 --
>>--------------------
>>prepare XX from
+>SELECT [FIRST 10] l_orderkey, 
+>       CAST(SUM(l_extendedprice*(1-l_discount))AS NUMERIC(18,2)) AS revenue,
+>       o_orderdate, o_shippriority
+>FROM customer,orders,lineitem
+>WHERE c_mktsegment = 'BUILDING'
+>      AND c_custkey = o_custkey
+>      AND l_orderkey = o_orderkey
+>      AND o_orderdate < DATE '1995-03-15'
+>      AND l_shipdate > DATE '1995-03-15'
+>GROUP BY l_orderkey, o_orderdate, o_shippriority
+>ORDER BY revenue DESC, o_orderdate;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

14  ROOT              13  ?               4.717E+007   FUNKY_OPT_UNIQUE  0.000E+000   1.151E+003 
13  FIRSTN            12  ?               4.717E+007   FUNKY_OPT_UNIQUE  0.000E+000   1.151E+003 
12  ESP_EXCHANGE      11  ?               4.717E+007   FUNKY_OPT_UNIQUE  2.786E-009   1.151E+003 
11  SORT              10  ?               4.717E+007   FUNKY_OPT_UNIQUE  3.601E+000   1.151E+003 
10  HASH_GROUPBY      9   ?               4.717E+007   FUNKY_OPT_UNIQUE  2.929E-001   1.148E+003 
09  HYBRID_HASH_JOIN  8   6               4.717E+007   FUNKY_OPT_UNIQUE  9.747E-001   1.148E+003 
08  PARTITION_ACCESS  7   ?               3.231E+008   FUNKY_OPT_UNIQUE  0.000E+000   8.974E+002 
07  FILE_SCAN         ?   ?   LINEITEM    3.231E+008   FUNKY_OPT_UNIQUE  8.974E+002   8.974E+002 
06  HYBRID_HASH_JOIN  5   3               2.187E+007   FUNKY_OPT_UNIQUE  2.531E-001   2.496E+002 
05  PARTITION_ACCESS  4   ?               7.291E+007   FUNKY_OPT_UNIQUE  0.000E+000   2.127E+002 
04  FILE_SCAN         ?   ?   ORDERS      7.291E+007   FUNKY_OPT_UNIQUE  2.127E+002   2.127E+002 
03  ESP_EXCHANGE      2   ?               3.000E+006   FUNKY_OPT_UNIQUE  1.673E-001   3.667E+001 
02  PARTITION_ACCESS  1   ?               3.000E+006   FUNKY_OPT_UNIQUE  0.000E+000   3.651E+001 
01  FILE_SCAN         ?   ?   CUSTOMER    3.000E+006   FUNKY_OPT_UNIQUE  3.651E+001   3.651E+001 

--- 14 row(s) selected.
>>
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

13   .    14   root                                                  4.71E+007
12   .    13   firstn                                                4.71E+007
11   .    12   esp_exchange                    1:8(hash2) (m)        4.71E+007
10   .    11   sort                                                  4.71E+007
9    .    10   hash_groupby                                          4.71E+007
8    6    9    hybrid_hash_join                                      4.71E+007
7    .    8    partition_access                                      3.23E+008
.    .    7    file_scan             fs fr     LINEITEM              3.23E+008
5    3    6    hybrid_hash_join      u                               2.18E+007
4    .    5    partition_access                                      7.29E+007
.    .    4    file_scan             fs fr     ORDERS                7.29E+007
2    .    3    esp_exchange                    8(rep-b):8(hash2)     3.00E+006
1    .    2    partition_access                                      3.00E+006
.    .    1    file_scan             fs fr     CUSTOMER              3.00E+006

--- SQL operation complete.
>>obey optdml03(q04);
>>--------------------
>>--  TPCH Query 04 --
>>--------------------
>>prepare XX from
+>SELECT o_orderpriority, COUNT(*) as order_count
+>FROM orders
+>WHERE o_orderdate >= DATE '1993-07-01'
+>      AND o_orderdate < DATE '1993-07-01' + INTERVAL '3' MONTH
+>      AND EXISTS (SELECT *
+>                  FROM lineitem
+>                  WHERE l_orderkey = o_orderkey
+>                        AND l_commitdate < l_receiptdate)
+>GROUP BY o_orderpriority
+>ORDER BY o_orderpriority;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

11  ROOT              10  ?               5.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   1.109E+003 
10  ESP_EXCHANGE      9   ?               5.000E+000   FUNKY_OPT_UNIQUE  4.075E-005   1.109E+003 
09  SORT_PARTIAL_GRO  8   ?               5.000E+000   FUNKY_OPT_UNIQUE  5.050E-008   1.109E+003 
08  SORT              7   ?               5.000E+000   FUNKY_OPT_UNIQUE  3.174E-008   1.109E+003 
07  ESP_EXCHANGE      6   ?               5.000E+000   FUNKY_OPT_UNIQUE  8.020E-005   1.109E+003 
06  HASH_PARTIAL_GRO  5   ?               5.000E+000   FUNKY_OPT_UNIQUE  3.421E-003   1.109E+003 
05  HYBRID_HASH_SEMI  4   2               5.798E+006   FUNKY_OPT_UNIQUE  2.728E-001   1.109E+003 
04  PARTITION_ACCESS  3   ?               5.798E+006   FUNKY_OPT_UNIQUE  0.000E+000   2.125E+002 
03  FILE_SCAN         ?   ?   ORDERS      5.798E+006   FUNKY_OPT_UNIQUE  2.125E+002   2.125E+002 
02  PARTITION_ACCESS  1   ?               1.997E+008   FUNKY_OPT_UNIQUE  0.000E+000   8.969E+002 
01  FILE_SCAN         ?   ?   LINEITEM    1.997E+008   FUNKY_OPT_UNIQUE  8.969E+002   8.969E+002 

--- 11 row(s) selected.
>>
>>
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

10   .    11   root                                                  5.00E+000
9    .    10   esp_exchange                    1:8(hash2) (m)        5.00E+000
8    .    9    sort_partial_groupby                                  5.00E+000
7    .    8    sort                                                  5.00E+000
6    .    7    esp_exchange                    8(hash2):8(hash2)     5.00E+000
5    .    6    hash_partial_groupby                                  5.00E+000
4    2    5    hybrid_hash_semi_joi                                  5.79E+006
3    .    4    partition_access                                      5.79E+006
.    .    3    file_scan             fs fr     ORDERS                5.79E+006
1    .    2    partition_access                                      1.99E+008
.    .    1    file_scan             fs fr     LINEITEM              1.99E+008

--- SQL operation complete.
>>obey optdml03(q05);
>>--------------------
>>--  TPCH Query 05 --
>>--------------------
>>prepare XX from
+>SELECT n_name, 
+>       CAST(SUM(l_extendedprice*(1-l_discount)) AS NUMERIC(18,2)) AS revenue
+>FROM customer,orders,lineitem,supplier,nation, region
+>WHERE c_custkey = o_custkey
+>      AND o_orderkey = l_orderkey
+>      AND l_suppkey = s_suppkey
+>      AND c_nationkey= s_nationkey
+>      AND s_nationkey = n_nationkey
+>      AND n_regionkey = r_regionkey
+>      AND r_name =  'ASIA'
+>      AND o_orderdate >=  DATE '1994-01-01'
+>      AND o_orderdate <  DATE '1994-01-01' + INTERVAL '1' YEAR
+>GROUP BY n_name
+>ORDER BY revenue desc;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

29  ROOT              28  ?               2.500E+001   FUNKY_OPT_UNIQUE  0.000E+000   1.113E+003 
28  ESP_EXCHANGE      27  ?               2.500E+001   FUNKY_OPT_UNIQUE  5.797E-005   1.113E+003 
27  SORT              26  ?               2.500E+001   FUNKY_OPT_UNIQUE  1.917E-007   1.113E+003 
26  HASH_PARTIAL_GRO  25  ?               2.500E+001   FUNKY_OPT_UNIQUE  2.060E-007   1.113E+003 
25  ESP_EXCHANGE      24  ?               2.500E+001   FUNKY_OPT_UNIQUE  1.071E-004   1.113E+003 
24  HASH_PARTIAL_GRO  23  ?               2.500E+001   FUNKY_OPT_UNIQUE  6.769E-004   1.113E+003 
23  HYBRID_HASH_JOIN  22  3               7.302E+005   FUNKY_OPT_UNIQUE  9.112E-002   1.113E+003 
22  HYBRID_HASH_JOIN  21  19              1.825E+007   FUNKY_OPT_UNIQUE  1.724E+000   1.113E+003 
21  PARTITION_ACCESS  20  ?               5.994E+008   FUNKY_OPT_UNIQUE  0.000E+000   8.983E+002 
20  FILE_SCAN         ?   ?   LINEITEM    5.994E+008   FUNKY_OPT_UNIQUE  8.983E+002   8.983E+002 
19  ESP_EXCHANGE      18  ?               4.563E+006   FUNKY_OPT_UNIQUE  9.168E-002   2.135E+002 
18  HYBRID_HASH_JOIN  17  14              4.563E+006   FUNKY_OPT_UNIQUE  6.576E-002   2.134E+002 
17  ESP_EXCHANGE      16  ?               2.281E+007   FUNKY_OPT_UNIQUE  2.249E-001   2.128E+002 
16  PARTITION_ACCESS  15  ?               2.281E+007   FUNKY_OPT_UNIQUE  0.000E+000   2.125E+002 
15  FILE_SCAN         ?   ?   ORDERS      2.281E+007   FUNKY_OPT_UNIQUE  2.125E+002   2.125E+002 
14  ESP_EXCHANGE      13  ?               3.000E+006   FUNKY_OPT_UNIQUE  6.376E-002   5.939E-001 
13  NESTED_JOIN       10  12              3.000E+006   FUNKY_OPT_UNIQUE  1.050E-002   5.302E-001 
12  PARTITION_ACCESS  11  ?               6.000E+005   FUNKY_OPT_UNIQUE  0.000E+000   5.142E-001 
11  INDEX_SCAN        ?   ?   CUSTOMER    6.000E+005   FUNKY_OPT_UNIQUE  5.142E-001   5.142E-001 
10  ESP_EXCHANGE      9   ?               5.000E+000   FUNKY_OPT_UNIQUE  3.660E-004   5.491E-003 
09  MERGE_JOIN        5   8               5.000E+000   FUNKY_OPT_UNIQUE  5.572E-007   5.125E-003 
08  SORT              7   ?               2.500E+001   FUNKY_OPT_UNIQUE  2.325E-006   2.564E-003 
07  PARTITION_ACCESS  6   ?               2.500E+001   FUNKY_OPT_UNIQUE  0.000E+000   2.562E-003 
06  FILE_SCAN         ?   ?   NATION      2.500E+001   FUNKY_OPT_UNIQUE  2.562E-003   2.562E-003 
05  PARTITION_ACCESS  4   ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   2.560E-003 
04  FILE_SCAN         ?   ?   REGION      1.000E+000   FUNKY_OPT_UNIQUE  2.560E-003   2.560E-003 
03  ESP_EXCHANGE      2   ?               1.000E+006   FUNKY_OPT_UNIQUE  8.343E-002   2.050E-001 
02  PARTITION_ACCESS  1   ?               1.000E+006   FUNKY_OPT_UNIQUE  0.000E+000   1.215E-001 
01  INDEX_SCAN        ?   ?   SUPPLIER    1.000E+006   FUNKY_OPT_UNIQUE  1.215E-001   1.215E-001 

--- 29 row(s) selected.
>>
>>
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

28   .    29   root                                                  2.50E+001
27   .    28   esp_exchange                    1:8(hash2) (m)        2.50E+001
26   .    27   sort                                                  2.50E+001
25   .    26   hash_partial_groupby                                  2.50E+001
24   .    25   esp_exchange                    8(hash2):8(hash2)     2.50E+001
23   .    24   hash_partial_groupby                                  2.50E+001
22   3    23   hybrid_hash_join      u                               7.30E+005
21   19   22   hybrid_hash_join                                      1.82E+007
20   .    21   partition_access                                      5.99E+008
.    .    20   file_scan             fs fr     LINEITEM              5.99E+008
18   .    19   esp_exchange                    8(hash2):8(hash2)     4.56E+006
17   14   18   hybrid_hash_join                                      4.56E+006
16   .    17   esp_exchange                    8(hash2):8(hash2)     2.28E+007
15   .    16   partition_access                                      2.28E+007
.    .    15   file_scan             fs fr     ORDERS                2.28E+007
13   .    14   esp_exchange                    8(hash2):8(hash2)     3.00E+006
10   12   13   nested_join                                           3.00E+006
11   .    12   partition_access                                      6.00E+005
.    .    11   index_scan            fs fr     CUIDX2                6.00E+005
9    .    10   esp_exchange                    8(rep-b):1            5.00E+000
5    8    9    merge_join                                            5.00E+000
7    .    8    sort                                                  2.50E+001
6    .    7    partition_access                                      2.50E+001
.    .    6    file_scan             fs fr     NATION                2.50E+001
4    .    5    partition_access                                      1.00E+000
.    .    4    file_scan             fs fr     REGION                1.00E+000
2    .    3    esp_exchange                    8(rep-b):8(hash2)     1.00E+006
1    .    2    partition_access                                      1.00E+006
.    .    1    index_scan            fs fr     SUIDX2                1.00E+006

--- SQL operation complete.
>>obey optdml03(q06);
>>--------------------
>>--  TPCH Query 06 --
>>--------------------
>>prepare XX from
+>SELECT CAST(SUM(l_extendedprice*l_discount) AS NUMERIC(18,2)) AS revenue
+>FROM lineitem
+>WHERE l_shipdate >= DATE '1994-01-01'
+>      AND l_shipdate < DATE '1994-01-01' + INTERVAL '1' YEAR
+>      AND l_discount BETWEEN .06 - 0.01 AND .06 + 0.01
+>      AND l_quantity < 24;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

06  ROOT              5   ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   8.967E+002 
05  SORT_PARTIAL_AGG  4   ?               1.000E+000   FUNKY_OPT_UNIQUE  3.723E-008   8.967E+002 
04  SPLIT_TOP         3   ?               1.000E+000   FUNKY_OPT_UNIQUE  1.181E-007   8.967E+002 
03  PARTITION_ACCESS  2   ?               1.000E+000   FUNKY_OPT_UNIQUE  1.181E-007   8.967E+002 
02  SORT_PARTIAL_AGG  1   ?               1.000E+000   FUNKY_OPT_UNIQUE  1.931E-002   8.967E+002 
01  FILE_SCAN         ?   ?   LINEITEM    1.143E+007   FUNKY_OPT_UNIQUE  8.967E+002   8.967E+002 

--- 6 row(s) selected.
>>
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

5    .    6    root                                                  1.00E+000
4    .    5    sort_partial_aggr_ro                                  1.00E+000
3    .    4    split_top                       1:8(hash2)            1.00E+000
2    .    3    partition_access                                      1.00E+000
1    .    2    sort_partial_aggr_le                                  1.00E+000
.    .    1    file_scan             fs        LINEITEM              1.14E+007

--- SQL operation complete.
>>obey optdml03(q07);
>>--------------------
>>--  TPCH Query 07 --
>>--------------------
>>prepare XX from
+>SELECT supp_nation, cust_nation, yr, sum(volume) as revenue
+>   FROM
+>    (SELECT n1.n_name as supp_nation, n2.n_name as cust_nation,
+>             extract(year from l_shipdate) as yr,
+>       CAST(l_extendedprice*(1-l_discount) AS NUMERIC(18,2)) as volume
+>     FROM supplier,lineitem,orders,customer, nation n1, nation n2
+>     WHERE s_suppkey = l_suppkey
+>      AND o_orderkey = l_orderkey
+>      AND c_custkey = o_custkey
+>      AND s_nationkey = n1.n_nationkey
+>      AND c_nationkey = n2.n_nationkey
+>      AND ((n1.n_name  = 'FRANCE' AND
+>            n2.n_name = 'GERMANY')
+>          OR (n1.n_name = 'GERMANY'  AND
+>            n2.n_name = 'FRANCE'))
+>      AND l_shipdate BETWEEN  DATE '1995-01-01' AND  DATE '1996-12-31') as shipping
+>
+>GROUP BY supp_nation, cust_nation, yr
+>ORDER BY supp_nation, cust_nation, yr;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

29  ROOT              28  ?               1.000E+002   FUNKY_OPT_UNIQUE  0.000E+000   1.108E+003 
28  ESP_EXCHANGE      27  ?               1.000E+002   FUNKY_OPT_UNIQUE  8.915E-005   1.108E+003 
27  SORT_PARTIAL_GRO  26  ?               1.000E+002   FUNKY_OPT_UNIQUE  8.846E-007   1.108E+003 
26  SORT              25  ?               1.000E+002   FUNKY_OPT_UNIQUE  1.389E-006   1.108E+003 
25  ESP_EXCHANGE      24  ?               1.000E+002   FUNKY_OPT_UNIQUE  1.344E-004   1.108E+003 
24  HASH_PARTIAL_GRO  23  ?               1.000E+002   FUNKY_OPT_UNIQUE  7.114E-004   1.108E+003 
23  HYBRID_HASH_JOIN  22  3               5.828E+005   FUNKY_OPT_UNIQUE  1.297E-001   1.108E+003 
22  HYBRID_HASH_JOIN  21  19              2.188E+007   FUNKY_OPT_UNIQUE  7.173E-001   1.107E+003 
21  PARTITION_ACCESS  20  ?               1.821E+008   FUNKY_OPT_UNIQUE  0.000E+000   8.971E+002 
20  FILE_SCAN         ?   ?   LINEITEM    1.821E+008   FUNKY_OPT_UNIQUE  8.971E+002   8.971E+002 
19  ESP_EXCHANGE      18  ?               1.800E+007   FUNKY_OPT_UNIQUE  4.779E-001   2.099E+002 
18  NESTED_JOIN       14  17              1.800E+007   FUNKY_OPT_UNIQUE  9.468E-002   2.094E+002 
17  SPLIT_TOP         16  ?               1.500E+001   FUNKY_OPT_UNIQUE  1.253E-001   2.090E+002 
16  PARTITION_ACCESS  15  ?               1.500E+001   FUNKY_OPT_UNIQUE  1.253E-001   2.090E+002 
15  INDEX_SCAN        ?   ?   ORDERS      1.500E+001   FUNKY_OPT_UNIQUE  2.088E+002   2.088E+002 
14  NESTED_JOIN       10  13              1.200E+006   FUNKY_OPT_UNIQUE  5.569E-003   3.662E-001 
13  SPLIT_TOP         12  ?               6.000E+005   FUNKY_OPT_UNIQUE  8.358E-003   3.548E-001 
12  PARTITION_ACCESS  11  ?               6.000E+005   FUNKY_OPT_UNIQUE  8.358E-003   3.548E-001 
11  INDEX_SCAN        ?   ?   CUSTOMER    6.000E+005   FUNKY_OPT_UNIQUE  3.464E-001   3.464E-001 
10  HYBRID_HASH_JOIN  9   6               2.000E+000   FUNKY_OPT_UNIQUE  3.615E-006   5.882E-003 
09  ESP_EXCHANGE      8   ?               2.500E+001   FUNKY_OPT_UNIQUE  3.638E-004   2.926E-003 
08  PARTITION_ACCESS  7   ?               2.500E+001   FUNKY_OPT_UNIQUE  0.000E+000   2.562E-003 
07  FILE_SCAN         ?   ?   NATION)     2.500E+001   FUNKY_OPT_UNIQUE  2.562E-003   2.562E-003 
06  ESP_EXCHANGE      5   ?               2.500E+001   FUNKY_OPT_UNIQUE  3.900E-004   2.952E-003 
05  PARTITION_ACCESS  4   ?               2.500E+001   FUNKY_OPT_UNIQUE  0.000E+000   2.562E-003 
04  FILE_SCAN         ?   ?   NATION)     2.500E+001   FUNKY_OPT_UNIQUE  2.562E-003   2.562E-003 
03  ESP_EXCHANGE      2   ?               1.000E+006   FUNKY_OPT_UNIQUE  8.343E-002   2.050E-001 
02  PARTITION_ACCESS  1   ?               1.000E+006   FUNKY_OPT_UNIQUE  0.000E+000   1.215E-001 
01  INDEX_SCAN        ?   ?   SUPPLIER    1.000E+006   FUNKY_OPT_UNIQUE  1.215E-001   1.215E-001 

--- 29 row(s) selected.
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

28   .    29   root                                                  1.00E+002
27   .    28   esp_exchange                    1:8(hash2) (m)        1.00E+002
26   .    27   sort_partial_groupby                                  1.00E+002
25   .    26   sort                                                  1.00E+002
24   .    25   esp_exchange                    8(hash2):8(hash2)     1.00E+002
23   .    24   hash_partial_groupby                                  1.00E+002
22   3    23   hybrid_hash_join      u                               5.82E+005
21   19   22   hybrid_hash_join                                      2.18E+007
20   .    21   partition_access                                      1.82E+008
.    .    20   file_scan             fs fr     LINEITEM              1.82E+008
18   .    19   esp_exchange                    8(hash2):8(hash2)     1.80E+007
14   17   18   nested_join                                           1.80E+007
16   .    17   split_top                       8(rep-n):8(hash2)     1.50E+001
15   .    16   partition_access                                      1.50E+001
.    .    15   index_scan            fs fr     ORDIDX2               1.50E+001
10   13   14   nested_join                                           1.20E+006
12   .    13   split_top                       8(rep-n):8(hash2)     6.00E+005
11   .    12   partition_access                                      6.00E+005
.    .    11   index_scan            fs fr     CUIDX2                6.00E+005
9    6    10   hybrid_hash_join                                      2.00E+000
8    .    9    esp_exchange                    8(hash2):1 (m)        2.50E+001
7    .    8    partition_access                                      2.50E+001
.    .    7    file_scan             fs fr     NATION                2.50E+001
5    .    6    esp_exchange                    8(rep-b):1 (m)        2.50E+001
4    .    5    partition_access                                      2.50E+001
.    .    4    file_scan             fs fr     NATION                2.50E+001
2    .    3    esp_exchange                    8(rep-b):8(hash2)     1.00E+006
1    .    2    partition_access                                      1.00E+006
.    .    1    index_scan            fs fr     SUIDX2                1.00E+006

--- SQL operation complete.
>>obey optdml03(q08);
>>--------------------
>>--  TPCH Query 08 --
>>--------------------
>>prepare XX from
+>SELECT yr, sum(CASE when nation = 'BRAZIL'
+>                  then volume
+>                   else 0 end)
+>              / sum(volume) as mkt_share
+>  FROM
+>    (SELECT extract(year from o_orderdate) as yr,
+>       CAST(l_extendedprice*(1-l_discount) AS NUMERIC(16,2)) as volume,
+>          n2.n_name as nation
+>     FROM part,supplier,lineitem,orders,customer, nation n1, nation  n2,region
+>     WHERE p_partkey = l_partkey
+>      AND s_suppkey = l_suppkey
+>      AND l_orderkey = o_orderkey
+>      AND o_custkey = c_custkey
+>      AND c_nationkey = n1.n_nationkey
+>      AND n1.n_regionkey = r_regionkey
+>      AND r_name = 'AMERICA'
+>      AND s_nationkey = n2.n_nationkey
+>      AND o_orderdate BETWEEN  DATE '1995-01-01' AND  DATE '1996-12-31'
+>      AND p_type ='ECONOMY ANODIZED STEEL')  all_nations
+>GROUP BY yr
+>ORDER BY yr;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

37  ROOT              36  ?               2.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   1.152E+003 
36  ESP_EXCHANGE      35  ?               2.000E+000   FUNKY_OPT_UNIQUE  3.148E-005   1.152E+003 
35  SORT              34  ?               2.000E+000   FUNKY_OPT_UNIQUE  1.824E-008   1.152E+003 
34  HASH_PARTIAL_GRO  33  ?               2.000E+000   FUNKY_OPT_UNIQUE  4.212E-008   1.152E+003 
33  ESP_EXCHANGE      32  ?               2.000E+000   FUNKY_OPT_UNIQUE  8.193E-005   1.152E+003 
32  HASH_PARTIAL_GRO  31  ?               2.000E+000   FUNKY_OPT_UNIQUE  1.815E-004   1.152E+003 
31  HYBRID_HASH_JOIN  30  3               2.432E+005   FUNKY_OPT_UNIQUE  1.453E-003   1.152E+003 
30  HYBRID_HASH_JOIN  29  26              2.432E+005   FUNKY_OPT_UNIQUE  3.173E-003   1.152E+003 
29  ESP_EXCHANGE      28  ?               1.000E+006   FUNKY_OPT_UNIQUE  1.059E-002   1.321E-001 
28  PARTITION_ACCESS  27  ?               1.000E+006   FUNKY_OPT_UNIQUE  0.000E+000   1.215E-001 
27  INDEX_SCAN        ?   ?   SUPPLIER    1.000E+006   FUNKY_OPT_UNIQUE  1.215E-001   1.215E-001 
26  ESP_EXCHANGE      25  ?               2.432E+005   FUNKY_OPT_UNIQUE  4.477E-003   1.152E+003 
25  HYBRID_HASH_JOIN  24  6               2.432E+005   FUNKY_OPT_UNIQUE  4.647E-003   1.152E+003 
24  HYBRID_HASH_JOIN  23  9               1.216E+006   FUNKY_OPT_UNIQUE  7.843E-003   1.152E+003 
23  HYBRID_HASH_JOIN  22  19              1.216E+006   FUNKY_OPT_UNIQUE  3.366E-002   1.152E+003 
22  ESP_EXCHANGE      21  ?               1.500E+007   FUNKY_OPT_UNIQUE  1.562E-001   1.972E+000 
21  PARTITION_ACCESS  20  ?               1.500E+007   FUNKY_OPT_UNIQUE  0.000E+000   1.816E+000 
20  INDEX_SCAN        ?   ?   CUSTOMER    1.500E+007   FUNKY_OPT_UNIQUE  1.816E+000   1.816E+000 
19  ESP_EXCHANGE      18  ?               1.216E+006   FUNKY_OPT_UNIQUE  2.276E-002   1.150E+003 
18  HYBRID_HASH_JOIN  17  15              1.216E+006   FUNKY_OPT_UNIQUE  1.120E-001   1.150E+003 
17  PARTITION_ACCESS  16  ?               4.560E+007   FUNKY_OPT_UNIQUE  0.000E+000   2.126E+002 
16  FILE_SCAN         ?   ?   ORDERS      4.560E+007   FUNKY_OPT_UNIQUE  2.126E+002   2.126E+002 
15  HYBRID_HASH_JOIN  14  12              3.996E+006   FUNKY_OPT_UNIQUE  1.946E+000   9.375E+002 
14  PARTITION_ACCESS  13  ?               5.994E+008   FUNKY_OPT_UNIQUE  0.000E+000   8.986E+002 
13  FILE_SCAN         ?   ?   LINEITEM    5.994E+008   FUNKY_OPT_UNIQUE  8.986E+002   8.986E+002 
12  ESP_EXCHANGE      11  ?               1.333E+005   FUNKY_OPT_UNIQUE  7.563E-003   3.695E+001 
11  PARTITION_ACCESS  10  ?               1.333E+005   FUNKY_OPT_UNIQUE  0.000E+000   3.694E+001 
10  FILE_SCAN         ?   ?   PART        1.333E+005   FUNKY_OPT_UNIQUE  3.694E+001   3.694E+001 
09  ESP_EXCHANGE      8   ?               2.500E+001   FUNKY_OPT_UNIQUE  2.048E-004   2.766E-003 
08  PARTITION_ACCESS  7   ?               2.500E+001   FUNKY_OPT_UNIQUE  0.000E+000   2.562E-003 
07  FILE_SCAN         ?   ?   NATION)     2.500E+001   FUNKY_OPT_UNIQUE  2.562E-003   2.562E-003 
06  ESP_EXCHANGE      5   ?               1.000E+000   FUNKY_OPT_UNIQUE  1.341E-004   2.694E-003 
05  PARTITION_ACCESS  4   ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   2.560E-003 
04  FILE_SCAN         ?   ?   REGION      1.000E+000   FUNKY_OPT_UNIQUE  2.560E-003   2.560E-003 
03  ESP_EXCHANGE      2   ?               2.500E+001   FUNKY_OPT_UNIQUE  3.900E-004   2.952E-003 
02  PARTITION_ACCESS  1   ?               2.500E+001   FUNKY_OPT_UNIQUE  0.000E+000   2.562E-003 
01  FILE_SCAN         ?   ?   NATION)     2.500E+001   FUNKY_OPT_UNIQUE  2.562E-003   2.562E-003 

--- 37 row(s) selected.
>>
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

36   .    37   root                                                  2.00E+000
35   .    36   esp_exchange                    1:8(hash2) (m)        2.00E+000
34   .    35   sort                                                  2.00E+000
33   .    34   hash_partial_groupby                                  2.00E+000
32   .    33   esp_exchange                    8(hash2):8(hash2)     2.00E+000
31   .    32   hash_partial_groupby                                  2.00E+000
30   3    31   hybrid_hash_join      u                               2.43E+005
29   26   30   hybrid_hash_join                                      2.43E+005
28   .    29   esp_exchange                    8(hash2):8(hash2)     1.00E+006
27   .    28   partition_access                                      1.00E+006
.    .    27   index_scan            fs fr     SUIDX2                1.00E+006
25   .    26   esp_exchange                    8(hash2):8(hash2)     2.43E+005
24   6    25   hybrid_hash_join      u                               2.43E+005
23   9    24   hybrid_hash_join      u                               1.21E+006
22   19   23   hybrid_hash_join                                      1.21E+006
21   .    22   esp_exchange                    8(hash2):8(hash2)     1.50E+007
20   .    21   partition_access                                      1.50E+007
.    .    20   index_scan            fs fr     CUIDX2                1.50E+007
18   .    19   esp_exchange                    8(hash2):8(hash2)     1.21E+006
17   15   18   hybrid_hash_join                                      1.21E+006
16   .    17   partition_access                                      4.56E+007
.    .    16   file_scan             fs fr     ORDERS                4.56E+007
14   12   15   hybrid_hash_join      u                               3.99E+006
13   .    14   partition_access                                      5.99E+008
.    .    13   file_scan             fs fr     LINEITEM              5.99E+008
11   .    12   esp_exchange                    8(rep-b):8(hash2)     1.33E+005
10   .    11   partition_access                                      1.33E+005
.    .    10   file_scan             fs fr     PART                  1.33E+005
8    .    9    esp_exchange                    8(rep-b):1 (m)        2.50E+001
7    .    8    partition_access                                      2.50E+001
.    .    7    file_scan             fs fr     NATION                2.50E+001
5    .    6    esp_exchange                    8(rep-b):1 (m)        1.00E+000
4    .    5    partition_access                                      1.00E+000
.    .    4    file_scan             fs fr     REGION                1.00E+000
2    .    3    esp_exchange                    8(rep-b):1 (m)        2.50E+001
1    .    2    partition_access                                      2.50E+001
.    .    1    file_scan             fs fr     NATION                2.50E+001

--- SQL operation complete.
>>obey optdml03(q09);
>>--------------------
>>--  TPCH Query 09 --
>>--------------------
>>
>>prepare XX from
+>SELECT nation, yr, sum(amount) as sum_profit
+>  from  (SELECT n_name as nation, EXTRACT (YEAR from o_orderdate) as yr,
+>                l_extendedprice*(1-l_discount)-ps_supplycost*l_quantity as amount
+>FROM part,supplier,lineitem,partsupp,orders, nation
+>WHERE s_suppkey  = l_suppkey
+>      AND ps_suppkey = l_suppkey
+>      AND ps_partkey = l_partkey
+>      AND p_partkey  = l_partkey
+>      AND o_orderkey = l_orderkey
+>      AND p_name like '%green%'
+>      AND s_nationkey = n_nationkey) as profit
+>GROUP BY nation, yr
+>ORDER BY nation, yr DESC;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

28  ROOT              27  ?               1.750E+002   FUNKY_OPT_UNIQUE  0.000E+000   1.141E+003 
27  ESP_EXCHANGE      26  ?               1.750E+002   FUNKY_OPT_UNIQUE  8.877E-005   1.141E+003 
26  SORT_PARTIAL_GRO  25  ?               1.750E+002   FUNKY_OPT_UNIQUE  1.289E-006   1.141E+003 
25  SORT              24  ?               1.750E+002   FUNKY_OPT_UNIQUE  2.310E-006   1.141E+003 
24  ESP_EXCHANGE      23  ?               1.750E+002   FUNKY_OPT_UNIQUE  1.131E-004   1.141E+003 
23  HASH_PARTIAL_GRO  22  ?               1.750E+002   FUNKY_OPT_UNIQUE  3.655E-002   1.141E+003 
22  HYBRID_HASH_JOIN  21  3               3.746E+007   FUNKY_OPT_UNIQUE  2.483E-001   1.141E+003 
21  HYBRID_HASH_JOIN  20  17              3.746E+007   FUNKY_OPT_UNIQUE  4.624E-001   1.141E+003 
20  ESP_EXCHANGE      19  ?               1.500E+008   FUNKY_OPT_UNIQUE  1.478E+000   1.963E+001 
19  PARTITION_ACCESS  18  ?               1.500E+008   FUNKY_OPT_UNIQUE  0.000E+000   1.815E+001 
18  INDEX_SCAN        ?   ?   ORDERS      1.500E+008   FUNKY_OPT_UNIQUE  1.815E+001   1.815E+001 
17  HYBRID_HASH_JOIN  16  14              3.746E+007   FUNKY_OPT_UNIQUE  2.277E+000   1.121E+003 
16  PARTITION_ACCESS  15  ?               5.994E+008   FUNKY_OPT_UNIQUE  0.000E+000   8.987E+002 
15  FILE_SCAN         ?   ?   LINEITEM    5.994E+008   FUNKY_OPT_UNIQUE  8.987E+002   8.987E+002 
14  ESP_EXCHANGE      13  ?               5.000E+006   FUNKY_OPT_UNIQUE  6.232E-001   2.205E+002 
13  HYBRID_HASH_JOIN  12  6               5.000E+006   FUNKY_OPT_UNIQUE  2.752E-002   2.198E+002 
12  ESP_EXCHANGE      11  ?               5.000E+006   FUNKY_OPT_UNIQUE  6.991E-002   2.197E+002 
11  HYBRID_HASH_JOIN  10  8               5.000E+006   FUNKY_OPT_UNIQUE  2.085E-001   2.196E+002 
10  PARTITION_ACCESS  9   ?               8.000E+007   FUNKY_OPT_UNIQUE  0.000E+000   1.824E+002 
09  FILE_SCAN         ?   ?   PARTSUPP    8.000E+007   FUNKY_OPT_UNIQUE  1.824E+002   1.824E+002 
08  PARTITION_ACCESS  7   ?               1.250E+006   FUNKY_OPT_UNIQUE  0.000E+000   3.695E+001 
07  FILE_SCAN         ?   ?   PART        1.250E+006   FUNKY_OPT_UNIQUE  3.695E+001   3.695E+001 
06  ESP_EXCHANGE      5   ?               1.000E+006   FUNKY_OPT_UNIQUE  1.059E-002   1.321E-001 
05  PARTITION_ACCESS  4   ?               1.000E+006   FUNKY_OPT_UNIQUE  0.000E+000   1.215E-001 
04  INDEX_SCAN        ?   ?   SUPPLIER    1.000E+006   FUNKY_OPT_UNIQUE  1.215E-001   1.215E-001 
03  ESP_EXCHANGE      2   ?               2.500E+001   FUNKY_OPT_UNIQUE  3.900E-004   2.952E-003 
02  PARTITION_ACCESS  1   ?               2.500E+001   FUNKY_OPT_UNIQUE  0.000E+000   2.562E-003 
01  FILE_SCAN         ?   ?   NATION      2.500E+001   FUNKY_OPT_UNIQUE  2.562E-003   2.562E-003 

--- 28 row(s) selected.
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

27   .    28   root                                                  1.75E+002
26   .    27   esp_exchange                    1:8(hash2) (m)        1.75E+002
25   .    26   sort_partial_groupby                                  1.75E+002
24   .    25   sort                                                  1.75E+002
23   .    24   esp_exchange                    8(hash2):8(hash2)     1.75E+002
22   .    23   hash_partial_groupby                                  1.75E+002
21   3    22   hybrid_hash_join      u                               3.74E+007
20   17   21   hybrid_hash_join                                      3.74E+007
19   .    20   esp_exchange                    8(hash2):8(hash2)     1.50E+008
18   .    19   partition_access                                      1.50E+008
.    .    18   index_scan            fs fr     ORDIDX3               1.50E+008
16   14   17   hybrid_hash_join                                      3.74E+007
15   .    16   partition_access                                      5.99E+008
.    .    15   file_scan             fs fr     LINEITEM              5.99E+008
13   .    14   esp_exchange                    8(rep-b):8(hash2)     5.00E+006
12   6    13   hybrid_hash_join      u                               5.00E+006
11   .    12   esp_exchange                    8(hash2):8(hash2)     5.00E+006
10   8    11   hybrid_hash_join                                      5.00E+006
9    .    10   partition_access                                      8.00E+007
.    .    9    file_scan             fs fr     PARTSUPP              8.00E+007
7    .    8    partition_access                                      1.25E+006
.    .    7    file_scan             fs fr     PART                  1.25E+006
5    .    6    esp_exchange                    8(hash2):8(hash2)     1.00E+006
4    .    5    partition_access                                      1.00E+006
.    .    4    index_scan            fs fr     SUIDX2                1.00E+006
2    .    3    esp_exchange                    8(rep-b):1 (m)        2.50E+001
1    .    2    partition_access                                      2.50E+001
.    .    1    file_scan             fs fr     NATION                2.50E+001

--- SQL operation complete.
>>obey optdml03(q10);
>>--------------------
>>--  TPCH Query 10 --
>>--------------------
>>prepare XX from
+>SELECT [FIRST 20] c_custkey, c_name,
+>       CAST(SUM(l_extendedprice*(1-l_discount)) AS NUMERIC(18,2)) AS revenue,
+>       c_acctbal,  n_name, c_address, c_phone, c_comment
+>FROM customer,orders,lineitem, nation
+>WHERE c_custkey = o_custkey
+>      AND l_orderkey = o_orderkey
+>      AND o_orderdate >=  DATE '1993-10-01'
+>      AND o_orderdate <  DATE '1993-10-01' + INTERVAL '3' MONTH
+>      AND l_returnflag = 'R'
+>      AND c_nationkey = n_nationkey
+>GROUP BY c_custkey, c_name, c_acctbal, c_phone, n_name,
+>         c_address, c_comment
+>ORDER BY revenue DESC;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

18  ROOT              17  ?               5.723E+006   FUNKY_OPT_UNIQUE  0.000E+000   1.147E+003 
17  FIRSTN            16  ?               5.723E+006   FUNKY_OPT_UNIQUE  0.000E+000   1.147E+003 
16  ESP_EXCHANGE      15  ?               5.723E+006   FUNKY_OPT_UNIQUE  2.786E-009   1.147E+003 
15  SORT              14  ?               5.723E+006   FUNKY_OPT_UNIQUE  5.984E-001   1.147E+003 
14  HASH_GROUPBY      13  ?               5.723E+006   FUNKY_OPT_UNIQUE  1.111E-001   1.147E+003 
13  HYBRID_HASH_JOIN  12  3               5.723E+006   FUNKY_OPT_UNIQUE  1.083E-001   1.147E+003 
12  HYBRID_HASH_JOIN  11  9               5.723E+006   FUNKY_OPT_UNIQUE  2.022E-001   1.146E+003 
11  PARTITION_ACCESS  10  ?               1.500E+007   FUNKY_OPT_UNIQUE  0.000E+000   3.664E+001 
10  FILE_SCAN         ?   ?   CUSTOMER    1.500E+007   FUNKY_OPT_UNIQUE  3.664E+001   3.664E+001 
09  ESP_EXCHANGE      8   ?               5.723E+006   FUNKY_OPT_UNIQUE  7.999E-002   1.110E+003 
08  HYBRID_HASH_JOIN  7   5               5.723E+006   FUNKY_OPT_UNIQUE  3.845E-001   1.109E+003 
07  PARTITION_ACCESS  6   ?               1.479E+008   FUNKY_OPT_UNIQUE  0.000E+000   8.970E+002 
06  FILE_SCAN         ?   ?   LINEITEM    1.479E+008   FUNKY_OPT_UNIQUE  8.970E+002   8.970E+002 
05  PARTITION_ACCESS  4   ?               5.798E+006   FUNKY_OPT_UNIQUE  0.000E+000   2.125E+002 
04  FILE_SCAN         ?   ?   ORDERS      5.798E+006   FUNKY_OPT_UNIQUE  2.125E+002   2.125E+002 
03  ESP_EXCHANGE      2   ?               2.500E+001   FUNKY_OPT_UNIQUE  3.900E-004   2.952E-003 
02  PARTITION_ACCESS  1   ?               2.500E+001   FUNKY_OPT_UNIQUE  0.000E+000   2.562E-003 
01  FILE_SCAN         ?   ?   NATION      2.500E+001   FUNKY_OPT_UNIQUE  2.562E-003   2.562E-003 

--- 18 row(s) selected.
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

17   .    18   root                                                  5.72E+006
16   .    17   firstn                                                5.72E+006
15   .    16   esp_exchange                    1:8(hash2) (m)        5.72E+006
14   .    15   sort                                                  5.72E+006
13   .    14   hash_groupby                                          5.72E+006
12   3    13   hybrid_hash_join      u                               5.72E+006
11   9    12   hybrid_hash_join                                      5.72E+006
10   .    11   partition_access                                      1.50E+007
.    .    10   file_scan             fs fr     CUSTOMER              1.50E+007
8    .    9    esp_exchange                    8(hash2):8(hash2)     5.72E+006
7    5    8    hybrid_hash_join                                      5.72E+006
6    .    7    partition_access                                      1.47E+008
.    .    6    file_scan             fs fr     LINEITEM              1.47E+008
4    .    5    partition_access                                      5.79E+006
.    .    4    file_scan             fs fr     ORDERS                5.79E+006
2    .    3    esp_exchange                    8(rep-b):1 (m)        2.50E+001
1    .    2    partition_access                                      2.50E+001
.    .    1    file_scan             fs fr     NATION                2.50E+001

--- SQL operation complete.
>>obey optdml03(q11);
>>--------------------
>>--  TPCH Query 11 --
>>--------------------
>>prepare XX from
+>SELECT ps_partkey, SUM(ps_supplycost * ps_availqty) AS ps_value
+>FROM partsupp,supplier,nation
+>WHERE ps_suppkey = s_suppkey
+>      AND s_nationkey = n_nationkey
+>      AND n_name = 'GERMANY'
+>GROUP BY ps_partkey
+>HAVING SUM(ps_supplycost*ps_availqty) >
+>       (SELECT SUM(ps_supplycost*ps_availqty) * 0.000001
+>        FROM partsupp,supplier,nation
+>        WHERE ps_suppkey = s_suppkey
+>              AND s_nationkey = n_nationkey
+>              AND n_name = 'GERMANY')
+>ORDER BY ps_value DESC;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

29  ROOT              28  ?               1.074E+006   FUNKY_OPT_UNIQUE  0.000E+000   3.656E+002 
28  ESP_EXCHANGE      27  ?               1.074E+006   FUNKY_OPT_UNIQUE  2.786E-009   3.656E+002 
27  SORT              26  ?               1.074E+006   FUNKY_OPT_UNIQUE  2.643E-002   3.656E+002 
26  HYBRID_HASH_JOIN  25  14              1.074E+006   FUNKY_OPT_UNIQUE  1.944E-002   3.656E+002 
25  HASH_GROUPBY      24  ?               3.223E+006   FUNKY_OPT_UNIQUE  2.073E-002   1.829E+002 
24  HYBRID_HASH_JOIN  23  21              3.223E+006   FUNKY_OPT_UNIQUE  2.680E-001   1.828E+002 
23  PARTITION_ACCESS  22  ?               8.000E+007   FUNKY_OPT_UNIQUE  0.000E+000   1.825E+002 
22  FILE_SCAN         ?   ?   PARTSUPP    8.000E+007   FUNKY_OPT_UNIQUE  1.825E+002   1.825E+002 
21  ESP_EXCHANGE      20  ?               4.028E+004   FUNKY_OPT_UNIQUE  1.809E-002   5.395E-002 
20  NESTED_JOIN       17  19              4.028E+004   FUNKY_OPT_UNIQUE  4.912E-005   3.585E-002 
19  PARTITION_ACCESS  18  ?               4.028E+004   FUNKY_OPT_UNIQUE  0.000E+000   3.311E-002 
18  INDEX_SCAN        ?   ?   SUPPLIER    4.028E+004   FUNKY_OPT_UNIQUE  3.311E-002   3.311E-002 
17  ESP_EXCHANGE      16  ?               1.000E+000   FUNKY_OPT_UNIQUE  1.341E-004   2.695E-003 
16  PARTITION_ACCESS  15  ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   2.561E-003 
15  FILE_SCAN         ?   ?   NATION      1.000E+000   FUNKY_OPT_UNIQUE  2.561E-003   2.561E-003 
14  ESP_EXCHANGE      13  ?               1.000E+000   FUNKY_OPT_UNIQUE  3.000E-004   1.827E+002 
13  SORT_PARTIAL_AGG  12  ?               1.000E+000   FUNKY_OPT_UNIQUE  3.740E-008   1.827E+002 
12  ESP_EXCHANGE      11  ?               1.000E+000   FUNKY_OPT_UNIQUE  8.385E-006   1.827E+002 
11  SORT_PARTIAL_AGG  10  ?               1.000E+000   FUNKY_OPT_UNIQUE  1.242E-003   1.827E+002 
10  HYBRID_HASH_JOIN  9   7               3.223E+006   FUNKY_OPT_UNIQUE  1.890E-001   1.827E+002 
09  PARTITION_ACCESS  8   ?               8.000E+007   FUNKY_OPT_UNIQUE  0.000E+000   1.824E+002 
08  FILE_SCAN         ?   ?   PARTSUPP    8.000E+007   FUNKY_OPT_UNIQUE  1.824E+002   1.824E+002 
07  ESP_EXCHANGE      6   ?               4.028E+004   FUNKY_OPT_UNIQUE  1.809E-002   5.395E-002 
06  NESTED_JOIN       3   5               4.028E+004   FUNKY_OPT_UNIQUE  4.912E-005   3.585E-002 
05  PARTITION_ACCESS  4   ?               4.028E+004   FUNKY_OPT_UNIQUE  0.000E+000   3.311E-002 
04  INDEX_SCAN        ?   ?   SUPPLIER    4.028E+004   FUNKY_OPT_UNIQUE  3.311E-002   3.311E-002 
03  ESP_EXCHANGE      2   ?               1.000E+000   FUNKY_OPT_UNIQUE  1.341E-004   2.695E-003 
02  PARTITION_ACCESS  1   ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   2.561E-003 
01  FILE_SCAN         ?   ?   NATION      1.000E+000   FUNKY_OPT_UNIQUE  2.561E-003   2.561E-003 

--- 29 row(s) selected.
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

28   .    29   root                                                  1.07E+006
27   .    28   esp_exchange                    1:8(hash2) (m)        1.07E+006
26   .    27   sort                                                  1.07E+006
25   14   26   hybrid_hash_join                                      1.07E+006
24   .    25   hash_groupby                                          3.22E+006
23   21   24   hybrid_hash_join      u                               3.22E+006
22   .    23   partition_access                                      8.00E+007
.    .    22   file_scan             fs fr     PARTSUPP              8.00E+007
20   .    21   esp_exchange                    8(rep-b):8(hash2)     4.02E+004
17   19   20   nested_join                                           4.02E+004
18   .    19   partition_access                                      4.02E+004
.    .    18   index_scan            fs fr     SUIDX2                4.02E+004
16   .    17   esp_exchange                    8(rep-b):1 (m)        1.00E+000
15   .    16   partition_access                                      1.00E+000
.    .    15   file_scan             fs fr     NATION                1.00E+000
13   .    14   esp_exchange                    8(rep-b):1            1.00E+000
12   .    13   sort_partial_aggr_ro                                  1.00E+000
11   .    12   esp_exchange                    1:8(hash2)            1.00E+000
10   .    11   sort_partial_aggr_le                                  1.00E+000
9    7    10   hybrid_hash_join      u                               3.22E+006
8    .    9    partition_access                                      8.00E+007
.    .    8    file_scan             fs fr     PARTSUPP              8.00E+007
6    .    7    esp_exchange                    8(rep-b):8(hash2)     4.02E+004
3    5    6    nested_join                                           4.02E+004
4    .    5    partition_access                                      4.02E+004
.    .    4    index_scan            fs fr     SUIDX2                4.02E+004
2    .    3    esp_exchange                    8(rep-b):1 (m)        1.00E+000
1    .    2    partition_access                                      1.00E+000
.    .    1    file_scan             fs fr     NATION                1.00E+000

--- SQL operation complete.
>>obey optdml03(q12);
>>--------------------
>>--  TPCH Query 12 --
>>--------------------
>>prepare XX from
+>SELECT l_shipmode,
+>       SUM(CASE WHEN o_orderpriority ='1-URGENT'
+>                     OR o_orderpriority ='2-HIGH'
+>                THEN 1
+>                ELSE 0
+>           END) AS high_line_count,
+>        SUM(CASE WHEN o_orderpriority <> '1-URGENT'
+>                      AND o_orderpriority <> '2-HIGH'
+>                 THEN 1
+>                 ELSE 0
+>            END) AS low_line_count
+>FROM orders,lineitem
+>where o_orderkey = l_orderkey
+>      AND l_shipmode in ('MAIL','SHIP')
+>      AND l_commitdate < l_receiptdate
+>      AND l_shipdate < l_commitdate
+>      AND l_receiptdate >=  DATE '1994-01-01'
+>      AND l_receiptdate <  DATE '1994-01-01' + INTERVAL '1' YEAR
+>GROUP BY l_shipmode
+>ORDER BY l_shipmode;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

11  ROOT              10  ?               2.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   1.109E+003 
10  ESP_EXCHANGE      9   ?               2.000E+000   FUNKY_OPT_UNIQUE  4.290E-005   1.109E+003 
09  SORT_PARTIAL_GRO  8   ?               2.000E+000   FUNKY_OPT_UNIQUE  5.369E-008   1.109E+003 
08  SORT              7   ?               2.000E+000   FUNKY_OPT_UNIQUE  3.375E-008   1.109E+003 
07  ESP_EXCHANGE      6   ?               2.000E+000   FUNKY_OPT_UNIQUE  8.527E-005   1.109E+003 
06  HASH_PARTIAL_GRO  5   ?               2.000E+000   FUNKY_OPT_UNIQUE  1.649E-003   1.109E+003 
05  HYBRID_HASH_JOIN  4   2               2.892E+006   FUNKY_OPT_UNIQUE  2.714E-001   1.109E+003 
04  PARTITION_ACCESS  3   ?               1.500E+008   FUNKY_OPT_UNIQUE  0.000E+000   2.128E+002 
03  FILE_SCAN         ?   ?   ORDERS      1.500E+008   FUNKY_OPT_UNIQUE  2.128E+002   2.128E+002 
02  PARTITION_ACCESS  1   ?               2.892E+006   FUNKY_OPT_UNIQUE  0.000E+000   8.966E+002 
01  FILE_SCAN         ?   ?   LINEITEM    2.892E+006   FUNKY_OPT_UNIQUE  8.966E+002   8.966E+002 

--- 11 row(s) selected.
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

10   .    11   root                                                  2.00E+000
9    .    10   esp_exchange                    1:8(hash2) (m)        2.00E+000
8    .    9    sort_partial_groupby                                  2.00E+000
7    .    8    sort                                                  2.00E+000
6    .    7    esp_exchange                    8(hash2):8(hash2)     2.00E+000
5    .    6    hash_partial_groupby                                  2.00E+000
4    2    5    hybrid_hash_join                                      2.89E+006
3    .    4    partition_access                                      1.50E+008
.    .    3    file_scan             fs fr     ORDERS                1.50E+008
1    .    2    partition_access                                      2.89E+006
.    .    1    file_scan             fs fr     LINEITEM              2.89E+006

--- SQL operation complete.
>>obey optdml03(q13);
>>--------------------
>>--  TPCH Query 13 --
>>--------------------
>>prepare XX from
+>
+>SELECT yr, sum(revenue) as revenue
+>  FROM
+>    (SELECT extract(year from o_orderdate) as yr,
+>       CAST(l_extendedprice * (1-l_discount) AS NUMERIC(18,2)) as revenue
+>FROM lineitem, orders
+>WHERE o_orderkey = l_orderkey
+>      AND o_clerk = 'Clerk#000000088'
+>      AND l_returnflag = 'R') as performance
+>GROUP BY yr
+>ORDER BY yr;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

11  ROOT              10  ?               7.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   2.182E+002 
10  ESP_EXCHANGE      9   ?               7.000E+000   FUNKY_OPT_UNIQUE  3.200E-005   2.182E+002 
09  SORT_PARTIAL_GRO  8   ?               7.000E+000   FUNKY_OPT_UNIQUE  3.283E-008   2.182E+002 
08  SORT              7   ?               7.000E+000   FUNKY_OPT_UNIQUE  1.824E-008   2.182E+002 
07  ESP_EXCHANGE      6   ?               7.000E+000   FUNKY_OPT_UNIQUE  6.257E-005   2.182E+002 
06  HASH_PARTIAL_GRO  5   ?               7.000E+000   FUNKY_OPT_UNIQUE  8.760E-007   2.182E+002 
05  NESTED_JOIN       2   4               1.481E+003   FUNKY_OPT_UNIQUE  8.567E-006   2.182E+002 
04  PARTITION_ACCESS  3   ?               9.873E-001   FUNKY_OPT_UNIQUE  0.000E+000   5.717E+000 
03  FILE_SCAN         ?   ?   LINEITEM    9.873E-001   FUNKY_OPT_UNIQUE  5.717E+000   5.717E+000 
02  PARTITION_ACCESS  1   ?               1.500E+003   FUNKY_OPT_UNIQUE  0.000E+000   2.125E+002 
01  FILE_SCAN         ?   ?   ORDERS      1.500E+003   FUNKY_OPT_UNIQUE  2.125E+002   2.125E+002 

--- 11 row(s) selected.
>>
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

10   .    11   root                                                  7.00E+000
9    .    10   esp_exchange                    1:8(hash2) (m)        7.00E+000
8    .    9    sort_partial_groupby                                  7.00E+000
7    .    8    sort                                                  7.00E+000
6    .    7    esp_exchange                    8(hash2):8(hash2)     7.00E+000
5    .    6    hash_partial_groupby                                  7.00E+000
2    4    5    nested_join                                           1.48E+003
3    .    4    partition_access                                      9.87E-001
.    .    3    file_scan             fs fr     LINEITEM              9.87E-001
1    .    2    partition_access                                      1.50E+003
.    .    1    file_scan             fs fr     ORDERS                1.50E+003

--- SQL operation complete.
>>obey optdml03(q14);
>>--------------------
>>--  TPCH Query 14 --
>>--------------------
>>prepare XX from
+>SELECT 100.00 * SUM(CASE WHEN p_type = 'promo' -- p_type like 'PROMO%'
+>                         THEN (l_extendedprice * (1-l_discount))
+>                         ELSE 0
+>                    END) / 
+>        SUM((l_extendedprice*(1-l_discount))) AS promo_revenue
+>FROM  lineitem, part
+>WHERE l_partkey = p_partkey
+>      AND l_shipdate >=  DATE '1995-09-01'
+>      AND l_shipdate <  DATE '1995-09-01' + INTERVAL '1' MONTH;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

10  ROOT              9   ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   9.339E+002 
09  SORT_PARTIAL_AGG  8   ?               1.000E+000   FUNKY_OPT_UNIQUE  3.882E-008   9.339E+002 
08  ESP_EXCHANGE      7   ?               1.000E+000   FUNKY_OPT_UNIQUE  1.257E-005   9.339E+002 
07  SORT_PARTIAL_AGG  6   ?               1.000E+000   FUNKY_OPT_UNIQUE  4.609E-003   9.339E+002 
06  HYBRID_HASH_JOIN  5   3               7.720E+006   FUNKY_OPT_UNIQUE  1.118E-001   9.339E+002 
05  PARTITION_ACCESS  4   ?               2.000E+007   FUNKY_OPT_UNIQUE  0.000E+000   3.701E+001 
04  FILE_SCAN         ?   ?   PART        2.000E+007   FUNKY_OPT_UNIQUE  3.701E+001   3.701E+001 
03  ESP_EXCHANGE      2   ?               7.720E+006   FUNKY_OPT_UNIQUE  1.205E-001   8.968E+002 
02  PARTITION_ACCESS  1   ?               7.720E+006   FUNKY_OPT_UNIQUE  0.000E+000   8.967E+002 
01  FILE_SCAN         ?   ?   LINEITEM    7.720E+006   FUNKY_OPT_UNIQUE  8.967E+002   8.967E+002 

--- 10 row(s) selected.
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

9    .    10   root                                                  1.00E+000
8    .    9    sort_partial_aggr_ro                                  1.00E+000
7    .    8    esp_exchange                    1:8(hash2)            1.00E+000
6    .    7    sort_partial_aggr_le                                  1.00E+000
5    3    6    hybrid_hash_join                                      7.72E+006
4    .    5    partition_access                                      2.00E+007
.    .    4    file_scan             fs fr     PART                  2.00E+007
2    .    3    esp_exchange                    8(hash2):8(hash2)     7.72E+006
1    .    2    partition_access                                      7.72E+006
.    .    1    file_scan             fs fr     LINEITEM              7.72E+006

--- SQL operation complete.
>>obey optdml03(q15);
>>--------------------
>>--  TPCH Query 15 --
>>--------------------
>>create view revenue (supplier_no, total_revenue) AS
+>     SELECT l_suppkey, SUM(l_extendedprice * (1-l_discount))
+>     FROM lineitem
+>     WHERE l_shipdate >= DATE '1996-01-01'
+>       AND l_shipdate <  DATE '1996-01-01' + INTERVAL '3' MONTH
+>     GROUP BY l_suppkey;

--- SQL operation complete.
>>
>>prepare XX from
+>SELECT s_suppkey, s_name, s_address, s_phone, total_revenue
+>FROM  supplier, revenue
+>WHERE s_suppkey = supplier_no
+>  AND total_revenue = (SELECT MAX(total_revenue)
+>                       FROM revenue)
+>ORDER BY s_suppkey;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

21  ROOT              20  ?               3.333E+005   FUNKY_OPT_UNIQUE  0.000E+000   1.795E+003 
20  ESP_EXCHANGE      19  ?               3.333E+005   FUNKY_OPT_UNIQUE  2.786E-009   1.795E+003 
19  SORT              18  ?               3.333E+005   FUNKY_OPT_UNIQUE  1.779E-002   1.795E+003 
18  HYBRID_HASH_JOIN  17  15              3.333E+005   FUNKY_OPT_UNIQUE  8.605E-003   1.795E+003 
17  PARTITION_ACCESS  16  ?               1.000E+006   FUNKY_OPT_UNIQUE  0.000E+000   2.093E+000 
16  FILE_SCAN         ?   ?   SUPPLIER    1.000E+006   FUNKY_OPT_UNIQUE  2.093E+000   2.093E+000 
15  HYBRID_HASH_JOIN  14  9               3.333E+005   FUNKY_OPT_UNIQUE  3.633E-003   1.793E+003 
14  HASH_PARTIAL_GRO  13  ?               1.000E+006   FUNKY_OPT_UNIQUE  4.332E-002   8.968E+002 
13  ESP_EXCHANGE      12  ?               1.489E+007   FUNKY_OPT_UNIQUE  5.808E-002   8.968E+002 
12  HASH_PARTIAL_GRO  11  ?               1.489E+007   FUNKY_OPT_UNIQUE  2.957E-002   8.967E+002 
11  PARTITION_ACCESS  10  ?               2.291E+007   FUNKY_OPT_UNIQUE  0.000E+000   8.967E+002 
10  FILE_SCAN         ?   ?   LINEITEM    2.291E+007   FUNKY_OPT_UNIQUE  8.967E+002   8.967E+002 
09  ESP_EXCHANGE      8   ?               1.000E+000   FUNKY_OPT_UNIQUE  2.846E-004   8.968E+002 
08  SORT_PARTIAL_AGG  7   ?               1.000E+000   FUNKY_OPT_UNIQUE  3.723E-008   8.968E+002 
07  ESP_EXCHANGE      6   ?               1.000E+000   FUNKY_OPT_UNIQUE  8.894E-006   8.968E+002 
06  SORT_PARTIAL_AGG  5   ?               1.000E+000   FUNKY_OPT_UNIQUE  4.875E-004   8.968E+002 
05  HASH_PARTIAL_GRO  4   ?               1.000E+006   FUNKY_OPT_UNIQUE  4.304E-002   8.968E+002 
04  ESP_EXCHANGE      3   ?               1.489E+007   FUNKY_OPT_UNIQUE  5.808E-002   8.968E+002 
03  HASH_PARTIAL_GRO  2   ?               1.489E+007   FUNKY_OPT_UNIQUE  2.957E-002   8.967E+002 
02  PARTITION_ACCESS  1   ?               2.291E+007   FUNKY_OPT_UNIQUE  0.000E+000   8.967E+002 
01  FILE_SCAN         ?   ?   LINEITEM    2.291E+007   FUNKY_OPT_UNIQUE  8.967E+002   8.967E+002 

--- 21 row(s) selected.
>>
>>drop view revenue;

--- SQL operation complete.
>>
>>--prepare XX from
>>--SELECT s_suppkey,s_name,s_address,s_phone, total_revenue
>>--FROM supplier, (SELECT l_suppkey, SUM(l_extendedprice * (1-l_discount))
>>--                FROM lineitem
>>--                WHERE l_shipdate >=  DATE '1996-01-01'
>>--                      AND l_shipdate <  DATE '1996-01-01' + INTERVAL '3' MONTH
>>--                GROUP BY l_suppkey) revenue(supplier_no, total_revenue)
>>--WHERE s_suppkey = supplier_no
>>--      AND total_revenue = (SELECT MAX(total_revenue)
>>--                           FROM (SELECT l_suppkey,
>>--                                        sum(l_extendedprice * (1-l_discount))
>>--                                 FROM lineitem
>>--                                 WHERE l_shipdate >=  DATE '1996-01-01'
>>--                                 AND l_shipdate <  DATE '1996-01-01' + INTERVAL '3' MONTH
>>--                                 GROUP BY l_suppkey)
>>--                           revenue(supplier_no, total_revenue))
>>--ORDER BY s_suppkey;
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

20   .    21   root                                                  3.33E+005
19   .    20   esp_exchange                    1:8(hash2) (m)        3.33E+005
18   .    19   sort                                                  3.33E+005
17   15   18   hybrid_hash_join      u                               3.33E+005
16   .    17   partition_access                                      1.00E+006
.    .    16   file_scan             fs fr     SUPPLIER              1.00E+006
14   9    15   hybrid_hash_join      u                               3.33E+005
13   .    14   hash_partial_groupby                                  1.00E+006
12   .    13   esp_exchange                    8(hash2):8(hash2)     1.48E+007
11   .    12   hash_partial_groupby                                  1.48E+007
10   .    11   partition_access                                      2.29E+007
.    .    10   file_scan             fs fr     LINEITEM              2.29E+007
8    .    9    esp_exchange                    8(rep-b):1            1.00E+000
7    .    8    sort_partial_aggr_ro                                  1.00E+000
6    .    7    esp_exchange                    1:8(hash2)            1.00E+000
5    .    6    sort_partial_aggr_le                                  1.00E+000
4    .    5    hash_partial_groupby                                  1.00E+006
3    .    4    esp_exchange                    8(hash2):8(hash2)     1.48E+007
2    .    3    hash_partial_groupby                                  1.48E+007
1    .    2    partition_access                                      2.29E+007
.    .    1    file_scan             fs fr     LINEITEM              2.29E+007

--- SQL operation complete.
>>obey optdml03(q16);
>>--------------------
>>--  TPCH Query 16 --
>>--------------------
>>prepare XX from
+>SELECT p_brand, p_type, p_size, COUNT(DISTINCT ps_suppkey) AS supplier_cnt
+>FROM partsupp, part
+>WHERE p_partkey = ps_partkey
+>      AND p_brand <> 'Brand#45'
+>      AND p_type NOT LIKE 'MEDIUM POLISHED%'
+>      AND p_size IN (49, 14, 23, 45, 19, 3, 36, 9)
+>      AND ps_suppkey NOT IN (SELECT s_suppkey
+>                             FROM supplier
+>                             WHERE s_comment LIKE
+>                                  '%Better Business Bureau%Complaints%')
+>GROUP BY p_brand, p_type, p_size
+>ORDER BY supplier_cnt DESC, p_brand, p_type, p_size;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

18  ROOT              17  ?               2.840E+004   FUNKY_OPT_UNIQUE  0.000E+000   1.879E+002 
17  ESP_EXCHANGE      16  ?               2.840E+004   FUNKY_OPT_UNIQUE  2.786E-009   1.879E+002 
16  SORT              15  ?               2.840E+004   FUNKY_OPT_UNIQUE  8.356E-004   1.879E+002 
15  HASH_PARTIAL_GRO  14  ?               2.840E+004   FUNKY_OPT_UNIQUE  2.423E-004   1.879E+002 
14  ESP_EXCHANGE      13  ?               2.840E+004   FUNKY_OPT_UNIQUE  2.901E-004   1.879E+002 
13  HASH_PARTIAL_GRO  12  ?               2.840E+004   FUNKY_OPT_UNIQUE  1.174E-002   1.879E+002 
12  HASH_PARTIAL_GRO  11  ?               1.125E+007   FUNKY_OPT_UNIQUE  9.203E-002   1.879E+002 
11  ESP_EXCHANGE      10  ?               1.125E+007   FUNKY_OPT_UNIQUE  6.585E-002   1.878E+002 
10  HASH_PARTIAL_GRO  9   ?               1.125E+007   FUNKY_OPT_UNIQUE  2.300E-002   1.877E+002 
09  HYBRID_HASH_ANTI  8   3               1.125E+007   FUNKY_OPT_UNIQUE  9.571E-002   1.877E+002 
08  NESTED_JOIN       5   7               1.200E+007   FUNKY_OPT_UNIQUE  7.362E-002   1.855E+002 
07  PARTITION_ACCESS  6   ?               4.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   1.485E+002 
06  INDEX_SCAN        ?   ?   PARTSUPP    4.000E+000   FUNKY_OPT_UNIQUE  1.485E+002   1.485E+002 
05  PARTITION_ACCESS  4   ?               3.001E+006   FUNKY_OPT_UNIQUE  0.000E+000   3.696E+001 
04  FILE_SCAN         ?   ?   PART        3.001E+006   FUNKY_OPT_UNIQUE  3.696E+001   3.696E+001 
03  ESP_EXCHANGE      2   ?               6.250E+004   FUNKY_OPT_UNIQUE  3.616E-003   2.091E+000 
02  PARTITION_ACCESS  1   ?               6.250E+004   FUNKY_OPT_UNIQUE  0.000E+000   2.087E+000 
01  FILE_SCAN         ?   ?   SUPPLIER    6.250E+004   FUNKY_OPT_UNIQUE  2.087E+000   2.087E+000 

--- 18 row(s) selected.
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

17   .    18   root                                                  2.83E+004
16   .    17   esp_exchange                    1:8(hash2) (m)        2.83E+004
15   .    16   sort                                                  2.83E+004
14   .    15   hash_partial_groupby                                  2.83E+004
13   .    14   esp_exchange                    8(hash2):8(hash2)     2.83E+004
12   .    13   hash_partial_groupby                                  2.83E+004
11   .    12   hash_partial_groupby                                  1.12E+007
10   .    11   esp_exchange                    8(hash2):8(hash2)     1.12E+007
9    .    10   hash_partial_groupby                                  1.12E+007
8    3    9    hybrid_hash_anti_sem                                  1.12E+007
5    7    8    nested_join                                           1.20E+007
6    .    7    partition_access                                      4.00E+000
.    .    6    index_scan            fs fr     PSIDX1                4.00E+000
4    .    5    partition_access                                      3.00E+006
.    .    4    file_scan             fs fr     PART                  3.00E+006
2    .    3    esp_exchange                    8(rep-b):8(hash2)     6.25E+004
1    .    2    partition_access                                      6.25E+004
.    .    1    file_scan             fs fr     SUPPLIER              6.25E+004

--- SQL operation complete.
>>obey optdml03(q17);
>>--------------------
>>--  TPCH Query 17 --
>>--------------------
>>prepare XX from
+>SELECT CAST((SUM(l_extendedprice)/7.0) AS NUMERIC(18,2)) AS avg_yearly
+>FROM lineitem, part
+>WHERE p_partkey = l_partkey
+>      AND p_brand = 'Brand#23'
+>      AND p_container = 'MED BOX'
+>      AND l_quantity < (SELECT 0.2*avg(l_quantity)
+>                        FROM lineitem 
+>                        WHERE l_partkey = p_partkey);

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

15  ROOT              14  ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   1.836E+003 
14  SORT_PARTIAL_AGG  13  ?               1.000E+000   FUNKY_OPT_UNIQUE  2.775E-008   1.836E+003 
13  ESP_EXCHANGE      12  ?               1.000E+000   FUNKY_OPT_UNIQUE  6.629E-006   1.836E+003 
12  SORT_PARTIAL_AGG  11  ?               1.000E+000   FUNKY_OPT_UNIQUE  2.068E-003   1.836E+003 
11  HASH_GROUPBY      10  ?               6.000E+006   FUNKY_OPT_UNIQUE  7.241E-002   1.836E+003 
10  HYBRID_HASH_JOIN  9   7               1.800E+007   FUNKY_OPT_UNIQUE  1.705E+000   1.836E+003 
09  PARTITION_ACCESS  8   ?               5.994E+008   FUNKY_OPT_UNIQUE  0.000E+000   8.983E+002 
08  FILE_SCAN         ?   ?   LINEITEM    5.994E+008   FUNKY_OPT_UNIQUE  8.983E+002   8.983E+002 
07  ESP_EXCHANGE      6   ?               6.007E+005   FUNKY_OPT_UNIQUE  5.820E-002   9.362E+002 
06  HYBRID_HASH_JOIN  5   3               6.007E+005   FUNKY_OPT_UNIQUE  1.266E+000   9.361E+002 
05  PARTITION_ACCESS  4   ?               5.994E+008   FUNKY_OPT_UNIQUE  0.000E+000   8.979E+002 
04  FILE_SCAN         ?   ?   LINEITEM    5.994E+008   FUNKY_OPT_UNIQUE  8.979E+002   8.979E+002 
03  ESP_EXCHANGE      2   ?               2.004E+004   FUNKY_OPT_UNIQUE  1.250E-003   3.695E+001 
02  PARTITION_ACCESS  1   ?               2.004E+004   FUNKY_OPT_UNIQUE  0.000E+000   3.694E+001 
01  FILE_SCAN         ?   ?   PART        2.004E+004   FUNKY_OPT_UNIQUE  3.694E+001   3.694E+001 

--- 15 row(s) selected.
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

14   .    15   root                                                  1.00E+000
13   .    14   sort_partial_aggr_ro                                  1.00E+000
12   .    13   esp_exchange                    1:8(hash2)            1.00E+000
11   .    12   sort_partial_aggr_le                                  1.00E+000
10   .    11   hash_groupby                                          6.00E+006
9    7    10   hybrid_hash_join                                      1.80E+007
8    .    9    partition_access                                      5.99E+008
.    .    8    file_scan             fs fr     LINEITEM              5.99E+008
6    .    7    esp_exchange                    8(rep-b):8(hash2)     6.00E+005
5    3    6    hybrid_hash_join      u                               6.00E+005
4    .    5    partition_access                                      5.99E+008
.    .    4    file_scan             fs fr     LINEITEM              5.99E+008
2    .    3    esp_exchange                    8(rep-b):8(hash2)     2.00E+004
1    .    2    partition_access                                      2.00E+004
.    .    1    file_scan             fs fr     PART                  2.00E+004

--- SQL operation complete.
>>obey optdml03(q18);
>>--------------------
>>--  TPCH Query 18 --
>>--------------------
>>prepare XX from
+>SELECT [FIRST 100] c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice,
+>                   SUM(l_quantity)
+>FROM customer, orders, lineitem
+>WHERE o_orderkey IN (SELECT l_orderkey
+>                     FROM lineitem
+>                     GROUP BY l_orderkey HAVING SUM(l_quantity) >  300)
+>      AND c_custkey = o_custkey
+>      AND o_orderkey = l_orderkey
+>GROUP BY c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice
+>ORDER BY o_totalprice DESC, o_orderdate;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

18  ROOT              17  ?               4.994E+007   FUNKY_OPT_UNIQUE  0.000E+000   2.055E+003 
17  FIRSTN            16  ?               4.994E+007   FUNKY_OPT_UNIQUE  0.000E+000   2.055E+003 
16  ESP_EXCHANGE      15  ?               4.994E+007   FUNKY_OPT_UNIQUE  2.786E-009   2.055E+003 
15  SORT              14  ?               4.994E+007   FUNKY_OPT_UNIQUE  5.353E+000   2.055E+003 
14  HYBRID_HASH_JOIN  13  2               4.994E+007   FUNKY_OPT_UNIQUE  4.374E-001   2.050E+003 
13  ESP_EXCHANGE      12  ?               4.994E+007   FUNKY_OPT_UNIQUE  9.207E-001   2.013E+003 
12  HYBRID_HASH_JOIN  11  9               4.994E+007   FUNKY_OPT_UNIQUE  6.753E-001   2.012E+003 
11  PARTITION_ACCESS  10  ?               1.500E+008   FUNKY_OPT_UNIQUE  0.000E+000   2.129E+002 
10  FILE_SCAN         ?   ?   ORDERS      1.500E+008   FUNKY_OPT_UNIQUE  2.129E+002   2.129E+002 
09  HYBRID_HASH_JOIN  8   5               4.994E+007   FUNKY_OPT_UNIQUE  4.826E-001   1.798E+003 
08  PARTITION_ACCESS  7   ?               1.498E+008   FUNKY_OPT_UNIQUE  0.000E+000   8.992E+002 
07  SORT_GROUPBY      6   ?               1.498E+008   FUNKY_OPT_UNIQUE  1.328E+000   8.992E+002 
06  FILE_SCAN         ?   ?   LINEITEM    5.994E+008   FUNKY_OPT_UNIQUE  8.979E+002   8.979E+002 
05  PARTITION_ACCESS  4   ?               4.994E+007   FUNKY_OPT_UNIQUE  0.000E+000   8.990E+002 
04  SORT_GROUPBY      3   ?               4.994E+007   FUNKY_OPT_UNIQUE  1.073E+000   8.990E+002 
03  FILE_SCAN         ?   ?   LINEITEM    5.994E+008   FUNKY_OPT_UNIQUE  8.979E+002   8.979E+002 
02  PARTITION_ACCESS  1   ?               1.500E+007   FUNKY_OPT_UNIQUE  0.000E+000   3.655E+001 
01  FILE_SCAN         ?   ?   CUSTOMER    1.500E+007   FUNKY_OPT_UNIQUE  3.655E+001   3.655E+001 

--- 18 row(s) selected.
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

17   .    18   root                                                  4.99E+007
16   .    17   firstn                                                4.99E+007
15   .    16   esp_exchange                    1:8(hash2) (m)        4.99E+007
14   .    15   sort                                                  4.99E+007
13   2    14   hybrid_hash_join                                      4.99E+007
12   .    13   esp_exchange                    8(hash2):8(hash2)     4.99E+007
11   9    12   hybrid_hash_join                                      4.99E+007
10   .    11   partition_access                                      1.50E+008
.    .    10   file_scan             fs fr     ORDERS                1.50E+008
8    5    9    hybrid_hash_join                                      4.99E+007
7    .    8    partition_access                                      1.49E+008
6    .    7    sort_groupby                                          1.49E+008
.    .    6    file_scan             fs        LINEITEM              5.99E+008
4    .    5    partition_access                                      4.99E+007
3    .    4    sort_groupby                                          4.99E+007
.    .    3    file_scan             fs        LINEITEM              5.99E+008
1    .    2    partition_access                                      1.50E+007
.    .    1    file_scan             fs fr     CUSTOMER              1.50E+007

--- SQL operation complete.
>>obey optdml03(q19);
>>--------------------
>>--  TPCH Query 19 --
>>--------------------
>>prepare XX from
+>SELECT CAST(SUM(l_extendedprice*(1-l_discount)) AS NUMERIC(18,2)) AS revenue
+>FROM lineitem, part
+>WHERE 
+>   (    p_partkey = l_partkey
+>    AND p_brand = 'Brand#24'
+>    AND p_container IN ( 'SM CASE', 'SM BOX', 'SM PACK', 'SM PKG' )
+>    AND l_quantity >= 1 AND l_quantity <= 1 + 10
+>    AND p_size BETWEEN 1 AND 5
+>    AND l_shipmode IN ( 'AIR', 'AIR REG' )
+>    AND l_shipinstruct = 'DELIVER IN PERSON' 
+>   )
+> OR
+>   (    p_partkey = l_partkey
+>    AND p_brand = 'Brand#16'
+>    AND p_container IN ( 'MED CASE', 'MED BOX', 'MED PACK', 'MED PKG' )
+>    AND l_quantity >= 10 AND l_quantity <= 10 + 10
+>    AND p_size BETWEEN 1 AND 10
+>    AND l_shipmode IN ( 'AIR', 'AIR REG' )
+>    AND l_shipinstruct = 'DELIVER IN PERSON' 
+>   )
+> OR
+>   (    p_partkey = l_partkey
+>    AND p_brand = 'Brand#42'
+>    AND p_container IN ( 'LG CASE', 'LG BOX', 'LG PACK', 'LG PKG' )
+>    AND l_quantity >= 20 AND l_quantity <= 20 + 10
+>    AND p_size BETWEEN 1 AND 15
+>    AND l_shipmode IN ( 'AIR', 'AIR REG' )
+>    AND l_shipinstruct = 'DELIVER IN PERSON' 
+>   );

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

10  ROOT              9   ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   9.342E+002 
09  SORT_PARTIAL_AGG  8   ?               1.000E+000   FUNKY_OPT_UNIQUE  3.723E-008   9.342E+002 
08  ESP_EXCHANGE      7   ?               1.000E+000   FUNKY_OPT_UNIQUE  8.894E-006   9.342E+002 
07  SORT_PARTIAL_AGG  6   ?               1.000E+000   FUNKY_OPT_UNIQUE  2.415E-006   9.342E+002 
06  HYBRID_HASH_JOIN  5   3               5.708E+003   FUNKY_OPT_UNIQUE  1.734E-001   9.342E+002 
05  PARTITION_ACCESS  4   ?               2.000E+007   FUNKY_OPT_UNIQUE  0.000E+000   3.701E+001 
04  FILE_SCAN         ?   ?   PART        2.000E+007   FUNKY_OPT_UNIQUE  3.701E+001   3.701E+001 
03  ESP_EXCHANGE      2   ?               2.140E+007   FUNKY_OPT_UNIQUE  3.655E-001   8.971E+002 
02  PARTITION_ACCESS  1   ?               2.140E+007   FUNKY_OPT_UNIQUE  0.000E+000   8.967E+002 
01  FILE_SCAN         ?   ?   LINEITEM    2.140E+007   FUNKY_OPT_UNIQUE  8.967E+002   8.967E+002 

--- 10 row(s) selected.
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

9    .    10   root                                                  1.00E+000
8    .    9    sort_partial_aggr_ro                                  1.00E+000
7    .    8    esp_exchange                    1:8(hash2)            1.00E+000
6    .    7    sort_partial_aggr_le                                  1.00E+000
5    3    6    hybrid_hash_join                                      5.70E+003
4    .    5    partition_access                                      2.00E+007
.    .    4    file_scan             fs fr     PART                  2.00E+007
2    .    3    esp_exchange                    8(hash2):8(hash2)     2.14E+007
1    .    2    partition_access                                      2.14E+007
.    .    1    file_scan             fs fr     LINEITEM              2.14E+007

--- SQL operation complete.
>>obey optdml03(q20);
>>--------------------
>>--  TPCH Query 20 --
>>--------------------
>>prepare XX from
+>SELECT s_name, s_address
+>FROM supplier, nation
+>WHERE s_suppkey IN (SELECT ps_suppkey
+>                    FROM partsupp
+>                    WHERE ps_partkey IN (SELECT p_partkey
+>                                         FROM part
+>                                         WHERE p_name LIKE 'forest%')
+>                      AND ps_availqty > (SELECT 0.5 * sum(l_quantity)
+>                                         FROM lineitem
+>                                         WHERE l_partkey = ps_partkey
+>                                           AND l_suppkey = ps_suppkey
+>                                           AND l_shipdate >= DATE '1994-01-01'
+>                                           AND l_shipdate <  DATE '1994-01-01'
+>                                                              + INTERVAL '1' YEAR)
+>                     )
+>  AND s_nationkey = n_nationkey
+>  AND n_name = 'CANADA'
+>ORDER by s_name;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

22  ROOT              21  ?               4.028E+004   FUNKY_OPT_UNIQUE  0.000E+000   1.119E+003 
21  ESP_EXCHANGE      20  ?               4.028E+004   FUNKY_OPT_UNIQUE  2.786E-009   1.119E+003 
20  SORT              19  ?               4.028E+004   FUNKY_OPT_UNIQUE  1.436E-003   1.119E+003 
19  HYBRID_HASH_SEMI  18  12              4.028E+004   FUNKY_OPT_UNIQUE  2.724E-003   1.119E+003 
18  NESTED_JOIN       15  17              4.028E+004   FUNKY_OPT_UNIQUE  2.069E-004   2.121E+000 
17  PARTITION_ACCESS  16  ?               4.028E+004   FUNKY_OPT_UNIQUE  0.000E+000   2.118E+000 
16  FILE_SCAN         ?   ?   SUPPLIER    4.028E+004   FUNKY_OPT_UNIQUE  2.118E+000   2.118E+000 
15  ESP_EXCHANGE      14  ?               1.000E+000   FUNKY_OPT_UNIQUE  1.341E-004   2.695E-003 
14  PARTITION_ACCESS  13  ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   2.561E-003 
13  FILE_SCAN         ?   ?   NATION      1.000E+000   FUNKY_OPT_UNIQUE  2.561E-003   2.561E-003 
12  ESP_EXCHANGE      11  ?               1.898E+006   FUNKY_OPT_UNIQUE  1.335E-002   1.116E+003 
11  HASH_GROUPBY      10  ?               1.898E+006   FUNKY_OPT_UNIQUE  1.784E-002   1.116E+003 
10  HYBRID_HASH_JOIN  9   7               5.696E+006   FUNKY_OPT_UNIQUE  1.981E-001   1.116E+003 
09  PARTITION_ACCESS  8   ?               8.000E+007   FUNKY_OPT_UNIQUE  0.000E+000   1.824E+002 
08  FILE_SCAN         ?   ?   PARTSUPP    8.000E+007   FUNKY_OPT_UNIQUE  1.824E+002   1.824E+002 
07  ESP_EXCHANGE      6   ?               5.696E+006   FUNKY_OPT_UNIQUE  7.962E-002   9.342E+002 
06  HYBRID_HASH_JOIN  5   3               5.696E+006   FUNKY_OPT_UNIQUE  2.482E-001   9.341E+002 
05  PARTITION_ACCESS  4   ?               9.114E+007   FUNKY_OPT_UNIQUE  0.000E+000   8.969E+002 
04  FILE_SCAN         ?   ?   LINEITEM    9.114E+007   FUNKY_OPT_UNIQUE  8.969E+002   8.969E+002 
03  ESP_EXCHANGE      2   ?               1.250E+006   FUNKY_OPT_UNIQUE  6.978E-002   3.702E+001 
02  PARTITION_ACCESS  1   ?               1.250E+006   FUNKY_OPT_UNIQUE  0.000E+000   3.695E+001 
01  FILE_SCAN         ?   ?   PART        1.250E+006   FUNKY_OPT_UNIQUE  3.695E+001   3.695E+001 

--- 22 row(s) selected.
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

21   .    22   root                                                  4.02E+004
20   .    21   esp_exchange                    1:8(hash2) (m)        4.02E+004
19   .    20   sort                                                  4.02E+004
18   12   19   hybrid_hash_semi_joi                                  4.02E+004
15   17   18   nested_join                                           4.02E+004
16   .    17   partition_access                                      4.02E+004
.    .    16   file_scan             fs fr     SUPPLIER              4.02E+004
14   .    15   esp_exchange                    8(rep-b):1 (m)        1.00E+000
13   .    14   partition_access                                      1.00E+000
.    .    13   file_scan             fs fr     NATION                1.00E+000
11   .    12   esp_exchange                    8(hash2):8(hash2)     1.89E+006
10   .    11   hash_groupby                                          1.89E+006
9    7    10   hybrid_hash_join                                      5.69E+006
8    .    9    partition_access                                      8.00E+007
.    .    8    file_scan             fs fr     PARTSUPP              8.00E+007
6    .    7    esp_exchange                    8(hash2):8(hash2)     5.69E+006
5    3    6    hybrid_hash_join                                      5.69E+006
4    .    5    partition_access                                      9.11E+007
.    .    4    file_scan             fs fr     LINEITEM              9.11E+007
2    .    3    esp_exchange                    8(rep-b):8(hash2)     1.25E+006
1    .    2    partition_access                                      1.25E+006
.    .    1    file_scan             fs fr     PART                  1.25E+006

--- SQL operation complete.
>>obey optdml03(q21);
>>--------------------
>>--  TPCH Query 21 --
>>--------------------
>>prepare XX from
+>SELECT [FIRST 100] s_name, count(*) as numwait
+>FROM supplier, lineitem l1, part, orders, nation
+>WHERE s_suppkey = l1.l_suppkey
+>  AND l1.l_partkey = p_partkey
+>  AND o_orderkey = l1.l_orderkey
+>  AND o_orderstatus = 'F'
+>  AND l1.l_receiptdate > l1.l_commitdate
+>  AND EXISTS (SELECT *
+>              FROM lineitem l2
+>              WHERE l2.l_orderkey = l1.l_orderkey
+>                AND l2.l_suppkey <> l1.l_suppkey)
+>  AND NOT EXISTS (SELECT *
+>                  FROM lineitem l3
+>                  WHERE l3.l_orderkey = l1.l_orderkey
+>                    AND l3.l_suppkey <> l1.l_suppkey
+>                    AND l3.l_receiptdate > l3.l_commitdate)
+>  AND s_nationkey = n_nationkey
+>  AND n_name = 'SAUDI ARABIA'
+>GROUP BY s_name
+>ORDER BY numwait DESC, s_name;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

31  ROOT              30  ?               1.000E+006   FUNKY_OPT_UNIQUE  0.000E+000   6.849E+003 
30  FIRSTN            29  ?               1.000E+006   FUNKY_OPT_UNIQUE  0.000E+000   6.849E+003 
29  ESP_EXCHANGE      28  ?               1.000E+006   FUNKY_OPT_UNIQUE  2.786E-009   6.849E+003 
28  SORT              27  ?               1.000E+006   FUNKY_OPT_UNIQUE  3.313E-002   6.849E+003 
27  HASH_PARTIAL_GRO  26  ?               1.000E+006   FUNKY_OPT_UNIQUE  7.811E-003   6.849E+003 
26  ESP_EXCHANGE      25  ?               1.231E+006   FUNKY_OPT_UNIQUE  6.253E-003   6.849E+003 
25  HASH_PARTIAL_GRO  24  ?               1.231E+006   FUNKY_OPT_UNIQUE  2.141E-003   6.849E+003 
24  HYBRID_HASH_JOIN  23  21              1.308E+006   FUNKY_OPT_UNIQUE  3.262E-002   6.849E+003 
23  PARTITION_ACCESS  22  ?               2.000E+007   FUNKY_OPT_UNIQUE  0.000E+000   2.411E+000 
22  INDEX_SCAN        ?   ?   PART        2.000E+007   FUNKY_OPT_UNIQUE  2.411E+000   2.411E+000 
21  ESP_EXCHANGE      20  ?               1.308E+006   FUNKY_OPT_UNIQUE  2.489E-002   6.847E+003 
20  NESTED_SEMI_JOIN  16  19              1.308E+006   FUNKY_OPT_UNIQUE  1.399E-002   6.847E+003 
19  PROBE_CACHE       18  ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   4.837E+003 
18  PARTITION_ACCESS  17  ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   4.837E+003 
17  FILE_SCAN         ?   ?   LINEITEM)   1.000E+000   FUNKY_OPT_UNIQUE  4.837E+003   4.837E+003 
16  HYBRID_HASH_ANTI  15  2               1.308E+006   FUNKY_OPT_UNIQUE  3.738E-001   2.009E+003 
15  HYBRID_HASH_JOIN  14  4               3.925E+006   FUNKY_OPT_UNIQUE  1.333E-001   1.112E+003 
14  HYBRID_HASH_JOIN  13  11              8.049E+006   FUNKY_OPT_UNIQUE  4.526E-001   8.996E+002 
13  PARTITION_ACCESS  12  ?               1.997E+008   FUNKY_OPT_UNIQUE  0.000E+000   8.971E+002 
12  FILE_SCAN         ?   ?   LINEITEM)   1.997E+008   FUNKY_OPT_UNIQUE  8.971E+002   8.971E+002 
11  ESP_EXCHANGE      10  ?               4.028E+004   FUNKY_OPT_UNIQUE  6.404E-003   2.127E+000 
10  NESTED_JOIN       7   9               4.028E+004   FUNKY_OPT_UNIQUE  1.322E-004   2.120E+000 
09  PARTITION_ACCESS  8   ?               4.028E+004   FUNKY_OPT_UNIQUE  0.000E+000   2.118E+000 
08  FILE_SCAN         ?   ?   SUPPLIER    4.028E+004   FUNKY_OPT_UNIQUE  2.118E+000   2.118E+000 
07  ESP_EXCHANGE      6   ?               1.000E+000   FUNKY_OPT_UNIQUE  1.341E-004   2.695E-003 
06  PARTITION_ACCESS  5   ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   2.561E-003 
05  FILE_SCAN         ?   ?   NATION      1.000E+000   FUNKY_OPT_UNIQUE  2.561E-003   2.561E-003 
04  PARTITION_ACCESS  3   ?               7.307E+007   FUNKY_OPT_UNIQUE  0.000E+000   2.126E+002 
03  FILE_SCAN         ?   ?   ORDERS      7.307E+007   FUNKY_OPT_UNIQUE  2.126E+002   2.126E+002 
02  PARTITION_ACCESS  1   ?               1.997E+008   FUNKY_OPT_UNIQUE  0.000E+000   8.970E+002 
01  FILE_SCAN         ?   ?   LINEITEM)   1.997E+008   FUNKY_OPT_UNIQUE  8.970E+002   8.970E+002 

--- 31 row(s) selected.
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

30   .    31   root                                                  1.00E+006
29   .    30   firstn                                                1.00E+006
28   .    29   esp_exchange                    1:8(hash2) (m)        1.00E+006
27   .    28   sort                                                  1.00E+006
26   .    27   hash_partial_groupby                                  1.00E+006
25   .    26   esp_exchange                    8(hash2):8(hash2)     1.23E+006
24   .    25   hash_partial_groupby                                  1.23E+006
23   21   24   hybrid_hash_join                                      1.30E+006
22   .    23   partition_access                                      2.00E+007
.    .    22   index_scan            fs fr     PAIDX1                2.00E+007
20   .    21   esp_exchange                    8(hash2):8(hash2)     1.30E+006
16   19   20   nested_semi_join                                      1.30E+006
18   .    19   probe_cache                                           1.00E+000
17   .    18   partition_access                                      1.00E+000
.    .    17   file_scan             fs fr     LINEITEM              1.00E+000
15   2    16   hybrid_hash_anti_sem                                  1.30E+006
14   4    15   hybrid_hash_join                                      3.92E+006
13   11   14   hybrid_hash_join      u                               8.04E+006
12   .    13   partition_access                                      1.99E+008
.    .    12   file_scan             fs fr     LINEITEM              1.99E+008
10   .    11   esp_exchange                    8(rep-b):8(hash2)     4.02E+004
7    9    10   nested_join                                           4.02E+004
8    .    9    partition_access                                      4.02E+004
.    .    8    file_scan             fs fr     SUPPLIER              4.02E+004
6    .    7    esp_exchange                    8(rep-b):1 (m)        1.00E+000
5    .    6    partition_access                                      1.00E+000
.    .    5    file_scan             fs fr     NATION                1.00E+000
3    .    4    partition_access                                      7.30E+007
.    .    3    file_scan             fs fr     ORDERS                7.30E+007
1    .    2    partition_access                                      1.99E+008
.    .    1    file_scan             fs fr     LINEITEM              1.99E+008

--- SQL operation complete.
>>obey optdml03(q22);
>>--------------------
>>--  TPCH Query 22 --
>>--------------------
>>prepare XX from
+>SELECT cntrycode, count(*) AS numcust, sum(c_acctbal) AS totacctbal
+>FROM (SELECT SUBSTRING(c_phone FROM 1 FOR 2) AS cntrycode, c_acctbal
+>      FROM customer
+>      WHERE SUBSTRING(c_phone FROM 1 FOR 2) IN ('13','17','18','23','29','30','31')
+>        AND c_acctbal > (SELECT AVG(c_acctbal)
+>                         FROM customer
+>                         WHERE c_acctbal > 0.00
+>                           AND SUBSTRING (c_phone FROM 1 FOR 2) IN
+>                                               ('13','17','18','23','29','30','31'))
+>        AND NOT EXISTS (SELECT *
+>                        FROM orders
+>                        WHERE o_custkey = c_custkey)
+>       ) AS custsale
+>GROUP BY cntrycode
+>ORDER BY cntrycode;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

19  ROOT              18  ?               1.000E+002   FUNKY_OPT_UNIQUE  0.000E+000   2.821E+002 
18  ESP_EXCHANGE      17  ?               1.300E+001   FUNKY_OPT_UNIQUE  3.912E-005   2.821E+002 
17  SORT              16  ?               1.300E+001   FUNKY_OPT_UNIQUE  5.588E-008   2.821E+002 
16  HASH_PARTIAL_GRO  15  ?               1.300E+001   FUNKY_OPT_UNIQUE  3.139E-007   2.821E+002 
15  ESP_EXCHANGE      14  ?               1.000E+002   FUNKY_OPT_UNIQUE  7.522E-005   2.821E+002 
14  HASH_PARTIAL_GRO  13  ?               1.000E+002   FUNKY_OPT_UNIQUE  8.731E-004   2.821E+002 
13  NESTED_ANTI_SEMI  9   12              1.653E+006   FUNKY_OPT_UNIQUE  2.767E-002   2.821E+002 
12  SPLIT_TOP         11  ?               3.332E-001   FUNKY_OPT_UNIQUE  5.757E-003   2.089E+002 
11  PARTITION_ACCESS  10  ?               3.332E-001   FUNKY_OPT_UNIQUE  5.757E-003   2.089E+002 
10  INDEX_SCAN        ?   ?   ORDERS      3.332E-001   FUNKY_OPT_UNIQUE  2.089E+002   2.089E+002 
09  NESTED_JOIN       6   8               4.960E+006   FUNKY_OPT_UNIQUE  1.209E-002   7.311E+001 
08  PARTITION_ACCESS  7   ?               4.960E+006   FUNKY_OPT_UNIQUE  0.000E+000   3.655E+001 
07  FILE_SCAN         ?   ?   CUSTOMER    4.960E+006   FUNKY_OPT_UNIQUE  3.655E+001   3.655E+001 
06  ESP_EXCHANGE      5   ?               1.000E+000   FUNKY_OPT_UNIQUE  2.846E-004   3.655E+001 
05  SORT_PARTIAL_AGG  4   ?               1.000E+000   FUNKY_OPT_UNIQUE  3.723E-008   3.655E+001 
04  SPLIT_TOP         3   ?               1.000E+000   FUNKY_OPT_UNIQUE  1.181E-007   3.655E+001 
03  PARTITION_ACCESS  2   ?               1.000E+000   FUNKY_OPT_UNIQUE  1.181E-007   3.655E+001 
02  SORT_PARTIAL_AGG  1   ?               1.000E+000   FUNKY_OPT_UNIQUE  1.865E-002   3.655E+001 
01  FILE_SCAN         ?   ?   CUSTOMER    1.352E+007   FUNKY_OPT_UNIQUE  3.653E+001   3.653E+001 

--- 19 row(s) selected.
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

18   .    19   root                                                  1.00E+002
17   .    18   esp_exchange                    1:8(hash2) (m)        1.29E+001
16   .    17   sort                                                  1.29E+001
15   .    16   hash_partial_groupby                                  1.29E+001
14   .    15   esp_exchange                    8(hash2):8(hash2)     1.00E+002
13   .    14   hash_partial_groupby                                  1.00E+002
9    12   13   nested_anti_semi_joi                                  1.65E+006
11   .    12   split_top                       8(rep-n):8(hash2)     3.33E-001
10   .    11   partition_access                                      3.33E-001
.    .    10   index_scan            fs fr     ORDIDX2               3.33E-001
6    8    9    nested_join                                           4.96E+006
7    .    8    partition_access                                      4.96E+006
.    .    7    file_scan             fs fr     CUSTOMER              4.96E+006
5    .    6    esp_exchange                    8(rep-b):1            1.00E+000
4    .    5    sort_partial_aggr_ro                                  1.00E+000
3    .    4    split_top                       1:8(hash2)            1.00E+000
2    .    3    partition_access                                      1.00E+000
1    .    2    sort_partial_aggr_le                                  1.00E+000
.    .    1    file_scan             fs        CUSTOMER              1.35E+007

--- SQL operation complete.
>>
>>-- now test old scan optimizer
>>control query default fso_to_use '0';

--- SQL operation complete.
>>control query default query_cache '0';

--- SQL operation complete.
>>
>>obey optdml03(q01);
>>--------------------
>>--  TPCH Query 01 --
>>--------------------
>>prepare XX from
+>SELECT l_returnflag, l_linestatus, SUM(l_quantity) AS sum_qty,
+>       CAST(SUM(l_extendedprice) AS NUMERIC(18,2)) AS sum_base_price,
+>       CAST(SUM(l_extendedprice * (1-l_discount)) AS NUMERIC(18,2)) AS sum_disc_price,
+>       CAST(SUM(l_extendedprice * (1-l_discount) * (1 + l_tax))
+>            AS NUMERIC(18,2)) AS sum_charge,
+>       AVG(l_quantity) AS avg_qty,
+>       AVG(l_extendedprice) AS avg_price,
+>       AVG(CAST(l_discount AS NUMERIC (10,3))) AS avg_disc,
+>       COUNT(*) AS count_order
+>FROM lineitem
+>WHERE l_shipdate <= DATE '1998-12-01' - INTERVAL '90' DAY
+>GROUP BY l_returnflag, l_linestatus
+>ORDER BY l_returnflag, l_linestatus;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

08  ROOT              7   ?               6.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   9.000E+002 
07  ESP_EXCHANGE      6   ?               6.000E+000   FUNKY_OPT_UNIQUE  7.333E-005   9.000E+002 
06  SORT_PARTIAL_GRO  5   ?               6.000E+000   FUNKY_OPT_UNIQUE  9.271E-008   9.000E+002 
05  SORT              4   ?               6.000E+000   FUNKY_OPT_UNIQUE  5.994E-008   9.000E+002 
04  ESP_EXCHANGE      3   ?               6.000E+000   FUNKY_OPT_UNIQUE  1.514E-004   9.000E+002 
03  HASH_PARTIAL_GRO  2   ?               6.000E+000   FUNKY_OPT_UNIQUE  6.686E-001   9.000E+002 
02  PARTITION_ACCESS  1   ?               5.864E+008   FUNKY_OPT_UNIQUE  0.000E+000   8.993E+002 
01  FILE_SCAN         ?   ?   LINEITEM    5.864E+008   FUNKY_OPT_UNIQUE  8.993E+002   8.993E+002 

--- 8 row(s) selected.
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

7    .    8    root                                                  6.00E+000
6    .    7    esp_exchange                    1:8(hash2) (m)        6.00E+000
5    .    6    sort_partial_groupby                                  6.00E+000
4    .    5    sort                                                  6.00E+000
3    .    4    esp_exchange                    8(hash2):8(hash2)     6.00E+000
2    .    3    hash_partial_groupby                                  6.00E+000
1    .    2    partition_access                                      5.86E+008
.    .    1    file_scan             fs fr     LINEITEM              5.86E+008

--- SQL operation complete.
>>obey optdml03(q02);
>>--------------------
>>--  TPCH Query 02 --
>>--------------------
>>prepare XX from
+>SELECT [FIRST 100] s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address,
+>       s_phone, s_comment
+>FROM part,supplier,partsupp, nation, region
+>WHERE p_partkey = ps_partkey
+>      AND s_suppkey = ps_suppkey
+>      AND p_size = 15
+>      AND p_type like  '%BRASS'
+>      AND s_nationkey = n_nationkey
+>      AND n_regionkey = r_regionkey
+>      AND r_name = 'EUROPE'
+>      AND ps_supplycost = (SELECT MIN(ps_supplycost)
+>                           FROM partsupp, supplier, nation, region
+>                           WHERE p_partkey = ps_partkey
+>                                 AND s_suppkey = ps_suppkey
+>                                 AND s_nationkey = n_nationkey
+>                                 AND n_regionkey = r_regionkey
+>                                 AND r_name = 'EUROPE')
+>ORDER BY s_acctbal desc, n_name, s_name, p_partkey;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

39  ROOT              38  ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   2.100E+002 
38  FIRSTN            37  ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   2.100E+002 
37  ESP_EXCHANGE      36  ?               1.000E+000   FUNKY_OPT_UNIQUE  1.317E-004   2.100E+002 
36  SORT              35  ?               1.000E+000   FUNKY_OPT_UNIQUE  7.662E-008   2.100E+002 
35  HASH_GROUPBY      34  ?               1.000E+000   FUNKY_OPT_UNIQUE  1.592E-004   2.100E+002 
34  HYBRID_HASH_JOIN  33  3               1.598E+004   FUNKY_OPT_UNIQUE  9.609E-004   2.100E+002 
33  HYBRID_HASH_JOIN  32  6               7.991E+004   FUNKY_OPT_UNIQUE  1.566E-003   2.100E+002 
32  HYBRID_HASH_JOIN  31  29              7.991E+004   FUNKY_OPT_UNIQUE  9.736E-003   2.100E+002 
31  PARTITION_ACCESS  30  ?               1.000E+006   FUNKY_OPT_UNIQUE  0.000E+000   2.096E+000 
30  FILE_SCAN         ?   ?   SUPPLIER    1.000E+006   FUNKY_OPT_UNIQUE  2.096E+000   2.096E+000 
29  ESP_EXCHANGE      28  ?               7.991E+004   FUNKY_OPT_UNIQUE  2.416E-003   2.079E+002 
28  NESTED_JOIN       25  27              7.991E+004   FUNKY_OPT_UNIQUE  4.890E-004   2.079E+002 
27  PARTITION_ACCESS  26  ?               4.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   7.594E+001 
26  FILE_SCAN         ?   ?   PARTSUPP    4.000E+000   FUNKY_OPT_UNIQUE  7.594E+001   7.594E+001 
25  ESP_EXCHANGE      24  ?               1.997E+004   FUNKY_OPT_UNIQUE  8.299E-004   1.320E+002 
24  HYBRID_HASH_JOIN  23  9               1.997E+004   FUNKY_OPT_UNIQUE  4.638E-004   1.320E+002 
23  HYBRID_HASH_JOIN  22  12              9.989E+004   FUNKY_OPT_UNIQUE  7.799E-004   1.320E+002 
22  HYBRID_HASH_JOIN  21  18              9.989E+004   FUNKY_OPT_UNIQUE  2.501E-003   1.319E+002 
21  ESP_EXCHANGE      20  ?               1.000E+006   FUNKY_OPT_UNIQUE  1.059E-002   1.321E-001 
20  PARTITION_ACCESS  19  ?               1.000E+006   FUNKY_OPT_UNIQUE  0.000E+000   1.215E-001 
19  INDEX_SCAN        ?   ?   SUPPLIER    1.000E+006   FUNKY_OPT_UNIQUE  1.215E-001   1.215E-001 
18  ESP_EXCHANGE      17  ?               9.989E+004   FUNKY_OPT_UNIQUE  2.655E-003   1.318E+002 
17  NESTED_JOIN       14  16              9.989E+004   FUNKY_OPT_UNIQUE  5.537E-004   1.318E+002 
16  PARTITION_ACCESS  15  ?               4.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   9.491E+001 
15  FILE_SCAN         ?   ?   PARTSUPP    4.000E+000   FUNKY_OPT_UNIQUE  9.491E+001   9.491E+001 
14  PARTITION_ACCESS  13  ?               2.497E+004   FUNKY_OPT_UNIQUE  0.000E+000   3.694E+001 
13  FILE_SCAN         ?   ?   PART        2.497E+004   FUNKY_OPT_UNIQUE  3.694E+001   3.694E+001 
12  ESP_EXCHANGE      11  ?               2.500E+001   FUNKY_OPT_UNIQUE  2.048E-004   2.766E-003 
11  PARTITION_ACCESS  10  ?               2.500E+001   FUNKY_OPT_UNIQUE  0.000E+000   2.562E-003 
10  FILE_SCAN         ?   ?   NATION      2.500E+001   FUNKY_OPT_UNIQUE  2.562E-003   2.562E-003 
09  ESP_EXCHANGE      8   ?               1.000E+000   FUNKY_OPT_UNIQUE  1.341E-004   2.694E-003 
08  PARTITION_ACCESS  7   ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   2.560E-003 
07  FILE_SCAN         ?   ?   REGION      1.000E+000   FUNKY_OPT_UNIQUE  2.560E-003   2.560E-003 
06  ESP_EXCHANGE      5   ?               2.500E+001   FUNKY_OPT_UNIQUE  4.161E-004   2.978E-003 
05  PARTITION_ACCESS  4   ?               2.500E+001   FUNKY_OPT_UNIQUE  0.000E+000   2.562E-003 
04  FILE_SCAN         ?   ?   NATION      2.500E+001   FUNKY_OPT_UNIQUE  2.562E-003   2.562E-003 
03  ESP_EXCHANGE      2   ?               1.000E+000   FUNKY_OPT_UNIQUE  1.341E-004   2.694E-003 
02  PARTITION_ACCESS  1   ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   2.560E-003 
01  FILE_SCAN         ?   ?   REGION      1.000E+000   FUNKY_OPT_UNIQUE  2.560E-003   2.560E-003 

--- 39 row(s) selected.
>>
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

38   .    39   root                                                  1.00E+000
37   .    38   firstn                                                1.00E+000
36   .    37   esp_exchange                    1:8(hash2) (m)        1.00E+000
35   .    36   sort                                                  1.00E+000
34   .    35   hash_groupby                                          1.00E+000
33   3    34   hybrid_hash_join      u                               1.59E+004
32   6    33   hybrid_hash_join      u                               7.99E+004
31   29   32   hybrid_hash_join                                      7.99E+004
30   .    31   partition_access                                      1.00E+006
.    .    30   file_scan             fs fr     SUPPLIER              1.00E+006
28   .    29   esp_exchange                    8(hash2):8(hash2)     7.99E+004
25   27   28   nested_join                                           7.99E+004
26   .    27   partition_access                                      4.00E+000
.    .    26   file_scan             fs fr     PARTSUPP              4.00E+000
24   .    25   esp_exchange                    8(hash2):8(hash2)     1.99E+004
23   9    24   hybrid_hash_join      u                               1.99E+004
22   12   23   hybrid_hash_join      u                               9.98E+004
21   18   22   hybrid_hash_join                                      9.98E+004
20   .    21   esp_exchange                    8(hash2):8(hash2)     1.00E+006
19   .    20   partition_access                                      1.00E+006
.    .    19   index_scan            fs fr     SUIDX2                1.00E+006
17   .    18   esp_exchange                    8(hash2):8(hash2)     9.98E+004
14   16   17   nested_join                                           9.98E+004
15   .    16   partition_access                                      4.00E+000
.    .    15   file_scan             fs fr     PARTSUPP              4.00E+000
13   .    14   partition_access                                      2.49E+004
.    .    13   file_scan             fs fr     PART                  2.49E+004
11   .    12   esp_exchange                    8(rep-b):1 (m)        2.50E+001
10   .    11   partition_access                                      2.50E+001
.    .    10   file_scan             fs fr     NATION                2.50E+001
8    .    9    esp_exchange                    8(rep-b):1 (m)        1.00E+000
7    .    8    partition_access                                      1.00E+000
.    .    7    file_scan             fs fr     REGION                1.00E+000
5    .    6    esp_exchange                    8(rep-b):1 (m)        2.50E+001
4    .    5    partition_access                                      2.50E+001
.    .    4    file_scan             fs fr     NATION                2.50E+001
2    .    3    esp_exchange                    8(rep-b):1 (m)        1.00E+000
1    .    2    partition_access                                      1.00E+000
.    .    1    file_scan             fs fr     REGION                1.00E+000

--- SQL operation complete.
>>obey optdml03(q03);
>>--------------------
>>--  TPCH Query 03 --
>>--------------------
>>prepare XX from
+>SELECT [FIRST 10] l_orderkey, 
+>       CAST(SUM(l_extendedprice*(1-l_discount))AS NUMERIC(18,2)) AS revenue,
+>       o_orderdate, o_shippriority
+>FROM customer,orders,lineitem
+>WHERE c_mktsegment = 'BUILDING'
+>      AND c_custkey = o_custkey
+>      AND l_orderkey = o_orderkey
+>      AND o_orderdate < DATE '1995-03-15'
+>      AND l_shipdate > DATE '1995-03-15'
+>GROUP BY l_orderkey, o_orderdate, o_shippriority
+>ORDER BY revenue DESC, o_orderdate;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

14  ROOT              13  ?               4.717E+007   FUNKY_OPT_UNIQUE  0.000E+000   1.151E+003 
13  FIRSTN            12  ?               4.717E+007   FUNKY_OPT_UNIQUE  0.000E+000   1.151E+003 
12  ESP_EXCHANGE      11  ?               4.717E+007   FUNKY_OPT_UNIQUE  2.786E-009   1.151E+003 
11  SORT              10  ?               4.717E+007   FUNKY_OPT_UNIQUE  3.601E+000   1.151E+003 
10  HASH_GROUPBY      9   ?               4.717E+007   FUNKY_OPT_UNIQUE  2.929E-001   1.148E+003 
09  HYBRID_HASH_JOIN  8   6               4.717E+007   FUNKY_OPT_UNIQUE  9.747E-001   1.148E+003 
08  PARTITION_ACCESS  7   ?               3.231E+008   FUNKY_OPT_UNIQUE  0.000E+000   8.974E+002 
07  FILE_SCAN         ?   ?   LINEITEM    3.231E+008   FUNKY_OPT_UNIQUE  8.974E+002   8.974E+002 
06  HYBRID_HASH_JOIN  5   3               2.187E+007   FUNKY_OPT_UNIQUE  2.531E-001   2.496E+002 
05  PARTITION_ACCESS  4   ?               7.291E+007   FUNKY_OPT_UNIQUE  0.000E+000   2.127E+002 
04  FILE_SCAN         ?   ?   ORDERS      7.291E+007   FUNKY_OPT_UNIQUE  2.127E+002   2.127E+002 
03  ESP_EXCHANGE      2   ?               3.000E+006   FUNKY_OPT_UNIQUE  1.673E-001   3.667E+001 
02  PARTITION_ACCESS  1   ?               3.000E+006   FUNKY_OPT_UNIQUE  0.000E+000   3.651E+001 
01  FILE_SCAN         ?   ?   CUSTOMER    3.000E+006   FUNKY_OPT_UNIQUE  3.651E+001   3.651E+001 

--- 14 row(s) selected.
>>
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

13   .    14   root                                                  4.71E+007
12   .    13   firstn                                                4.71E+007
11   .    12   esp_exchange                    1:8(hash2) (m)        4.71E+007
10   .    11   sort                                                  4.71E+007
9    .    10   hash_groupby                                          4.71E+007
8    6    9    hybrid_hash_join                                      4.71E+007
7    .    8    partition_access                                      3.23E+008
.    .    7    file_scan             fs fr     LINEITEM              3.23E+008
5    3    6    hybrid_hash_join      u                               2.18E+007
4    .    5    partition_access                                      7.29E+007
.    .    4    file_scan             fs fr     ORDERS                7.29E+007
2    .    3    esp_exchange                    8(rep-b):8(hash2)     3.00E+006
1    .    2    partition_access                                      3.00E+006
.    .    1    file_scan             fs fr     CUSTOMER              3.00E+006

--- SQL operation complete.
>>obey optdml03(q04);
>>--------------------
>>--  TPCH Query 04 --
>>--------------------
>>prepare XX from
+>SELECT o_orderpriority, COUNT(*) as order_count
+>FROM orders
+>WHERE o_orderdate >= DATE '1993-07-01'
+>      AND o_orderdate < DATE '1993-07-01' + INTERVAL '3' MONTH
+>      AND EXISTS (SELECT *
+>                  FROM lineitem
+>                  WHERE l_orderkey = o_orderkey
+>                        AND l_commitdate < l_receiptdate)
+>GROUP BY o_orderpriority
+>ORDER BY o_orderpriority;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

11  ROOT              10  ?               5.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   1.109E+003 
10  ESP_EXCHANGE      9   ?               5.000E+000   FUNKY_OPT_UNIQUE  4.075E-005   1.109E+003 
09  SORT_PARTIAL_GRO  8   ?               5.000E+000   FUNKY_OPT_UNIQUE  5.050E-008   1.109E+003 
08  SORT              7   ?               5.000E+000   FUNKY_OPT_UNIQUE  3.174E-008   1.109E+003 
07  ESP_EXCHANGE      6   ?               5.000E+000   FUNKY_OPT_UNIQUE  8.020E-005   1.109E+003 
06  HASH_PARTIAL_GRO  5   ?               5.000E+000   FUNKY_OPT_UNIQUE  3.421E-003   1.109E+003 
05  HYBRID_HASH_SEMI  4   2               5.798E+006   FUNKY_OPT_UNIQUE  2.728E-001   1.109E+003 
04  PARTITION_ACCESS  3   ?               5.798E+006   FUNKY_OPT_UNIQUE  0.000E+000   2.125E+002 
03  FILE_SCAN         ?   ?   ORDERS      5.798E+006   FUNKY_OPT_UNIQUE  2.125E+002   2.125E+002 
02  PARTITION_ACCESS  1   ?               1.997E+008   FUNKY_OPT_UNIQUE  0.000E+000   8.969E+002 
01  FILE_SCAN         ?   ?   LINEITEM    1.997E+008   FUNKY_OPT_UNIQUE  8.969E+002   8.969E+002 

--- 11 row(s) selected.
>>
>>
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

10   .    11   root                                                  5.00E+000
9    .    10   esp_exchange                    1:8(hash2) (m)        5.00E+000
8    .    9    sort_partial_groupby                                  5.00E+000
7    .    8    sort                                                  5.00E+000
6    .    7    esp_exchange                    8(hash2):8(hash2)     5.00E+000
5    .    6    hash_partial_groupby                                  5.00E+000
4    2    5    hybrid_hash_semi_joi                                  5.79E+006
3    .    4    partition_access                                      5.79E+006
.    .    3    file_scan             fs fr     ORDERS                5.79E+006
1    .    2    partition_access                                      1.99E+008
.    .    1    file_scan             fs fr     LINEITEM              1.99E+008

--- SQL operation complete.
>>obey optdml03(q05);
>>--------------------
>>--  TPCH Query 05 --
>>--------------------
>>prepare XX from
+>SELECT n_name, 
+>       CAST(SUM(l_extendedprice*(1-l_discount)) AS NUMERIC(18,2)) AS revenue
+>FROM customer,orders,lineitem,supplier,nation, region
+>WHERE c_custkey = o_custkey
+>      AND o_orderkey = l_orderkey
+>      AND l_suppkey = s_suppkey
+>      AND c_nationkey= s_nationkey
+>      AND s_nationkey = n_nationkey
+>      AND n_regionkey = r_regionkey
+>      AND r_name =  'ASIA'
+>      AND o_orderdate >=  DATE '1994-01-01'
+>      AND o_orderdate <  DATE '1994-01-01' + INTERVAL '1' YEAR
+>GROUP BY n_name
+>ORDER BY revenue desc;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

29  ROOT              28  ?               2.500E+001   FUNKY_OPT_UNIQUE  0.000E+000   1.113E+003 
28  ESP_EXCHANGE      27  ?               2.500E+001   FUNKY_OPT_UNIQUE  5.797E-005   1.113E+003 
27  SORT              26  ?               2.500E+001   FUNKY_OPT_UNIQUE  1.917E-007   1.113E+003 
26  HASH_PARTIAL_GRO  25  ?               2.500E+001   FUNKY_OPT_UNIQUE  2.060E-007   1.113E+003 
25  ESP_EXCHANGE      24  ?               2.500E+001   FUNKY_OPT_UNIQUE  1.071E-004   1.113E+003 
24  HASH_PARTIAL_GRO  23  ?               2.500E+001   FUNKY_OPT_UNIQUE  6.769E-004   1.113E+003 
23  HYBRID_HASH_JOIN  22  3               7.302E+005   FUNKY_OPT_UNIQUE  9.112E-002   1.113E+003 
22  HYBRID_HASH_JOIN  21  19              1.825E+007   FUNKY_OPT_UNIQUE  1.724E+000   1.113E+003 
21  PARTITION_ACCESS  20  ?               5.994E+008   FUNKY_OPT_UNIQUE  0.000E+000   8.983E+002 
20  FILE_SCAN         ?   ?   LINEITEM    5.994E+008   FUNKY_OPT_UNIQUE  8.983E+002   8.983E+002 
19  ESP_EXCHANGE      18  ?               4.563E+006   FUNKY_OPT_UNIQUE  9.168E-002   2.135E+002 
18  HYBRID_HASH_JOIN  17  14              4.563E+006   FUNKY_OPT_UNIQUE  6.576E-002   2.134E+002 
17  ESP_EXCHANGE      16  ?               2.281E+007   FUNKY_OPT_UNIQUE  2.249E-001   2.128E+002 
16  PARTITION_ACCESS  15  ?               2.281E+007   FUNKY_OPT_UNIQUE  0.000E+000   2.125E+002 
15  FILE_SCAN         ?   ?   ORDERS      2.281E+007   FUNKY_OPT_UNIQUE  2.125E+002   2.125E+002 
14  ESP_EXCHANGE      13  ?               3.000E+006   FUNKY_OPT_UNIQUE  6.376E-002   5.939E-001 
13  NESTED_JOIN       10  12              3.000E+006   FUNKY_OPT_UNIQUE  1.050E-002   5.302E-001 
12  PARTITION_ACCESS  11  ?               6.000E+005   FUNKY_OPT_UNIQUE  0.000E+000   5.142E-001 
11  INDEX_SCAN        ?   ?   CUSTOMER    6.000E+005   FUNKY_OPT_UNIQUE  5.142E-001   5.142E-001 
10  ESP_EXCHANGE      9   ?               5.000E+000   FUNKY_OPT_UNIQUE  3.660E-004   5.491E-003 
09  MERGE_JOIN        5   8               5.000E+000   FUNKY_OPT_UNIQUE  5.572E-007   5.125E-003 
08  SORT              7   ?               2.500E+001   FUNKY_OPT_UNIQUE  2.325E-006   2.564E-003 
07  PARTITION_ACCESS  6   ?               2.500E+001   FUNKY_OPT_UNIQUE  0.000E+000   2.562E-003 
06  FILE_SCAN         ?   ?   NATION      2.500E+001   FUNKY_OPT_UNIQUE  2.562E-003   2.562E-003 
05  PARTITION_ACCESS  4   ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   2.560E-003 
04  FILE_SCAN         ?   ?   REGION      1.000E+000   FUNKY_OPT_UNIQUE  2.560E-003   2.560E-003 
03  ESP_EXCHANGE      2   ?               1.000E+006   FUNKY_OPT_UNIQUE  8.343E-002   2.050E-001 
02  PARTITION_ACCESS  1   ?               1.000E+006   FUNKY_OPT_UNIQUE  0.000E+000   1.215E-001 
01  INDEX_SCAN        ?   ?   SUPPLIER    1.000E+006   FUNKY_OPT_UNIQUE  1.215E-001   1.215E-001 

--- 29 row(s) selected.
>>
>>
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

28   .    29   root                                                  2.50E+001
27   .    28   esp_exchange                    1:8(hash2) (m)        2.50E+001
26   .    27   sort                                                  2.50E+001
25   .    26   hash_partial_groupby                                  2.50E+001
24   .    25   esp_exchange                    8(hash2):8(hash2)     2.50E+001
23   .    24   hash_partial_groupby                                  2.50E+001
22   3    23   hybrid_hash_join      u                               7.30E+005
21   19   22   hybrid_hash_join                                      1.82E+007
20   .    21   partition_access                                      5.99E+008
.    .    20   file_scan             fs fr     LINEITEM              5.99E+008
18   .    19   esp_exchange                    8(hash2):8(hash2)     4.56E+006
17   14   18   hybrid_hash_join                                      4.56E+006
16   .    17   esp_exchange                    8(hash2):8(hash2)     2.28E+007
15   .    16   partition_access                                      2.28E+007
.    .    15   file_scan             fs fr     ORDERS                2.28E+007
13   .    14   esp_exchange                    8(hash2):8(hash2)     3.00E+006
10   12   13   nested_join                                           3.00E+006
11   .    12   partition_access                                      6.00E+005
.    .    11   index_scan            fs fr     CUIDX2                6.00E+005
9    .    10   esp_exchange                    8(rep-b):1            5.00E+000
5    8    9    merge_join                                            5.00E+000
7    .    8    sort                                                  2.50E+001
6    .    7    partition_access                                      2.50E+001
.    .    6    file_scan             fs fr     NATION                2.50E+001
4    .    5    partition_access                                      1.00E+000
.    .    4    file_scan             fs fr     REGION                1.00E+000
2    .    3    esp_exchange                    8(rep-b):8(hash2)     1.00E+006
1    .    2    partition_access                                      1.00E+006
.    .    1    index_scan            fs fr     SUIDX2                1.00E+006

--- SQL operation complete.
>>obey optdml03(q06);
>>--------------------
>>--  TPCH Query 06 --
>>--------------------
>>prepare XX from
+>SELECT CAST(SUM(l_extendedprice*l_discount) AS NUMERIC(18,2)) AS revenue
+>FROM lineitem
+>WHERE l_shipdate >= DATE '1994-01-01'
+>      AND l_shipdate < DATE '1994-01-01' + INTERVAL '1' YEAR
+>      AND l_discount BETWEEN .06 - 0.01 AND .06 + 0.01
+>      AND l_quantity < 24;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

06  ROOT              5   ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   8.967E+002 
05  SORT_PARTIAL_AGG  4   ?               1.000E+000   FUNKY_OPT_UNIQUE  3.723E-008   8.967E+002 
04  SPLIT_TOP         3   ?               1.000E+000   FUNKY_OPT_UNIQUE  1.181E-007   8.967E+002 
03  PARTITION_ACCESS  2   ?               1.000E+000   FUNKY_OPT_UNIQUE  1.181E-007   8.967E+002 
02  SORT_PARTIAL_AGG  1   ?               1.000E+000   FUNKY_OPT_UNIQUE  1.931E-002   8.967E+002 
01  FILE_SCAN         ?   ?   LINEITEM    1.143E+007   FUNKY_OPT_UNIQUE  8.967E+002   8.967E+002 

--- 6 row(s) selected.
>>
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

5    .    6    root                                                  1.00E+000
4    .    5    sort_partial_aggr_ro                                  1.00E+000
3    .    4    split_top                       1:8(hash2)            1.00E+000
2    .    3    partition_access                                      1.00E+000
1    .    2    sort_partial_aggr_le                                  1.00E+000
.    .    1    file_scan             fs        LINEITEM              1.14E+007

--- SQL operation complete.
>>obey optdml03(q07);
>>--------------------
>>--  TPCH Query 07 --
>>--------------------
>>prepare XX from
+>SELECT supp_nation, cust_nation, yr, sum(volume) as revenue
+>   FROM
+>    (SELECT n1.n_name as supp_nation, n2.n_name as cust_nation,
+>             extract(year from l_shipdate) as yr,
+>       CAST(l_extendedprice*(1-l_discount) AS NUMERIC(18,2)) as volume
+>     FROM supplier,lineitem,orders,customer, nation n1, nation n2
+>     WHERE s_suppkey = l_suppkey
+>      AND o_orderkey = l_orderkey
+>      AND c_custkey = o_custkey
+>      AND s_nationkey = n1.n_nationkey
+>      AND c_nationkey = n2.n_nationkey
+>      AND ((n1.n_name  = 'FRANCE' AND
+>            n2.n_name = 'GERMANY')
+>          OR (n1.n_name = 'GERMANY'  AND
+>            n2.n_name = 'FRANCE'))
+>      AND l_shipdate BETWEEN  DATE '1995-01-01' AND  DATE '1996-12-31') as shipping
+>
+>GROUP BY supp_nation, cust_nation, yr
+>ORDER BY supp_nation, cust_nation, yr;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

29  ROOT              28  ?               1.000E+002   FUNKY_OPT_UNIQUE  0.000E+000   1.108E+003 
28  ESP_EXCHANGE      27  ?               1.000E+002   FUNKY_OPT_UNIQUE  8.915E-005   1.108E+003 
27  SORT_PARTIAL_GRO  26  ?               1.000E+002   FUNKY_OPT_UNIQUE  8.846E-007   1.108E+003 
26  SORT              25  ?               1.000E+002   FUNKY_OPT_UNIQUE  1.389E-006   1.108E+003 
25  ESP_EXCHANGE      24  ?               1.000E+002   FUNKY_OPT_UNIQUE  1.344E-004   1.108E+003 
24  HASH_PARTIAL_GRO  23  ?               1.000E+002   FUNKY_OPT_UNIQUE  7.114E-004   1.108E+003 
23  HYBRID_HASH_JOIN  22  3               5.828E+005   FUNKY_OPT_UNIQUE  1.297E-001   1.108E+003 
22  HYBRID_HASH_JOIN  21  19              2.188E+007   FUNKY_OPT_UNIQUE  7.173E-001   1.107E+003 
21  PARTITION_ACCESS  20  ?               1.821E+008   FUNKY_OPT_UNIQUE  0.000E+000   8.971E+002 
20  FILE_SCAN         ?   ?   LINEITEM    1.821E+008   FUNKY_OPT_UNIQUE  8.971E+002   8.971E+002 
19  ESP_EXCHANGE      18  ?               1.800E+007   FUNKY_OPT_UNIQUE  4.779E-001   2.099E+002 
18  NESTED_JOIN       14  17              1.800E+007   FUNKY_OPT_UNIQUE  9.468E-002   2.094E+002 
17  SPLIT_TOP         16  ?               1.500E+001   FUNKY_OPT_UNIQUE  1.253E-001   2.090E+002 
16  PARTITION_ACCESS  15  ?               1.500E+001   FUNKY_OPT_UNIQUE  1.253E-001   2.090E+002 
15  INDEX_SCAN        ?   ?   ORDERS      1.500E+001   FUNKY_OPT_UNIQUE  2.088E+002   2.088E+002 
14  NESTED_JOIN       10  13              1.200E+006   FUNKY_OPT_UNIQUE  5.569E-003   3.662E-001 
13  SPLIT_TOP         12  ?               6.000E+005   FUNKY_OPT_UNIQUE  8.358E-003   3.548E-001 
12  PARTITION_ACCESS  11  ?               6.000E+005   FUNKY_OPT_UNIQUE  8.358E-003   3.548E-001 
11  INDEX_SCAN        ?   ?   CUSTOMER    6.000E+005   FUNKY_OPT_UNIQUE  3.464E-001   3.464E-001 
10  HYBRID_HASH_JOIN  9   6               2.000E+000   FUNKY_OPT_UNIQUE  3.615E-006   5.882E-003 
09  ESP_EXCHANGE      8   ?               2.500E+001   FUNKY_OPT_UNIQUE  3.638E-004   2.926E-003 
08  PARTITION_ACCESS  7   ?               2.500E+001   FUNKY_OPT_UNIQUE  0.000E+000   2.562E-003 
07  FILE_SCAN         ?   ?   NATION)     2.500E+001   FUNKY_OPT_UNIQUE  2.562E-003   2.562E-003 
06  ESP_EXCHANGE      5   ?               2.500E+001   FUNKY_OPT_UNIQUE  3.900E-004   2.952E-003 
05  PARTITION_ACCESS  4   ?               2.500E+001   FUNKY_OPT_UNIQUE  0.000E+000   2.562E-003 
04  FILE_SCAN         ?   ?   NATION)     2.500E+001   FUNKY_OPT_UNIQUE  2.562E-003   2.562E-003 
03  ESP_EXCHANGE      2   ?               1.000E+006   FUNKY_OPT_UNIQUE  8.343E-002   2.050E-001 
02  PARTITION_ACCESS  1   ?               1.000E+006   FUNKY_OPT_UNIQUE  0.000E+000   1.215E-001 
01  INDEX_SCAN        ?   ?   SUPPLIER    1.000E+006   FUNKY_OPT_UNIQUE  1.215E-001   1.215E-001 

--- 29 row(s) selected.
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

28   .    29   root                                                  1.00E+002
27   .    28   esp_exchange                    1:8(hash2) (m)        1.00E+002
26   .    27   sort_partial_groupby                                  1.00E+002
25   .    26   sort                                                  1.00E+002
24   .    25   esp_exchange                    8(hash2):8(hash2)     1.00E+002
23   .    24   hash_partial_groupby                                  1.00E+002
22   3    23   hybrid_hash_join      u                               5.82E+005
21   19   22   hybrid_hash_join                                      2.18E+007
20   .    21   partition_access                                      1.82E+008
.    .    20   file_scan             fs fr     LINEITEM              1.82E+008
18   .    19   esp_exchange                    8(hash2):8(hash2)     1.80E+007
14   17   18   nested_join                                           1.80E+007
16   .    17   split_top                       8(rep-n):8(hash2)     1.50E+001
15   .    16   partition_access                                      1.50E+001
.    .    15   index_scan            fs fr     ORDIDX2               1.50E+001
10   13   14   nested_join                                           1.20E+006
12   .    13   split_top                       8(rep-n):8(hash2)     6.00E+005
11   .    12   partition_access                                      6.00E+005
.    .    11   index_scan            fs fr     CUIDX2                6.00E+005
9    6    10   hybrid_hash_join                                      2.00E+000
8    .    9    esp_exchange                    8(hash2):1 (m)        2.50E+001
7    .    8    partition_access                                      2.50E+001
.    .    7    file_scan             fs fr     NATION                2.50E+001
5    .    6    esp_exchange                    8(rep-b):1 (m)        2.50E+001
4    .    5    partition_access                                      2.50E+001
.    .    4    file_scan             fs fr     NATION                2.50E+001
2    .    3    esp_exchange                    8(rep-b):8(hash2)     1.00E+006
1    .    2    partition_access                                      1.00E+006
.    .    1    index_scan            fs fr     SUIDX2                1.00E+006

--- SQL operation complete.
>>obey optdml03(q08);
>>--------------------
>>--  TPCH Query 08 --
>>--------------------
>>prepare XX from
+>SELECT yr, sum(CASE when nation = 'BRAZIL'
+>                  then volume
+>                   else 0 end)
+>              / sum(volume) as mkt_share
+>  FROM
+>    (SELECT extract(year from o_orderdate) as yr,
+>       CAST(l_extendedprice*(1-l_discount) AS NUMERIC(16,2)) as volume,
+>          n2.n_name as nation
+>     FROM part,supplier,lineitem,orders,customer, nation n1, nation  n2,region
+>     WHERE p_partkey = l_partkey
+>      AND s_suppkey = l_suppkey
+>      AND l_orderkey = o_orderkey
+>      AND o_custkey = c_custkey
+>      AND c_nationkey = n1.n_nationkey
+>      AND n1.n_regionkey = r_regionkey
+>      AND r_name = 'AMERICA'
+>      AND s_nationkey = n2.n_nationkey
+>      AND o_orderdate BETWEEN  DATE '1995-01-01' AND  DATE '1996-12-31'
+>      AND p_type ='ECONOMY ANODIZED STEEL')  all_nations
+>GROUP BY yr
+>ORDER BY yr;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

37  ROOT              36  ?               2.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   1.152E+003 
36  ESP_EXCHANGE      35  ?               2.000E+000   FUNKY_OPT_UNIQUE  3.148E-005   1.152E+003 
35  SORT              34  ?               2.000E+000   FUNKY_OPT_UNIQUE  1.824E-008   1.152E+003 
34  HASH_PARTIAL_GRO  33  ?               2.000E+000   FUNKY_OPT_UNIQUE  4.212E-008   1.152E+003 
33  ESP_EXCHANGE      32  ?               2.000E+000   FUNKY_OPT_UNIQUE  8.193E-005   1.152E+003 
32  HASH_PARTIAL_GRO  31  ?               2.000E+000   FUNKY_OPT_UNIQUE  1.815E-004   1.152E+003 
31  HYBRID_HASH_JOIN  30  3               2.432E+005   FUNKY_OPT_UNIQUE  1.453E-003   1.152E+003 
30  HYBRID_HASH_JOIN  29  26              2.432E+005   FUNKY_OPT_UNIQUE  3.173E-003   1.152E+003 
29  ESP_EXCHANGE      28  ?               1.000E+006   FUNKY_OPT_UNIQUE  1.059E-002   1.321E-001 
28  PARTITION_ACCESS  27  ?               1.000E+006   FUNKY_OPT_UNIQUE  0.000E+000   1.215E-001 
27  INDEX_SCAN        ?   ?   SUPPLIER    1.000E+006   FUNKY_OPT_UNIQUE  1.215E-001   1.215E-001 
26  ESP_EXCHANGE      25  ?               2.432E+005   FUNKY_OPT_UNIQUE  4.477E-003   1.152E+003 
25  HYBRID_HASH_JOIN  24  6               2.432E+005   FUNKY_OPT_UNIQUE  4.647E-003   1.152E+003 
24  HYBRID_HASH_JOIN  23  9               1.216E+006   FUNKY_OPT_UNIQUE  7.843E-003   1.152E+003 
23  HYBRID_HASH_JOIN  22  19              1.216E+006   FUNKY_OPT_UNIQUE  3.366E-002   1.152E+003 
22  ESP_EXCHANGE      21  ?               1.500E+007   FUNKY_OPT_UNIQUE  1.562E-001   1.972E+000 
21  PARTITION_ACCESS  20  ?               1.500E+007   FUNKY_OPT_UNIQUE  0.000E+000   1.816E+000 
20  INDEX_SCAN        ?   ?   CUSTOMER    1.500E+007   FUNKY_OPT_UNIQUE  1.816E+000   1.816E+000 
19  ESP_EXCHANGE      18  ?               1.216E+006   FUNKY_OPT_UNIQUE  2.276E-002   1.150E+003 
18  HYBRID_HASH_JOIN  17  15              1.216E+006   FUNKY_OPT_UNIQUE  1.120E-001   1.150E+003 
17  PARTITION_ACCESS  16  ?               4.560E+007   FUNKY_OPT_UNIQUE  0.000E+000   2.126E+002 
16  FILE_SCAN         ?   ?   ORDERS      4.560E+007   FUNKY_OPT_UNIQUE  2.126E+002   2.126E+002 
15  HYBRID_HASH_JOIN  14  12              3.996E+006   FUNKY_OPT_UNIQUE  1.946E+000   9.375E+002 
14  PARTITION_ACCESS  13  ?               5.994E+008   FUNKY_OPT_UNIQUE  0.000E+000   8.986E+002 
13  FILE_SCAN         ?   ?   LINEITEM    5.994E+008   FUNKY_OPT_UNIQUE  8.986E+002   8.986E+002 
12  ESP_EXCHANGE      11  ?               1.333E+005   FUNKY_OPT_UNIQUE  7.563E-003   3.695E+001 
11  PARTITION_ACCESS  10  ?               1.333E+005   FUNKY_OPT_UNIQUE  0.000E+000   3.694E+001 
10  FILE_SCAN         ?   ?   PART        1.333E+005   FUNKY_OPT_UNIQUE  3.694E+001   3.694E+001 
09  ESP_EXCHANGE      8   ?               2.500E+001   FUNKY_OPT_UNIQUE  2.048E-004   2.766E-003 
08  PARTITION_ACCESS  7   ?               2.500E+001   FUNKY_OPT_UNIQUE  0.000E+000   2.562E-003 
07  FILE_SCAN         ?   ?   NATION)     2.500E+001   FUNKY_OPT_UNIQUE  2.562E-003   2.562E-003 
06  ESP_EXCHANGE      5   ?               1.000E+000   FUNKY_OPT_UNIQUE  1.341E-004   2.694E-003 
05  PARTITION_ACCESS  4   ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   2.560E-003 
04  FILE_SCAN         ?   ?   REGION      1.000E+000   FUNKY_OPT_UNIQUE  2.560E-003   2.560E-003 
03  ESP_EXCHANGE      2   ?               2.500E+001   FUNKY_OPT_UNIQUE  3.900E-004   2.952E-003 
02  PARTITION_ACCESS  1   ?               2.500E+001   FUNKY_OPT_UNIQUE  0.000E+000   2.562E-003 
01  FILE_SCAN         ?   ?   NATION)     2.500E+001   FUNKY_OPT_UNIQUE  2.562E-003   2.562E-003 

--- 37 row(s) selected.
>>
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

36   .    37   root                                                  2.00E+000
35   .    36   esp_exchange                    1:8(hash2) (m)        2.00E+000
34   .    35   sort                                                  2.00E+000
33   .    34   hash_partial_groupby                                  2.00E+000
32   .    33   esp_exchange                    8(hash2):8(hash2)     2.00E+000
31   .    32   hash_partial_groupby                                  2.00E+000
30   3    31   hybrid_hash_join      u                               2.43E+005
29   26   30   hybrid_hash_join                                      2.43E+005
28   .    29   esp_exchange                    8(hash2):8(hash2)     1.00E+006
27   .    28   partition_access                                      1.00E+006
.    .    27   index_scan            fs fr     SUIDX2                1.00E+006
25   .    26   esp_exchange                    8(hash2):8(hash2)     2.43E+005
24   6    25   hybrid_hash_join      u                               2.43E+005
23   9    24   hybrid_hash_join      u                               1.21E+006
22   19   23   hybrid_hash_join                                      1.21E+006
21   .    22   esp_exchange                    8(hash2):8(hash2)     1.50E+007
20   .    21   partition_access                                      1.50E+007
.    .    20   index_scan            fs fr     CUIDX2                1.50E+007
18   .    19   esp_exchange                    8(hash2):8(hash2)     1.21E+006
17   15   18   hybrid_hash_join                                      1.21E+006
16   .    17   partition_access                                      4.56E+007
.    .    16   file_scan             fs fr     ORDERS                4.56E+007
14   12   15   hybrid_hash_join      u                               3.99E+006
13   .    14   partition_access                                      5.99E+008
.    .    13   file_scan             fs fr     LINEITEM              5.99E+008
11   .    12   esp_exchange                    8(rep-b):8(hash2)     1.33E+005
10   .    11   partition_access                                      1.33E+005
.    .    10   file_scan             fs fr     PART                  1.33E+005
8    .    9    esp_exchange                    8(rep-b):1 (m)        2.50E+001
7    .    8    partition_access                                      2.50E+001
.    .    7    file_scan             fs fr     NATION                2.50E+001
5    .    6    esp_exchange                    8(rep-b):1 (m)        1.00E+000
4    .    5    partition_access                                      1.00E+000
.    .    4    file_scan             fs fr     REGION                1.00E+000
2    .    3    esp_exchange                    8(rep-b):1 (m)        2.50E+001
1    .    2    partition_access                                      2.50E+001
.    .    1    file_scan             fs fr     NATION                2.50E+001

--- SQL operation complete.
>>obey optdml03(q09);
>>--------------------
>>--  TPCH Query 09 --
>>--------------------
>>
>>prepare XX from
+>SELECT nation, yr, sum(amount) as sum_profit
+>  from  (SELECT n_name as nation, EXTRACT (YEAR from o_orderdate) as yr,
+>                l_extendedprice*(1-l_discount)-ps_supplycost*l_quantity as amount
+>FROM part,supplier,lineitem,partsupp,orders, nation
+>WHERE s_suppkey  = l_suppkey
+>      AND ps_suppkey = l_suppkey
+>      AND ps_partkey = l_partkey
+>      AND p_partkey  = l_partkey
+>      AND o_orderkey = l_orderkey
+>      AND p_name like '%green%'
+>      AND s_nationkey = n_nationkey) as profit
+>GROUP BY nation, yr
+>ORDER BY nation, yr DESC;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

28  ROOT              27  ?               1.750E+002   FUNKY_OPT_UNIQUE  0.000E+000   1.141E+003 
27  ESP_EXCHANGE      26  ?               1.750E+002   FUNKY_OPT_UNIQUE  8.877E-005   1.141E+003 
26  SORT_PARTIAL_GRO  25  ?               1.750E+002   FUNKY_OPT_UNIQUE  1.289E-006   1.141E+003 
25  SORT              24  ?               1.750E+002   FUNKY_OPT_UNIQUE  2.310E-006   1.141E+003 
24  ESP_EXCHANGE      23  ?               1.750E+002   FUNKY_OPT_UNIQUE  1.131E-004   1.141E+003 
23  HASH_PARTIAL_GRO  22  ?               1.750E+002   FUNKY_OPT_UNIQUE  3.655E-002   1.141E+003 
22  HYBRID_HASH_JOIN  21  3               3.746E+007   FUNKY_OPT_UNIQUE  2.483E-001   1.141E+003 
21  HYBRID_HASH_JOIN  20  17              3.746E+007   FUNKY_OPT_UNIQUE  4.624E-001   1.141E+003 
20  ESP_EXCHANGE      19  ?               1.500E+008   FUNKY_OPT_UNIQUE  1.478E+000   1.963E+001 
19  PARTITION_ACCESS  18  ?               1.500E+008   FUNKY_OPT_UNIQUE  0.000E+000   1.815E+001 
18  INDEX_SCAN        ?   ?   ORDERS      1.500E+008   FUNKY_OPT_UNIQUE  1.815E+001   1.815E+001 
17  HYBRID_HASH_JOIN  16  14              3.746E+007   FUNKY_OPT_UNIQUE  2.277E+000   1.121E+003 
16  PARTITION_ACCESS  15  ?               5.994E+008   FUNKY_OPT_UNIQUE  0.000E+000   8.987E+002 
15  FILE_SCAN         ?   ?   LINEITEM    5.994E+008   FUNKY_OPT_UNIQUE  8.987E+002   8.987E+002 
14  ESP_EXCHANGE      13  ?               5.000E+006   FUNKY_OPT_UNIQUE  6.232E-001   2.205E+002 
13  HYBRID_HASH_JOIN  12  6               5.000E+006   FUNKY_OPT_UNIQUE  2.752E-002   2.198E+002 
12  ESP_EXCHANGE      11  ?               5.000E+006   FUNKY_OPT_UNIQUE  6.991E-002   2.197E+002 
11  HYBRID_HASH_JOIN  10  8               5.000E+006   FUNKY_OPT_UNIQUE  2.085E-001   2.196E+002 
10  PARTITION_ACCESS  9   ?               8.000E+007   FUNKY_OPT_UNIQUE  0.000E+000   1.824E+002 
09  FILE_SCAN         ?   ?   PARTSUPP    8.000E+007   FUNKY_OPT_UNIQUE  1.824E+002   1.824E+002 
08  PARTITION_ACCESS  7   ?               1.250E+006   FUNKY_OPT_UNIQUE  0.000E+000   3.695E+001 
07  FILE_SCAN         ?   ?   PART        1.250E+006   FUNKY_OPT_UNIQUE  3.695E+001   3.695E+001 
06  ESP_EXCHANGE      5   ?               1.000E+006   FUNKY_OPT_UNIQUE  1.059E-002   1.321E-001 
05  PARTITION_ACCESS  4   ?               1.000E+006   FUNKY_OPT_UNIQUE  0.000E+000   1.215E-001 
04  INDEX_SCAN        ?   ?   SUPPLIER    1.000E+006   FUNKY_OPT_UNIQUE  1.215E-001   1.215E-001 
03  ESP_EXCHANGE      2   ?               2.500E+001   FUNKY_OPT_UNIQUE  3.900E-004   2.952E-003 
02  PARTITION_ACCESS  1   ?               2.500E+001   FUNKY_OPT_UNIQUE  0.000E+000   2.562E-003 
01  FILE_SCAN         ?   ?   NATION      2.500E+001   FUNKY_OPT_UNIQUE  2.562E-003   2.562E-003 

--- 28 row(s) selected.
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

27   .    28   root                                                  1.75E+002
26   .    27   esp_exchange                    1:8(hash2) (m)        1.75E+002
25   .    26   sort_partial_groupby                                  1.75E+002
24   .    25   sort                                                  1.75E+002
23   .    24   esp_exchange                    8(hash2):8(hash2)     1.75E+002
22   .    23   hash_partial_groupby                                  1.75E+002
21   3    22   hybrid_hash_join      u                               3.74E+007
20   17   21   hybrid_hash_join                                      3.74E+007
19   .    20   esp_exchange                    8(hash2):8(hash2)     1.50E+008
18   .    19   partition_access                                      1.50E+008
.    .    18   index_scan            fs fr     ORDIDX3               1.50E+008
16   14   17   hybrid_hash_join                                      3.74E+007
15   .    16   partition_access                                      5.99E+008
.    .    15   file_scan             fs fr     LINEITEM              5.99E+008
13   .    14   esp_exchange                    8(rep-b):8(hash2)     5.00E+006
12   6    13   hybrid_hash_join      u                               5.00E+006
11   .    12   esp_exchange                    8(hash2):8(hash2)     5.00E+006
10   8    11   hybrid_hash_join                                      5.00E+006
9    .    10   partition_access                                      8.00E+007
.    .    9    file_scan             fs fr     PARTSUPP              8.00E+007
7    .    8    partition_access                                      1.25E+006
.    .    7    file_scan             fs fr     PART                  1.25E+006
5    .    6    esp_exchange                    8(hash2):8(hash2)     1.00E+006
4    .    5    partition_access                                      1.00E+006
.    .    4    index_scan            fs fr     SUIDX2                1.00E+006
2    .    3    esp_exchange                    8(rep-b):1 (m)        2.50E+001
1    .    2    partition_access                                      2.50E+001
.    .    1    file_scan             fs fr     NATION                2.50E+001

--- SQL operation complete.
>>obey optdml03(q10);
>>--------------------
>>--  TPCH Query 10 --
>>--------------------
>>prepare XX from
+>SELECT [FIRST 20] c_custkey, c_name,
+>       CAST(SUM(l_extendedprice*(1-l_discount)) AS NUMERIC(18,2)) AS revenue,
+>       c_acctbal,  n_name, c_address, c_phone, c_comment
+>FROM customer,orders,lineitem, nation
+>WHERE c_custkey = o_custkey
+>      AND l_orderkey = o_orderkey
+>      AND o_orderdate >=  DATE '1993-10-01'
+>      AND o_orderdate <  DATE '1993-10-01' + INTERVAL '3' MONTH
+>      AND l_returnflag = 'R'
+>      AND c_nationkey = n_nationkey
+>GROUP BY c_custkey, c_name, c_acctbal, c_phone, n_name,
+>         c_address, c_comment
+>ORDER BY revenue DESC;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

18  ROOT              17  ?               5.723E+006   FUNKY_OPT_UNIQUE  0.000E+000   1.147E+003 
17  FIRSTN            16  ?               5.723E+006   FUNKY_OPT_UNIQUE  0.000E+000   1.147E+003 
16  ESP_EXCHANGE      15  ?               5.723E+006   FUNKY_OPT_UNIQUE  2.786E-009   1.147E+003 
15  SORT              14  ?               5.723E+006   FUNKY_OPT_UNIQUE  5.984E-001   1.147E+003 
14  HASH_GROUPBY      13  ?               5.723E+006   FUNKY_OPT_UNIQUE  1.111E-001   1.147E+003 
13  HYBRID_HASH_JOIN  12  3               5.723E+006   FUNKY_OPT_UNIQUE  1.083E-001   1.147E+003 
12  HYBRID_HASH_JOIN  11  9               5.723E+006   FUNKY_OPT_UNIQUE  2.022E-001   1.146E+003 
11  PARTITION_ACCESS  10  ?               1.500E+007   FUNKY_OPT_UNIQUE  0.000E+000   3.664E+001 
10  FILE_SCAN         ?   ?   CUSTOMER    1.500E+007   FUNKY_OPT_UNIQUE  3.664E+001   3.664E+001 
09  ESP_EXCHANGE      8   ?               5.723E+006   FUNKY_OPT_UNIQUE  7.999E-002   1.110E+003 
08  HYBRID_HASH_JOIN  7   5               5.723E+006   FUNKY_OPT_UNIQUE  3.845E-001   1.109E+003 
07  PARTITION_ACCESS  6   ?               1.479E+008   FUNKY_OPT_UNIQUE  0.000E+000   8.970E+002 
06  FILE_SCAN         ?   ?   LINEITEM    1.479E+008   FUNKY_OPT_UNIQUE  8.970E+002   8.970E+002 
05  PARTITION_ACCESS  4   ?               5.798E+006   FUNKY_OPT_UNIQUE  0.000E+000   2.125E+002 
04  FILE_SCAN         ?   ?   ORDERS      5.798E+006   FUNKY_OPT_UNIQUE  2.125E+002   2.125E+002 
03  ESP_EXCHANGE      2   ?               2.500E+001   FUNKY_OPT_UNIQUE  3.900E-004   2.952E-003 
02  PARTITION_ACCESS  1   ?               2.500E+001   FUNKY_OPT_UNIQUE  0.000E+000   2.562E-003 
01  FILE_SCAN         ?   ?   NATION      2.500E+001   FUNKY_OPT_UNIQUE  2.562E-003   2.562E-003 

--- 18 row(s) selected.
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

17   .    18   root                                                  5.72E+006
16   .    17   firstn                                                5.72E+006
15   .    16   esp_exchange                    1:8(hash2) (m)        5.72E+006
14   .    15   sort                                                  5.72E+006
13   .    14   hash_groupby                                          5.72E+006
12   3    13   hybrid_hash_join      u                               5.72E+006
11   9    12   hybrid_hash_join                                      5.72E+006
10   .    11   partition_access                                      1.50E+007
.    .    10   file_scan             fs fr     CUSTOMER              1.50E+007
8    .    9    esp_exchange                    8(hash2):8(hash2)     5.72E+006
7    5    8    hybrid_hash_join                                      5.72E+006
6    .    7    partition_access                                      1.47E+008
.    .    6    file_scan             fs fr     LINEITEM              1.47E+008
4    .    5    partition_access                                      5.79E+006
.    .    4    file_scan             fs fr     ORDERS                5.79E+006
2    .    3    esp_exchange                    8(rep-b):1 (m)        2.50E+001
1    .    2    partition_access                                      2.50E+001
.    .    1    file_scan             fs fr     NATION                2.50E+001

--- SQL operation complete.
>>obey optdml03(q11);
>>--------------------
>>--  TPCH Query 11 --
>>--------------------
>>prepare XX from
+>SELECT ps_partkey, SUM(ps_supplycost * ps_availqty) AS ps_value
+>FROM partsupp,supplier,nation
+>WHERE ps_suppkey = s_suppkey
+>      AND s_nationkey = n_nationkey
+>      AND n_name = 'GERMANY'
+>GROUP BY ps_partkey
+>HAVING SUM(ps_supplycost*ps_availqty) >
+>       (SELECT SUM(ps_supplycost*ps_availqty) * 0.000001
+>        FROM partsupp,supplier,nation
+>        WHERE ps_suppkey = s_suppkey
+>              AND s_nationkey = n_nationkey
+>              AND n_name = 'GERMANY')
+>ORDER BY ps_value DESC;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

29  ROOT              28  ?               1.074E+006   FUNKY_OPT_UNIQUE  0.000E+000   3.656E+002 
28  ESP_EXCHANGE      27  ?               1.074E+006   FUNKY_OPT_UNIQUE  2.786E-009   3.656E+002 
27  SORT              26  ?               1.074E+006   FUNKY_OPT_UNIQUE  2.643E-002   3.656E+002 
26  HYBRID_HASH_JOIN  25  14              1.074E+006   FUNKY_OPT_UNIQUE  1.944E-002   3.656E+002 
25  HASH_GROUPBY      24  ?               3.223E+006   FUNKY_OPT_UNIQUE  2.073E-002   1.829E+002 
24  HYBRID_HASH_JOIN  23  21              3.223E+006   FUNKY_OPT_UNIQUE  2.680E-001   1.828E+002 
23  PARTITION_ACCESS  22  ?               8.000E+007   FUNKY_OPT_UNIQUE  0.000E+000   1.825E+002 
22  FILE_SCAN         ?   ?   PARTSUPP    8.000E+007   FUNKY_OPT_UNIQUE  1.825E+002   1.825E+002 
21  ESP_EXCHANGE      20  ?               4.028E+004   FUNKY_OPT_UNIQUE  1.809E-002   5.395E-002 
20  NESTED_JOIN       17  19              4.028E+004   FUNKY_OPT_UNIQUE  4.912E-005   3.585E-002 
19  PARTITION_ACCESS  18  ?               4.028E+004   FUNKY_OPT_UNIQUE  0.000E+000   3.311E-002 
18  INDEX_SCAN        ?   ?   SUPPLIER    4.028E+004   FUNKY_OPT_UNIQUE  3.311E-002   3.311E-002 
17  ESP_EXCHANGE      16  ?               1.000E+000   FUNKY_OPT_UNIQUE  1.341E-004   2.695E-003 
16  PARTITION_ACCESS  15  ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   2.561E-003 
15  FILE_SCAN         ?   ?   NATION      1.000E+000   FUNKY_OPT_UNIQUE  2.561E-003   2.561E-003 
14  ESP_EXCHANGE      13  ?               1.000E+000   FUNKY_OPT_UNIQUE  3.000E-004   1.827E+002 
13  SORT_PARTIAL_AGG  12  ?               1.000E+000   FUNKY_OPT_UNIQUE  3.740E-008   1.827E+002 
12  ESP_EXCHANGE      11  ?               1.000E+000   FUNKY_OPT_UNIQUE  8.385E-006   1.827E+002 
11  SORT_PARTIAL_AGG  10  ?               1.000E+000   FUNKY_OPT_UNIQUE  1.242E-003   1.827E+002 
10  HYBRID_HASH_JOIN  9   7               3.223E+006   FUNKY_OPT_UNIQUE  1.890E-001   1.827E+002 
09  PARTITION_ACCESS  8   ?               8.000E+007   FUNKY_OPT_UNIQUE  0.000E+000   1.824E+002 
08  FILE_SCAN         ?   ?   PARTSUPP    8.000E+007   FUNKY_OPT_UNIQUE  1.824E+002   1.824E+002 
07  ESP_EXCHANGE      6   ?               4.028E+004   FUNKY_OPT_UNIQUE  1.809E-002   5.395E-002 
06  NESTED_JOIN       3   5               4.028E+004   FUNKY_OPT_UNIQUE  4.912E-005   3.585E-002 
05  PARTITION_ACCESS  4   ?               4.028E+004   FUNKY_OPT_UNIQUE  0.000E+000   3.311E-002 
04  INDEX_SCAN        ?   ?   SUPPLIER    4.028E+004   FUNKY_OPT_UNIQUE  3.311E-002   3.311E-002 
03  ESP_EXCHANGE      2   ?               1.000E+000   FUNKY_OPT_UNIQUE  1.341E-004   2.695E-003 
02  PARTITION_ACCESS  1   ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   2.561E-003 
01  FILE_SCAN         ?   ?   NATION      1.000E+000   FUNKY_OPT_UNIQUE  2.561E-003   2.561E-003 

--- 29 row(s) selected.
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

28   .    29   root                                                  1.07E+006
27   .    28   esp_exchange                    1:8(hash2) (m)        1.07E+006
26   .    27   sort                                                  1.07E+006
25   14   26   hybrid_hash_join                                      1.07E+006
24   .    25   hash_groupby                                          3.22E+006
23   21   24   hybrid_hash_join      u                               3.22E+006
22   .    23   partition_access                                      8.00E+007
.    .    22   file_scan             fs fr     PARTSUPP              8.00E+007
20   .    21   esp_exchange                    8(rep-b):8(hash2)     4.02E+004
17   19   20   nested_join                                           4.02E+004
18   .    19   partition_access                                      4.02E+004
.    .    18   index_scan            fs fr     SUIDX2                4.02E+004
16   .    17   esp_exchange                    8(rep-b):1 (m)        1.00E+000
15   .    16   partition_access                                      1.00E+000
.    .    15   file_scan             fs fr     NATION                1.00E+000
13   .    14   esp_exchange                    8(rep-b):1            1.00E+000
12   .    13   sort_partial_aggr_ro                                  1.00E+000
11   .    12   esp_exchange                    1:8(hash2)            1.00E+000
10   .    11   sort_partial_aggr_le                                  1.00E+000
9    7    10   hybrid_hash_join      u                               3.22E+006
8    .    9    partition_access                                      8.00E+007
.    .    8    file_scan             fs fr     PARTSUPP              8.00E+007
6    .    7    esp_exchange                    8(rep-b):8(hash2)     4.02E+004
3    5    6    nested_join                                           4.02E+004
4    .    5    partition_access                                      4.02E+004
.    .    4    index_scan            fs fr     SUIDX2                4.02E+004
2    .    3    esp_exchange                    8(rep-b):1 (m)        1.00E+000
1    .    2    partition_access                                      1.00E+000
.    .    1    file_scan             fs fr     NATION                1.00E+000

--- SQL operation complete.
>>obey optdml03(q12);
>>--------------------
>>--  TPCH Query 12 --
>>--------------------
>>prepare XX from
+>SELECT l_shipmode,
+>       SUM(CASE WHEN o_orderpriority ='1-URGENT'
+>                     OR o_orderpriority ='2-HIGH'
+>                THEN 1
+>                ELSE 0
+>           END) AS high_line_count,
+>        SUM(CASE WHEN o_orderpriority <> '1-URGENT'
+>                      AND o_orderpriority <> '2-HIGH'
+>                 THEN 1
+>                 ELSE 0
+>            END) AS low_line_count
+>FROM orders,lineitem
+>where o_orderkey = l_orderkey
+>      AND l_shipmode in ('MAIL','SHIP')
+>      AND l_commitdate < l_receiptdate
+>      AND l_shipdate < l_commitdate
+>      AND l_receiptdate >=  DATE '1994-01-01'
+>      AND l_receiptdate <  DATE '1994-01-01' + INTERVAL '1' YEAR
+>GROUP BY l_shipmode
+>ORDER BY l_shipmode;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

11  ROOT              10  ?               2.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   1.109E+003 
10  ESP_EXCHANGE      9   ?               2.000E+000   FUNKY_OPT_UNIQUE  4.290E-005   1.109E+003 
09  SORT_PARTIAL_GRO  8   ?               2.000E+000   FUNKY_OPT_UNIQUE  5.369E-008   1.109E+003 
08  SORT              7   ?               2.000E+000   FUNKY_OPT_UNIQUE  3.375E-008   1.109E+003 
07  ESP_EXCHANGE      6   ?               2.000E+000   FUNKY_OPT_UNIQUE  8.527E-005   1.109E+003 
06  HASH_PARTIAL_GRO  5   ?               2.000E+000   FUNKY_OPT_UNIQUE  1.649E-003   1.109E+003 
05  HYBRID_HASH_JOIN  4   2               2.892E+006   FUNKY_OPT_UNIQUE  2.714E-001   1.109E+003 
04  PARTITION_ACCESS  3   ?               1.500E+008   FUNKY_OPT_UNIQUE  0.000E+000   2.128E+002 
03  FILE_SCAN         ?   ?   ORDERS      1.500E+008   FUNKY_OPT_UNIQUE  2.128E+002   2.128E+002 
02  PARTITION_ACCESS  1   ?               2.892E+006   FUNKY_OPT_UNIQUE  0.000E+000   8.966E+002 
01  FILE_SCAN         ?   ?   LINEITEM    2.892E+006   FUNKY_OPT_UNIQUE  8.966E+002   8.966E+002 

--- 11 row(s) selected.
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

10   .    11   root                                                  2.00E+000
9    .    10   esp_exchange                    1:8(hash2) (m)        2.00E+000
8    .    9    sort_partial_groupby                                  2.00E+000
7    .    8    sort                                                  2.00E+000
6    .    7    esp_exchange                    8(hash2):8(hash2)     2.00E+000
5    .    6    hash_partial_groupby                                  2.00E+000
4    2    5    hybrid_hash_join                                      2.89E+006
3    .    4    partition_access                                      1.50E+008
.    .    3    file_scan             fs fr     ORDERS                1.50E+008
1    .    2    partition_access                                      2.89E+006
.    .    1    file_scan             fs fr     LINEITEM              2.89E+006

--- SQL operation complete.
>>obey optdml03(q13);
>>--------------------
>>--  TPCH Query 13 --
>>--------------------
>>prepare XX from
+>
+>SELECT yr, sum(revenue) as revenue
+>  FROM
+>    (SELECT extract(year from o_orderdate) as yr,
+>       CAST(l_extendedprice * (1-l_discount) AS NUMERIC(18,2)) as revenue
+>FROM lineitem, orders
+>WHERE o_orderkey = l_orderkey
+>      AND o_clerk = 'Clerk#000000088'
+>      AND l_returnflag = 'R') as performance
+>GROUP BY yr
+>ORDER BY yr;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

11  ROOT              10  ?               7.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   2.182E+002 
10  ESP_EXCHANGE      9   ?               7.000E+000   FUNKY_OPT_UNIQUE  3.200E-005   2.182E+002 
09  SORT_PARTIAL_GRO  8   ?               7.000E+000   FUNKY_OPT_UNIQUE  3.283E-008   2.182E+002 
08  SORT              7   ?               7.000E+000   FUNKY_OPT_UNIQUE  1.824E-008   2.182E+002 
07  ESP_EXCHANGE      6   ?               7.000E+000   FUNKY_OPT_UNIQUE  6.257E-005   2.182E+002 
06  HASH_PARTIAL_GRO  5   ?               7.000E+000   FUNKY_OPT_UNIQUE  8.760E-007   2.182E+002 
05  NESTED_JOIN       2   4               1.481E+003   FUNKY_OPT_UNIQUE  8.567E-006   2.182E+002 
04  PARTITION_ACCESS  3   ?               9.873E-001   FUNKY_OPT_UNIQUE  0.000E+000   5.717E+000 
03  FILE_SCAN         ?   ?   LINEITEM    9.873E-001   FUNKY_OPT_UNIQUE  5.717E+000   5.717E+000 
02  PARTITION_ACCESS  1   ?               1.500E+003   FUNKY_OPT_UNIQUE  0.000E+000   2.125E+002 
01  FILE_SCAN         ?   ?   ORDERS      1.500E+003   FUNKY_OPT_UNIQUE  2.125E+002   2.125E+002 

--- 11 row(s) selected.
>>
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

10   .    11   root                                                  7.00E+000
9    .    10   esp_exchange                    1:8(hash2) (m)        7.00E+000
8    .    9    sort_partial_groupby                                  7.00E+000
7    .    8    sort                                                  7.00E+000
6    .    7    esp_exchange                    8(hash2):8(hash2)     7.00E+000
5    .    6    hash_partial_groupby                                  7.00E+000
2    4    5    nested_join                                           1.48E+003
3    .    4    partition_access                                      9.87E-001
.    .    3    file_scan             fs fr     LINEITEM              9.87E-001
1    .    2    partition_access                                      1.50E+003
.    .    1    file_scan             fs fr     ORDERS                1.50E+003

--- SQL operation complete.
>>obey optdml03(q14);
>>--------------------
>>--  TPCH Query 14 --
>>--------------------
>>prepare XX from
+>SELECT 100.00 * SUM(CASE WHEN p_type = 'promo' -- p_type like 'PROMO%'
+>                         THEN (l_extendedprice * (1-l_discount))
+>                         ELSE 0
+>                    END) / 
+>        SUM((l_extendedprice*(1-l_discount))) AS promo_revenue
+>FROM  lineitem, part
+>WHERE l_partkey = p_partkey
+>      AND l_shipdate >=  DATE '1995-09-01'
+>      AND l_shipdate <  DATE '1995-09-01' + INTERVAL '1' MONTH;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

10  ROOT              9   ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   9.339E+002 
09  SORT_PARTIAL_AGG  8   ?               1.000E+000   FUNKY_OPT_UNIQUE  3.882E-008   9.339E+002 
08  ESP_EXCHANGE      7   ?               1.000E+000   FUNKY_OPT_UNIQUE  1.257E-005   9.339E+002 
07  SORT_PARTIAL_AGG  6   ?               1.000E+000   FUNKY_OPT_UNIQUE  4.609E-003   9.339E+002 
06  HYBRID_HASH_JOIN  5   3               7.720E+006   FUNKY_OPT_UNIQUE  1.118E-001   9.339E+002 
05  PARTITION_ACCESS  4   ?               2.000E+007   FUNKY_OPT_UNIQUE  0.000E+000   3.701E+001 
04  FILE_SCAN         ?   ?   PART        2.000E+007   FUNKY_OPT_UNIQUE  3.701E+001   3.701E+001 
03  ESP_EXCHANGE      2   ?               7.720E+006   FUNKY_OPT_UNIQUE  1.205E-001   8.968E+002 
02  PARTITION_ACCESS  1   ?               7.720E+006   FUNKY_OPT_UNIQUE  0.000E+000   8.967E+002 
01  FILE_SCAN         ?   ?   LINEITEM    7.720E+006   FUNKY_OPT_UNIQUE  8.967E+002   8.967E+002 

--- 10 row(s) selected.
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

9    .    10   root                                                  1.00E+000
8    .    9    sort_partial_aggr_ro                                  1.00E+000
7    .    8    esp_exchange                    1:8(hash2)            1.00E+000
6    .    7    sort_partial_aggr_le                                  1.00E+000
5    3    6    hybrid_hash_join                                      7.72E+006
4    .    5    partition_access                                      2.00E+007
.    .    4    file_scan             fs fr     PART                  2.00E+007
2    .    3    esp_exchange                    8(hash2):8(hash2)     7.72E+006
1    .    2    partition_access                                      7.72E+006
.    .    1    file_scan             fs fr     LINEITEM              7.72E+006

--- SQL operation complete.
>>obey optdml03(q15);
>>--------------------
>>--  TPCH Query 15 --
>>--------------------
>>create view revenue (supplier_no, total_revenue) AS
+>     SELECT l_suppkey, SUM(l_extendedprice * (1-l_discount))
+>     FROM lineitem
+>     WHERE l_shipdate >= DATE '1996-01-01'
+>       AND l_shipdate <  DATE '1996-01-01' + INTERVAL '3' MONTH
+>     GROUP BY l_suppkey;

--- SQL operation complete.
>>
>>prepare XX from
+>SELECT s_suppkey, s_name, s_address, s_phone, total_revenue
+>FROM  supplier, revenue
+>WHERE s_suppkey = supplier_no
+>  AND total_revenue = (SELECT MAX(total_revenue)
+>                       FROM revenue)
+>ORDER BY s_suppkey;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

21  ROOT              20  ?               3.333E+005   FUNKY_OPT_UNIQUE  0.000E+000   1.795E+003 
20  ESP_EXCHANGE      19  ?               3.333E+005   FUNKY_OPT_UNIQUE  2.786E-009   1.795E+003 
19  SORT              18  ?               3.333E+005   FUNKY_OPT_UNIQUE  1.779E-002   1.795E+003 
18  HYBRID_HASH_JOIN  17  15              3.333E+005   FUNKY_OPT_UNIQUE  8.605E-003   1.795E+003 
17  PARTITION_ACCESS  16  ?               1.000E+006   FUNKY_OPT_UNIQUE  0.000E+000   2.093E+000 
16  FILE_SCAN         ?   ?   SUPPLIER    1.000E+006   FUNKY_OPT_UNIQUE  2.093E+000   2.093E+000 
15  HYBRID_HASH_JOIN  14  9               3.333E+005   FUNKY_OPT_UNIQUE  3.633E-003   1.793E+003 
14  HASH_PARTIAL_GRO  13  ?               1.000E+006   FUNKY_OPT_UNIQUE  4.332E-002   8.968E+002 
13  ESP_EXCHANGE      12  ?               1.489E+007   FUNKY_OPT_UNIQUE  5.808E-002   8.968E+002 
12  HASH_PARTIAL_GRO  11  ?               1.489E+007   FUNKY_OPT_UNIQUE  2.957E-002   8.967E+002 
11  PARTITION_ACCESS  10  ?               2.291E+007   FUNKY_OPT_UNIQUE  0.000E+000   8.967E+002 
10  FILE_SCAN         ?   ?   LINEITEM    2.291E+007   FUNKY_OPT_UNIQUE  8.967E+002   8.967E+002 
09  ESP_EXCHANGE      8   ?               1.000E+000   FUNKY_OPT_UNIQUE  2.846E-004   8.968E+002 
08  SORT_PARTIAL_AGG  7   ?               1.000E+000   FUNKY_OPT_UNIQUE  3.723E-008   8.968E+002 
07  ESP_EXCHANGE      6   ?               1.000E+000   FUNKY_OPT_UNIQUE  8.894E-006   8.968E+002 
06  SORT_PARTIAL_AGG  5   ?               1.000E+000   FUNKY_OPT_UNIQUE  4.875E-004   8.968E+002 
05  HASH_PARTIAL_GRO  4   ?               1.000E+006   FUNKY_OPT_UNIQUE  4.304E-002   8.968E+002 
04  ESP_EXCHANGE      3   ?               1.489E+007   FUNKY_OPT_UNIQUE  5.808E-002   8.968E+002 
03  HASH_PARTIAL_GRO  2   ?               1.489E+007   FUNKY_OPT_UNIQUE  2.957E-002   8.967E+002 
02  PARTITION_ACCESS  1   ?               2.291E+007   FUNKY_OPT_UNIQUE  0.000E+000   8.967E+002 
01  FILE_SCAN         ?   ?   LINEITEM    2.291E+007   FUNKY_OPT_UNIQUE  8.967E+002   8.967E+002 

--- 21 row(s) selected.
>>
>>drop view revenue;

--- SQL operation complete.
>>
>>--prepare XX from
>>--SELECT s_suppkey,s_name,s_address,s_phone, total_revenue
>>--FROM supplier, (SELECT l_suppkey, SUM(l_extendedprice * (1-l_discount))
>>--                FROM lineitem
>>--                WHERE l_shipdate >=  DATE '1996-01-01'
>>--                      AND l_shipdate <  DATE '1996-01-01' + INTERVAL '3' MONTH
>>--                GROUP BY l_suppkey) revenue(supplier_no, total_revenue)
>>--WHERE s_suppkey = supplier_no
>>--      AND total_revenue = (SELECT MAX(total_revenue)
>>--                           FROM (SELECT l_suppkey,
>>--                                        sum(l_extendedprice * (1-l_discount))
>>--                                 FROM lineitem
>>--                                 WHERE l_shipdate >=  DATE '1996-01-01'
>>--                                 AND l_shipdate <  DATE '1996-01-01' + INTERVAL '3' MONTH
>>--                                 GROUP BY l_suppkey)
>>--                           revenue(supplier_no, total_revenue))
>>--ORDER BY s_suppkey;
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

20   .    21   root                                                  3.33E+005
19   .    20   esp_exchange                    1:8(hash2) (m)        3.33E+005
18   .    19   sort                                                  3.33E+005
17   15   18   hybrid_hash_join      u                               3.33E+005
16   .    17   partition_access                                      1.00E+006
.    .    16   file_scan             fs fr     SUPPLIER              1.00E+006
14   9    15   hybrid_hash_join      u                               3.33E+005
13   .    14   hash_partial_groupby                                  1.00E+006
12   .    13   esp_exchange                    8(hash2):8(hash2)     1.48E+007
11   .    12   hash_partial_groupby                                  1.48E+007
10   .    11   partition_access                                      2.29E+007
.    .    10   file_scan             fs fr     LINEITEM              2.29E+007
8    .    9    esp_exchange                    8(rep-b):1            1.00E+000
7    .    8    sort_partial_aggr_ro                                  1.00E+000
6    .    7    esp_exchange                    1:8(hash2)            1.00E+000
5    .    6    sort_partial_aggr_le                                  1.00E+000
4    .    5    hash_partial_groupby                                  1.00E+006
3    .    4    esp_exchange                    8(hash2):8(hash2)     1.48E+007
2    .    3    hash_partial_groupby                                  1.48E+007
1    .    2    partition_access                                      2.29E+007
.    .    1    file_scan             fs fr     LINEITEM              2.29E+007

--- SQL operation complete.
>>obey optdml03(q16);
>>--------------------
>>--  TPCH Query 16 --
>>--------------------
>>prepare XX from
+>SELECT p_brand, p_type, p_size, COUNT(DISTINCT ps_suppkey) AS supplier_cnt
+>FROM partsupp, part
+>WHERE p_partkey = ps_partkey
+>      AND p_brand <> 'Brand#45'
+>      AND p_type NOT LIKE 'MEDIUM POLISHED%'
+>      AND p_size IN (49, 14, 23, 45, 19, 3, 36, 9)
+>      AND ps_suppkey NOT IN (SELECT s_suppkey
+>                             FROM supplier
+>                             WHERE s_comment LIKE
+>                                  '%Better Business Bureau%Complaints%')
+>GROUP BY p_brand, p_type, p_size
+>ORDER BY supplier_cnt DESC, p_brand, p_type, p_size;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

18  ROOT              17  ?               2.840E+004   FUNKY_OPT_UNIQUE  0.000E+000   1.879E+002 
17  ESP_EXCHANGE      16  ?               2.840E+004   FUNKY_OPT_UNIQUE  2.786E-009   1.879E+002 
16  SORT              15  ?               2.840E+004   FUNKY_OPT_UNIQUE  8.356E-004   1.879E+002 
15  HASH_PARTIAL_GRO  14  ?               2.840E+004   FUNKY_OPT_UNIQUE  2.423E-004   1.879E+002 
14  ESP_EXCHANGE      13  ?               2.840E+004   FUNKY_OPT_UNIQUE  2.901E-004   1.879E+002 
13  HASH_PARTIAL_GRO  12  ?               2.840E+004   FUNKY_OPT_UNIQUE  1.174E-002   1.879E+002 
12  HASH_PARTIAL_GRO  11  ?               1.125E+007   FUNKY_OPT_UNIQUE  9.203E-002   1.879E+002 
11  ESP_EXCHANGE      10  ?               1.125E+007   FUNKY_OPT_UNIQUE  6.585E-002   1.878E+002 
10  HASH_PARTIAL_GRO  9   ?               1.125E+007   FUNKY_OPT_UNIQUE  2.300E-002   1.877E+002 
09  HYBRID_HASH_ANTI  8   3               1.125E+007   FUNKY_OPT_UNIQUE  9.571E-002   1.877E+002 
08  NESTED_JOIN       5   7               1.200E+007   FUNKY_OPT_UNIQUE  7.362E-002   1.855E+002 
07  PARTITION_ACCESS  6   ?               4.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   1.485E+002 
06  INDEX_SCAN        ?   ?   PARTSUPP    4.000E+000   FUNKY_OPT_UNIQUE  1.485E+002   1.485E+002 
05  PARTITION_ACCESS  4   ?               3.001E+006   FUNKY_OPT_UNIQUE  0.000E+000   3.696E+001 
04  FILE_SCAN         ?   ?   PART        3.001E+006   FUNKY_OPT_UNIQUE  3.696E+001   3.696E+001 
03  ESP_EXCHANGE      2   ?               6.250E+004   FUNKY_OPT_UNIQUE  3.616E-003   2.091E+000 
02  PARTITION_ACCESS  1   ?               6.250E+004   FUNKY_OPT_UNIQUE  0.000E+000   2.087E+000 
01  FILE_SCAN         ?   ?   SUPPLIER    6.250E+004   FUNKY_OPT_UNIQUE  2.087E+000   2.087E+000 

--- 18 row(s) selected.
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

17   .    18   root                                                  2.83E+004
16   .    17   esp_exchange                    1:8(hash2) (m)        2.83E+004
15   .    16   sort                                                  2.83E+004
14   .    15   hash_partial_groupby                                  2.83E+004
13   .    14   esp_exchange                    8(hash2):8(hash2)     2.83E+004
12   .    13   hash_partial_groupby                                  2.83E+004
11   .    12   hash_partial_groupby                                  1.12E+007
10   .    11   esp_exchange                    8(hash2):8(hash2)     1.12E+007
9    .    10   hash_partial_groupby                                  1.12E+007
8    3    9    hybrid_hash_anti_sem                                  1.12E+007
5    7    8    nested_join                                           1.20E+007
6    .    7    partition_access                                      4.00E+000
.    .    6    index_scan            fs fr     PSIDX1                4.00E+000
4    .    5    partition_access                                      3.00E+006
.    .    4    file_scan             fs fr     PART                  3.00E+006
2    .    3    esp_exchange                    8(rep-b):8(hash2)     6.25E+004
1    .    2    partition_access                                      6.25E+004
.    .    1    file_scan             fs fr     SUPPLIER              6.25E+004

--- SQL operation complete.
>>obey optdml03(q17);
>>--------------------
>>--  TPCH Query 17 --
>>--------------------
>>prepare XX from
+>SELECT CAST((SUM(l_extendedprice)/7.0) AS NUMERIC(18,2)) AS avg_yearly
+>FROM lineitem, part
+>WHERE p_partkey = l_partkey
+>      AND p_brand = 'Brand#23'
+>      AND p_container = 'MED BOX'
+>      AND l_quantity < (SELECT 0.2*avg(l_quantity)
+>                        FROM lineitem 
+>                        WHERE l_partkey = p_partkey);

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

15  ROOT              14  ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   1.836E+003 
14  SORT_PARTIAL_AGG  13  ?               1.000E+000   FUNKY_OPT_UNIQUE  2.775E-008   1.836E+003 
13  ESP_EXCHANGE      12  ?               1.000E+000   FUNKY_OPT_UNIQUE  6.629E-006   1.836E+003 
12  SORT_PARTIAL_AGG  11  ?               1.000E+000   FUNKY_OPT_UNIQUE  2.068E-003   1.836E+003 
11  HASH_GROUPBY      10  ?               6.000E+006   FUNKY_OPT_UNIQUE  7.241E-002   1.836E+003 
10  HYBRID_HASH_JOIN  9   7               1.800E+007   FUNKY_OPT_UNIQUE  1.705E+000   1.836E+003 
09  PARTITION_ACCESS  8   ?               5.994E+008   FUNKY_OPT_UNIQUE  0.000E+000   8.983E+002 
08  FILE_SCAN         ?   ?   LINEITEM    5.994E+008   FUNKY_OPT_UNIQUE  8.983E+002   8.983E+002 
07  ESP_EXCHANGE      6   ?               6.007E+005   FUNKY_OPT_UNIQUE  5.820E-002   9.362E+002 
06  HYBRID_HASH_JOIN  5   3               6.007E+005   FUNKY_OPT_UNIQUE  1.266E+000   9.361E+002 
05  PARTITION_ACCESS  4   ?               5.994E+008   FUNKY_OPT_UNIQUE  0.000E+000   8.979E+002 
04  FILE_SCAN         ?   ?   LINEITEM    5.994E+008   FUNKY_OPT_UNIQUE  8.979E+002   8.979E+002 
03  ESP_EXCHANGE      2   ?               2.004E+004   FUNKY_OPT_UNIQUE  1.250E-003   3.695E+001 
02  PARTITION_ACCESS  1   ?               2.004E+004   FUNKY_OPT_UNIQUE  0.000E+000   3.694E+001 
01  FILE_SCAN         ?   ?   PART        2.004E+004   FUNKY_OPT_UNIQUE  3.694E+001   3.694E+001 

--- 15 row(s) selected.
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

14   .    15   root                                                  1.00E+000
13   .    14   sort_partial_aggr_ro                                  1.00E+000
12   .    13   esp_exchange                    1:8(hash2)            1.00E+000
11   .    12   sort_partial_aggr_le                                  1.00E+000
10   .    11   hash_groupby                                          6.00E+006
9    7    10   hybrid_hash_join                                      1.80E+007
8    .    9    partition_access                                      5.99E+008
.    .    8    file_scan             fs fr     LINEITEM              5.99E+008
6    .    7    esp_exchange                    8(rep-b):8(hash2)     6.00E+005
5    3    6    hybrid_hash_join      u                               6.00E+005
4    .    5    partition_access                                      5.99E+008
.    .    4    file_scan             fs fr     LINEITEM              5.99E+008
2    .    3    esp_exchange                    8(rep-b):8(hash2)     2.00E+004
1    .    2    partition_access                                      2.00E+004
.    .    1    file_scan             fs fr     PART                  2.00E+004

--- SQL operation complete.
>>obey optdml03(q18);
>>--------------------
>>--  TPCH Query 18 --
>>--------------------
>>prepare XX from
+>SELECT [FIRST 100] c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice,
+>                   SUM(l_quantity)
+>FROM customer, orders, lineitem
+>WHERE o_orderkey IN (SELECT l_orderkey
+>                     FROM lineitem
+>                     GROUP BY l_orderkey HAVING SUM(l_quantity) >  300)
+>      AND c_custkey = o_custkey
+>      AND o_orderkey = l_orderkey
+>GROUP BY c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice
+>ORDER BY o_totalprice DESC, o_orderdate;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

18  ROOT              17  ?               4.994E+007   FUNKY_OPT_UNIQUE  0.000E+000   2.055E+003 
17  FIRSTN            16  ?               4.994E+007   FUNKY_OPT_UNIQUE  0.000E+000   2.055E+003 
16  ESP_EXCHANGE      15  ?               4.994E+007   FUNKY_OPT_UNIQUE  2.786E-009   2.055E+003 
15  SORT              14  ?               4.994E+007   FUNKY_OPT_UNIQUE  5.353E+000   2.055E+003 
14  HYBRID_HASH_JOIN  13  2               4.994E+007   FUNKY_OPT_UNIQUE  4.374E-001   2.050E+003 
13  ESP_EXCHANGE      12  ?               4.994E+007   FUNKY_OPT_UNIQUE  9.207E-001   2.013E+003 
12  HYBRID_HASH_JOIN  11  9               4.994E+007   FUNKY_OPT_UNIQUE  6.753E-001   2.012E+003 
11  PARTITION_ACCESS  10  ?               1.500E+008   FUNKY_OPT_UNIQUE  0.000E+000   2.129E+002 
10  FILE_SCAN         ?   ?   ORDERS      1.500E+008   FUNKY_OPT_UNIQUE  2.129E+002   2.129E+002 
09  HYBRID_HASH_JOIN  8   5               4.994E+007   FUNKY_OPT_UNIQUE  4.826E-001   1.798E+003 
08  PARTITION_ACCESS  7   ?               1.498E+008   FUNKY_OPT_UNIQUE  0.000E+000   8.992E+002 
07  SORT_GROUPBY      6   ?               1.498E+008   FUNKY_OPT_UNIQUE  1.328E+000   8.992E+002 
06  FILE_SCAN         ?   ?   LINEITEM    5.994E+008   FUNKY_OPT_UNIQUE  8.979E+002   8.979E+002 
05  PARTITION_ACCESS  4   ?               4.994E+007   FUNKY_OPT_UNIQUE  0.000E+000   8.990E+002 
04  SORT_GROUPBY      3   ?               4.994E+007   FUNKY_OPT_UNIQUE  1.073E+000   8.990E+002 
03  FILE_SCAN         ?   ?   LINEITEM    5.994E+008   FUNKY_OPT_UNIQUE  8.979E+002   8.979E+002 
02  PARTITION_ACCESS  1   ?               1.500E+007   FUNKY_OPT_UNIQUE  0.000E+000   3.655E+001 
01  FILE_SCAN         ?   ?   CUSTOMER    1.500E+007   FUNKY_OPT_UNIQUE  3.655E+001   3.655E+001 

--- 18 row(s) selected.
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

17   .    18   root                                                  4.99E+007
16   .    17   firstn                                                4.99E+007
15   .    16   esp_exchange                    1:8(hash2) (m)        4.99E+007
14   .    15   sort                                                  4.99E+007
13   2    14   hybrid_hash_join                                      4.99E+007
12   .    13   esp_exchange                    8(hash2):8(hash2)     4.99E+007
11   9    12   hybrid_hash_join                                      4.99E+007
10   .    11   partition_access                                      1.50E+008
.    .    10   file_scan             fs fr     ORDERS                1.50E+008
8    5    9    hybrid_hash_join                                      4.99E+007
7    .    8    partition_access                                      1.49E+008
6    .    7    sort_groupby                                          1.49E+008
.    .    6    file_scan             fs        LINEITEM              5.99E+008
4    .    5    partition_access                                      4.99E+007
3    .    4    sort_groupby                                          4.99E+007
.    .    3    file_scan             fs        LINEITEM              5.99E+008
1    .    2    partition_access                                      1.50E+007
.    .    1    file_scan             fs fr     CUSTOMER              1.50E+007

--- SQL operation complete.
>>obey optdml03(q19);
>>--------------------
>>--  TPCH Query 19 --
>>--------------------
>>prepare XX from
+>SELECT CAST(SUM(l_extendedprice*(1-l_discount)) AS NUMERIC(18,2)) AS revenue
+>FROM lineitem, part
+>WHERE 
+>   (    p_partkey = l_partkey
+>    AND p_brand = 'Brand#24'
+>    AND p_container IN ( 'SM CASE', 'SM BOX', 'SM PACK', 'SM PKG' )
+>    AND l_quantity >= 1 AND l_quantity <= 1 + 10
+>    AND p_size BETWEEN 1 AND 5
+>    AND l_shipmode IN ( 'AIR', 'AIR REG' )
+>    AND l_shipinstruct = 'DELIVER IN PERSON' 
+>   )
+> OR
+>   (    p_partkey = l_partkey
+>    AND p_brand = 'Brand#16'
+>    AND p_container IN ( 'MED CASE', 'MED BOX', 'MED PACK', 'MED PKG' )
+>    AND l_quantity >= 10 AND l_quantity <= 10 + 10
+>    AND p_size BETWEEN 1 AND 10
+>    AND l_shipmode IN ( 'AIR', 'AIR REG' )
+>    AND l_shipinstruct = 'DELIVER IN PERSON' 
+>   )
+> OR
+>   (    p_partkey = l_partkey
+>    AND p_brand = 'Brand#42'
+>    AND p_container IN ( 'LG CASE', 'LG BOX', 'LG PACK', 'LG PKG' )
+>    AND l_quantity >= 20 AND l_quantity <= 20 + 10
+>    AND p_size BETWEEN 1 AND 15
+>    AND l_shipmode IN ( 'AIR', 'AIR REG' )
+>    AND l_shipinstruct = 'DELIVER IN PERSON' 
+>   );

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

10  ROOT              9   ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   9.342E+002 
09  SORT_PARTIAL_AGG  8   ?               1.000E+000   FUNKY_OPT_UNIQUE  3.723E-008   9.342E+002 
08  ESP_EXCHANGE      7   ?               1.000E+000   FUNKY_OPT_UNIQUE  8.894E-006   9.342E+002 
07  SORT_PARTIAL_AGG  6   ?               1.000E+000   FUNKY_OPT_UNIQUE  2.415E-006   9.342E+002 
06  HYBRID_HASH_JOIN  5   3               5.708E+003   FUNKY_OPT_UNIQUE  1.734E-001   9.342E+002 
05  PARTITION_ACCESS  4   ?               2.000E+007   FUNKY_OPT_UNIQUE  0.000E+000   3.701E+001 
04  FILE_SCAN         ?   ?   PART        2.000E+007   FUNKY_OPT_UNIQUE  3.701E+001   3.701E+001 
03  ESP_EXCHANGE      2   ?               2.140E+007   FUNKY_OPT_UNIQUE  3.655E-001   8.971E+002 
02  PARTITION_ACCESS  1   ?               2.140E+007   FUNKY_OPT_UNIQUE  0.000E+000   8.967E+002 
01  FILE_SCAN         ?   ?   LINEITEM    2.140E+007   FUNKY_OPT_UNIQUE  8.967E+002   8.967E+002 

--- 10 row(s) selected.
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

9    .    10   root                                                  1.00E+000
8    .    9    sort_partial_aggr_ro                                  1.00E+000
7    .    8    esp_exchange                    1:8(hash2)            1.00E+000
6    .    7    sort_partial_aggr_le                                  1.00E+000
5    3    6    hybrid_hash_join                                      5.70E+003
4    .    5    partition_access                                      2.00E+007
.    .    4    file_scan             fs fr     PART                  2.00E+007
2    .    3    esp_exchange                    8(hash2):8(hash2)     2.14E+007
1    .    2    partition_access                                      2.14E+007
.    .    1    file_scan             fs fr     LINEITEM              2.14E+007

--- SQL operation complete.
>>obey optdml03(q20);
>>--------------------
>>--  TPCH Query 20 --
>>--------------------
>>prepare XX from
+>SELECT s_name, s_address
+>FROM supplier, nation
+>WHERE s_suppkey IN (SELECT ps_suppkey
+>                    FROM partsupp
+>                    WHERE ps_partkey IN (SELECT p_partkey
+>                                         FROM part
+>                                         WHERE p_name LIKE 'forest%')
+>                      AND ps_availqty > (SELECT 0.5 * sum(l_quantity)
+>                                         FROM lineitem
+>                                         WHERE l_partkey = ps_partkey
+>                                           AND l_suppkey = ps_suppkey
+>                                           AND l_shipdate >= DATE '1994-01-01'
+>                                           AND l_shipdate <  DATE '1994-01-01'
+>                                                              + INTERVAL '1' YEAR)
+>                     )
+>  AND s_nationkey = n_nationkey
+>  AND n_name = 'CANADA'
+>ORDER by s_name;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

22  ROOT              21  ?               4.028E+004   FUNKY_OPT_UNIQUE  0.000E+000   1.119E+003 
21  ESP_EXCHANGE      20  ?               4.028E+004   FUNKY_OPT_UNIQUE  2.786E-009   1.119E+003 
20  SORT              19  ?               4.028E+004   FUNKY_OPT_UNIQUE  1.436E-003   1.119E+003 
19  HYBRID_HASH_SEMI  18  12              4.028E+004   FUNKY_OPT_UNIQUE  2.724E-003   1.119E+003 
18  NESTED_JOIN       15  17              4.028E+004   FUNKY_OPT_UNIQUE  2.069E-004   2.121E+000 
17  PARTITION_ACCESS  16  ?               4.028E+004   FUNKY_OPT_UNIQUE  0.000E+000   2.118E+000 
16  FILE_SCAN         ?   ?   SUPPLIER    4.028E+004   FUNKY_OPT_UNIQUE  2.118E+000   2.118E+000 
15  ESP_EXCHANGE      14  ?               1.000E+000   FUNKY_OPT_UNIQUE  1.341E-004   2.695E-003 
14  PARTITION_ACCESS  13  ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   2.561E-003 
13  FILE_SCAN         ?   ?   NATION      1.000E+000   FUNKY_OPT_UNIQUE  2.561E-003   2.561E-003 
12  ESP_EXCHANGE      11  ?               1.898E+006   FUNKY_OPT_UNIQUE  1.335E-002   1.116E+003 
11  HASH_GROUPBY      10  ?               1.898E+006   FUNKY_OPT_UNIQUE  1.784E-002   1.116E+003 
10  HYBRID_HASH_JOIN  9   7               5.696E+006   FUNKY_OPT_UNIQUE  1.981E-001   1.116E+003 
09  PARTITION_ACCESS  8   ?               8.000E+007   FUNKY_OPT_UNIQUE  0.000E+000   1.824E+002 
08  FILE_SCAN         ?   ?   PARTSUPP    8.000E+007   FUNKY_OPT_UNIQUE  1.824E+002   1.824E+002 
07  ESP_EXCHANGE      6   ?               5.696E+006   FUNKY_OPT_UNIQUE  7.962E-002   9.342E+002 
06  HYBRID_HASH_JOIN  5   3               5.696E+006   FUNKY_OPT_UNIQUE  2.482E-001   9.341E+002 
05  PARTITION_ACCESS  4   ?               9.114E+007   FUNKY_OPT_UNIQUE  0.000E+000   8.969E+002 
04  FILE_SCAN         ?   ?   LINEITEM    9.114E+007   FUNKY_OPT_UNIQUE  8.969E+002   8.969E+002 
03  ESP_EXCHANGE      2   ?               1.250E+006   FUNKY_OPT_UNIQUE  6.978E-002   3.702E+001 
02  PARTITION_ACCESS  1   ?               1.250E+006   FUNKY_OPT_UNIQUE  0.000E+000   3.695E+001 
01  FILE_SCAN         ?   ?   PART        1.250E+006   FUNKY_OPT_UNIQUE  3.695E+001   3.695E+001 

--- 22 row(s) selected.
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

21   .    22   root                                                  4.02E+004
20   .    21   esp_exchange                    1:8(hash2) (m)        4.02E+004
19   .    20   sort                                                  4.02E+004
18   12   19   hybrid_hash_semi_joi                                  4.02E+004
15   17   18   nested_join                                           4.02E+004
16   .    17   partition_access                                      4.02E+004
.    .    16   file_scan             fs fr     SUPPLIER              4.02E+004
14   .    15   esp_exchange                    8(rep-b):1 (m)        1.00E+000
13   .    14   partition_access                                      1.00E+000
.    .    13   file_scan             fs fr     NATION                1.00E+000
11   .    12   esp_exchange                    8(hash2):8(hash2)     1.89E+006
10   .    11   hash_groupby                                          1.89E+006
9    7    10   hybrid_hash_join                                      5.69E+006
8    .    9    partition_access                                      8.00E+007
.    .    8    file_scan             fs fr     PARTSUPP              8.00E+007
6    .    7    esp_exchange                    8(hash2):8(hash2)     5.69E+006
5    3    6    hybrid_hash_join                                      5.69E+006
4    .    5    partition_access                                      9.11E+007
.    .    4    file_scan             fs fr     LINEITEM              9.11E+007
2    .    3    esp_exchange                    8(rep-b):8(hash2)     1.25E+006
1    .    2    partition_access                                      1.25E+006
.    .    1    file_scan             fs fr     PART                  1.25E+006

--- SQL operation complete.
>>obey optdml03(q21);
>>--------------------
>>--  TPCH Query 21 --
>>--------------------
>>prepare XX from
+>SELECT [FIRST 100] s_name, count(*) as numwait
+>FROM supplier, lineitem l1, part, orders, nation
+>WHERE s_suppkey = l1.l_suppkey
+>  AND l1.l_partkey = p_partkey
+>  AND o_orderkey = l1.l_orderkey
+>  AND o_orderstatus = 'F'
+>  AND l1.l_receiptdate > l1.l_commitdate
+>  AND EXISTS (SELECT *
+>              FROM lineitem l2
+>              WHERE l2.l_orderkey = l1.l_orderkey
+>                AND l2.l_suppkey <> l1.l_suppkey)
+>  AND NOT EXISTS (SELECT *
+>                  FROM lineitem l3
+>                  WHERE l3.l_orderkey = l1.l_orderkey
+>                    AND l3.l_suppkey <> l1.l_suppkey
+>                    AND l3.l_receiptdate > l3.l_commitdate)
+>  AND s_nationkey = n_nationkey
+>  AND n_name = 'SAUDI ARABIA'
+>GROUP BY s_name
+>ORDER BY numwait DESC, s_name;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

31  ROOT              30  ?               1.000E+006   FUNKY_OPT_UNIQUE  0.000E+000   6.849E+003 
30  FIRSTN            29  ?               1.000E+006   FUNKY_OPT_UNIQUE  0.000E+000   6.849E+003 
29  ESP_EXCHANGE      28  ?               1.000E+006   FUNKY_OPT_UNIQUE  2.786E-009   6.849E+003 
28  SORT              27  ?               1.000E+006   FUNKY_OPT_UNIQUE  3.313E-002   6.849E+003 
27  HASH_PARTIAL_GRO  26  ?               1.000E+006   FUNKY_OPT_UNIQUE  7.811E-003   6.849E+003 
26  ESP_EXCHANGE      25  ?               1.231E+006   FUNKY_OPT_UNIQUE  6.253E-003   6.849E+003 
25  HASH_PARTIAL_GRO  24  ?               1.231E+006   FUNKY_OPT_UNIQUE  2.141E-003   6.849E+003 
24  HYBRID_HASH_JOIN  23  21              1.308E+006   FUNKY_OPT_UNIQUE  3.262E-002   6.849E+003 
23  PARTITION_ACCESS  22  ?               2.000E+007   FUNKY_OPT_UNIQUE  0.000E+000   2.411E+000 
22  INDEX_SCAN        ?   ?   PART        2.000E+007   FUNKY_OPT_UNIQUE  2.411E+000   2.411E+000 
21  ESP_EXCHANGE      20  ?               1.308E+006   FUNKY_OPT_UNIQUE  2.489E-002   6.847E+003 
20  NESTED_SEMI_JOIN  16  19              1.308E+006   FUNKY_OPT_UNIQUE  1.399E-002   6.847E+003 
19  PROBE_CACHE       18  ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   4.837E+003 
18  PARTITION_ACCESS  17  ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   4.837E+003 
17  FILE_SCAN         ?   ?   LINEITEM)   1.000E+000   FUNKY_OPT_UNIQUE  4.837E+003   4.837E+003 
16  HYBRID_HASH_ANTI  15  2               1.308E+006   FUNKY_OPT_UNIQUE  3.738E-001   2.009E+003 
15  HYBRID_HASH_JOIN  14  4               3.925E+006   FUNKY_OPT_UNIQUE  1.333E-001   1.112E+003 
14  HYBRID_HASH_JOIN  13  11              8.049E+006   FUNKY_OPT_UNIQUE  4.526E-001   8.996E+002 
13  PARTITION_ACCESS  12  ?               1.997E+008   FUNKY_OPT_UNIQUE  0.000E+000   8.971E+002 
12  FILE_SCAN         ?   ?   LINEITEM)   1.997E+008   FUNKY_OPT_UNIQUE  8.971E+002   8.971E+002 
11  ESP_EXCHANGE      10  ?               4.028E+004   FUNKY_OPT_UNIQUE  6.404E-003   2.127E+000 
10  NESTED_JOIN       7   9               4.028E+004   FUNKY_OPT_UNIQUE  1.322E-004   2.120E+000 
09  PARTITION_ACCESS  8   ?               4.028E+004   FUNKY_OPT_UNIQUE  0.000E+000   2.118E+000 
08  FILE_SCAN         ?   ?   SUPPLIER    4.028E+004   FUNKY_OPT_UNIQUE  2.118E+000   2.118E+000 
07  ESP_EXCHANGE      6   ?               1.000E+000   FUNKY_OPT_UNIQUE  1.341E-004   2.695E-003 
06  PARTITION_ACCESS  5   ?               1.000E+000   FUNKY_OPT_UNIQUE  0.000E+000   2.561E-003 
05  FILE_SCAN         ?   ?   NATION      1.000E+000   FUNKY_OPT_UNIQUE  2.561E-003   2.561E-003 
04  PARTITION_ACCESS  3   ?               7.307E+007   FUNKY_OPT_UNIQUE  0.000E+000   2.126E+002 
03  FILE_SCAN         ?   ?   ORDERS      7.307E+007   FUNKY_OPT_UNIQUE  2.126E+002   2.126E+002 
02  PARTITION_ACCESS  1   ?               1.997E+008   FUNKY_OPT_UNIQUE  0.000E+000   8.970E+002 
01  FILE_SCAN         ?   ?   LINEITEM)   1.997E+008   FUNKY_OPT_UNIQUE  8.970E+002   8.970E+002 

--- 31 row(s) selected.
>>
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

30   .    31   root                                                  1.00E+006
29   .    30   firstn                                                1.00E+006
28   .    29   esp_exchange                    1:8(hash2) (m)        1.00E+006
27   .    28   sort                                                  1.00E+006
26   .    27   hash_partial_groupby                                  1.00E+006
25   .    26   esp_exchange                    8(hash2):8(hash2)     1.23E+006
24   .    25   hash_partial_groupby                                  1.23E+006
23   21   24   hybrid_hash_join                                      1.30E+006
22   .    23   partition_access                                      2.00E+007
.    .    22   index_scan            fs fr     PAIDX1                2.00E+007
20   .    21   esp_exchange                    8(hash2):8(hash2)     1.30E+006
16   19   20   nested_semi_join                                      1.30E+006
18   .    19   probe_cache                                           1.00E+000
17   .    18   partition_access                                      1.00E+000
.    .    17   file_scan             fs fr     LINEITEM              1.00E+000
15   2    16   hybrid_hash_anti_sem                                  1.30E+006
14   4    15   hybrid_hash_join                                      3.92E+006
13   11   14   hybrid_hash_join      u                               8.04E+006
12   .    13   partition_access                                      1.99E+008
.    .    12   file_scan             fs fr     LINEITEM              1.99E+008
10   .    11   esp_exchange                    8(rep-b):8(hash2)     4.02E+004
7    9    10   nested_join                                           4.02E+004
8    .    9    partition_access                                      4.02E+004
.    .    8    file_scan             fs fr     SUPPLIER              4.02E+004
6    .    7    esp_exchange                    8(rep-b):1 (m)        1.00E+000
5    .    6    partition_access                                      1.00E+000
.    .    5    file_scan             fs fr     NATION                1.00E+000
3    .    4    partition_access                                      7.30E+007
.    .    3    file_scan             fs fr     ORDERS                7.30E+007
1    .    2    partition_access                                      1.99E+008
.    .    1    file_scan             fs fr     LINEITEM              1.99E+008

--- SQL operation complete.
>>obey optdml03(q22);
>>--------------------
>>--  TPCH Query 22 --
>>--------------------
>>prepare XX from
+>SELECT cntrycode, count(*) AS numcust, sum(c_acctbal) AS totacctbal
+>FROM (SELECT SUBSTRING(c_phone FROM 1 FOR 2) AS cntrycode, c_acctbal
+>      FROM customer
+>      WHERE SUBSTRING(c_phone FROM 1 FOR 2) IN ('13','17','18','23','29','30','31')
+>        AND c_acctbal > (SELECT AVG(c_acctbal)
+>                         FROM customer
+>                         WHERE c_acctbal > 0.00
+>                           AND SUBSTRING (c_phone FROM 1 FOR 2) IN
+>                                               ('13','17','18','23','29','30','31'))
+>        AND NOT EXISTS (SELECT *
+>                        FROM orders
+>                        WHERE o_custkey = c_custkey)
+>       ) AS custsale
+>GROUP BY cntrycode
+>ORDER BY cntrycode;

--- SQL command prepared.
>>
>>execute explainIt;

S   OPERATOR          LC  RC  TAB_NAME    CARDINAL     (EXPR)            OP_COST      TOT_COST
--  ----------------  --  --  ----------  -----------  ----------------  -----------  -----------

19  ROOT              18  ?               1.000E+002   FUNKY_OPT_UNIQUE  0.000E+000   2.821E+002 
18  ESP_EXCHANGE      17  ?               1.300E+001   FUNKY_OPT_UNIQUE  3.912E-005   2.821E+002 
17  SORT              16  ?               1.300E+001   FUNKY_OPT_UNIQUE  5.588E-008   2.821E+002 
16  HASH_PARTIAL_GRO  15  ?               1.300E+001   FUNKY_OPT_UNIQUE  3.139E-007   2.821E+002 
15  ESP_EXCHANGE      14  ?               1.000E+002   FUNKY_OPT_UNIQUE  7.522E-005   2.821E+002 
14  HASH_PARTIAL_GRO  13  ?               1.000E+002   FUNKY_OPT_UNIQUE  8.731E-004   2.821E+002 
13  NESTED_ANTI_SEMI  9   12              1.653E+006   FUNKY_OPT_UNIQUE  2.767E-002   2.821E+002 
12  SPLIT_TOP         11  ?               3.332E-001   FUNKY_OPT_UNIQUE  5.757E-003   2.089E+002 
11  PARTITION_ACCESS  10  ?               3.332E-001   FUNKY_OPT_UNIQUE  5.757E-003   2.089E+002 
10  INDEX_SCAN        ?   ?   ORDERS      3.332E-001   FUNKY_OPT_UNIQUE  2.089E+002   2.089E+002 
09  NESTED_JOIN       6   8               4.960E+006   FUNKY_OPT_UNIQUE  1.209E-002   7.311E+001 
08  PARTITION_ACCESS  7   ?               4.960E+006   FUNKY_OPT_UNIQUE  0.000E+000   3.655E+001 
07  FILE_SCAN         ?   ?   CUSTOMER    4.960E+006   FUNKY_OPT_UNIQUE  3.655E+001   3.655E+001 
06  ESP_EXCHANGE      5   ?               1.000E+000   FUNKY_OPT_UNIQUE  2.846E-004   3.655E+001 
05  SORT_PARTIAL_AGG  4   ?               1.000E+000   FUNKY_OPT_UNIQUE  3.723E-008   3.655E+001 
04  SPLIT_TOP         3   ?               1.000E+000   FUNKY_OPT_UNIQUE  1.181E-007   3.655E+001 
03  PARTITION_ACCESS  2   ?               1.000E+000   FUNKY_OPT_UNIQUE  1.181E-007   3.655E+001 
02  SORT_PARTIAL_AGG  1   ?               1.000E+000   FUNKY_OPT_UNIQUE  1.865E-002   3.655E+001 
01  FILE_SCAN         ?   ?   CUSTOMER    1.352E+007   FUNKY_OPT_UNIQUE  3.653E+001   3.653E+001 

--- 19 row(s) selected.
>>explain options 'f' xx;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

18   .    19   root                                                  1.00E+002
17   .    18   esp_exchange                    1:8(hash2) (m)        1.29E+001
16   .    17   sort                                                  1.29E+001
15   .    16   hash_partial_groupby                                  1.29E+001
14   .    15   esp_exchange                    8(hash2):8(hash2)     1.00E+002
13   .    14   hash_partial_groupby                                  1.00E+002
9    12   13   nested_anti_semi_joi                                  1.65E+006
11   .    12   split_top                       8(rep-n):8(hash2)     3.33E-001
10   .    11   partition_access                                      3.33E-001
.    .    10   index_scan            fs fr     ORDIDX2               3.33E-001
6    8    9    nested_join                                           4.96E+006
7    .    8    partition_access                                      4.96E+006
.    .    7    file_scan             fs fr     CUSTOMER              4.96E+006
5    .    6    esp_exchange                    8(rep-b):1            1.00E+000
4    .    5    sort_partial_aggr_ro                                  1.00E+000
3    .    4    split_top                       1:8(hash2)            1.00E+000
2    .    3    partition_access                                      1.00E+000
1    .    2    sort_partial_aggr_le                                  1.00E+000
.    .    1    file_scan             fs        CUSTOMER              1.35E+007

--- SQL operation complete.
>>
>>?section stopLog
>>---------------------------
>>--  Stop logging output. --
>>---------------------------
>>LOG;
